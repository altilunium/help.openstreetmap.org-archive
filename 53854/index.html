<meta charset="UTF-8"><link rel="stylesheet" type="text/css" href="../style.css"><div id="CALeft">
<div class="headNormal">
<h1><a href="/questions/53854/the-renderd_expire-command-update-wrong-tiles">The renderd_expire command update wrong tiles.</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/53854/up/" id="post-53854-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-53854-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/53854/down/" id="post-53854-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/53854/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>I make an edit on a place which can be see on the picture1, i create a test area called iD_test20170104.1 as show on the picture2, but a way occured which point to the place which i built before, then i delete the iD_test20170104.1, but the way still exist. And now i do not know how to restore the map to the original state.</p>
<p>It is on my own rails port, and i use iD editor to make the edit, and use osmosis command to produce a changes.osc.gz file, then use osm2pgsql with -append and -e options to generate a expire.list file, finally, i use "cat /data/mod_map/expire.list | /root/src/mod_tile/render_expired -m osmcarto -z 10 -Z 18 -T=10" command to re-renderd the tile, but the error occurs.</p>
<p>Is there a possibility that the changes.osc.gz files node id have conflict with the exist nodes causes the error? The changes.osc.gz file can be shown below.</p>
<pre><code>&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;osmChange version="0.6" generator="Osmosis 0.45"&gt;
  &lt;create&gt;
    &lt;node id="12" version="1" timestamp="2017-01-04T01:56:57Z" uid="2" user="osm_test" changeset="4" lat="39.9760643" lon="116.3371492"/&gt;
     &lt;node id="13" version="1" timestamp="2017-01-04T01:56:57Z" uid="2" user="osm_test" changeset="4" lat="39.9761444" lon="116.337109"/&gt;
    &lt;node id="14" version="1" timestamp="2017-01-04T01:56:57Z" uid="2" user="osm_test" changeset="4" lat="39.9762369" lon="116.3371439"/&gt;
    &lt;node id="15" version="1" timestamp="2017-01-04T01:56:57Z" uid="2" user="osm_test" changeset="4" lat="39.9762369" lon="116.3372592"/&gt;
    &lt;node id="16" version="1" timestamp="2017-01-04T01:56:57Z" uid="2" user="osm_test" changeset="4" lat="39.9761814" lon="116.3373584"/&gt;
    &lt;node id="17" version="1" timestamp="2017-01-04T01:56:57Z" uid="2" user="osm_test" changeset="4" lat="39.9761198" lon="116.3373745"/&gt;
    &lt;node id="18" version="1" timestamp="2017-01-04T01:56:57Z" uid="2" user="osm_test" changeset="4" lat="39.976056" lon="116.337337"/&gt;
    &lt;node id="19" version="1" timestamp="2017-01-04T01:56:57Z" uid="2" user="osm_test" changeset="4" lat="39.9760314" lon="116.3372377"/&gt;
    &lt;way id="2" version="1" timestamp="2017-01-04T01:56:57Z" uid="2" user="osm_test" changeset="4"&gt;
      &lt;nd ref="12"/&gt;
      &lt;nd ref="13"/&gt;
      &lt;nd ref="14"/&gt;
      &lt;nd ref="15"/&gt;
      &lt;nd ref="16"/&gt;
      &lt;nd ref="17"/&gt;
      &lt;nd ref="18"/&gt;
      &lt;nd ref="19"/&gt;
      &lt;nd ref="12"/&gt;
      &lt;tag k="description" v="2017.1.4日9:57在大运村的一个测试区域"/&gt;
      &lt;tag k="leisure" v="park"/&gt;
      &lt;tag k="name" v="iD_test20170104.1"/&gt;
    &lt;/way&gt;
  &lt;/create&gt;
&lt;/osmChange&gt;
</code></pre>
<p><img alt="alt text" src="http://help.openstreetmap.org/upfiles/1_6mt7z3j.png"/> </p>
<p><img alt="alt text" src="http://help.openstreetmap.org/upfiles/2_1kYH4It.png"/></p>
<p><img alt="alt text" src="http://help.openstreetmap.org/upfiles/3_GyHf7qe.png"/></p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-tiles" href="/tags/tiles/" rel="tag" title="see questions tagged 'tiles'">tiles</a>
<a class="post-tag tag-link-renderd" href="/tags/renderd/" rel="tag" title="see questions tagged 'renderd'">renderd</a>
<a class="post-tag tag-link-editor" href="/tags/editor/" rel="tag" title="see questions tagged 'editor'">editor</a>
<a class="post-tag tag-link-tileserver" href="/tags/tileserver/" rel="tag" title="see questions tagged 'tileserver'">tileserver</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>04 Jan '17, 06:05</strong>
</p>
<img alt="yuyy's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/3522efac952d508cf251cd2590e68ca5?s=32&amp;d=identicon&amp;r=g" width="32">
<p><a href="/users/12524/yuyy">yuyy</a><br/>
<span class="score" title="236 reputation points">236</span><span title="22 badges"><span class="badge1">●</span><span class="badgecount">22</span></span><span title="24 badges"><span class="silver">●</span><span class="badgecount">24</span></span><span title="31 badges"><span class="bronze">●</span><span class="badgecount">31</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="yuyy has one accepted answer">20%</span>
</p>
</img></div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/53854/">
                edited
                <strong>10 Jan '17, 10:13</strong>
</a>
</p>
<img alt="SomeoneElse's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/0bf1aa22f7f5e045b0eb8beb79fe7907?s=32&amp;d=identicon&amp;r=g" width="32">
<p><a href="/users/387/someoneelse">SomeoneElse ♦</a><br/>
<span class="score" title="36866 reputation points"><span class="">36.9k</span></span><span title="71 badges"><span class="badge1">●</span><span class="badgecount">71</span></span><span title="370 badges"><span class="silver">●</span><span class="badgecount">370</span></span><span title="866 badges"><span class="bronze">●</span><span class="badgecount">866</span></span></p>
</img></div>
</div>
<div class="comments-container" id="comments-container-53854">
<a name="53895"></a>
<div class="comment" id="comment-53895">
<div class="comment-score" id="post-53895-score">1</div>
<div class="comment-text"><p>Also is this on osm.org or on your own copy of the rails port (with data loaded)?</p></div>
<div class="comment-info" id="comment-53895-info">
<span class="comment-age">(06 Jan '17, 13:22)</span>
<a class="comment-user userinfo" href="/users/387/someoneelse">SomeoneElse ♦</a>
</div>
</div>
<a name="53900"></a>
<div class="comment" id="comment-53900">
<div class="comment-score" id="post-53900-score">2</div>
<div class="comment-text"><p>It is on my own rails port, and i use iD editor to make the edit, and use osmosis command to produce a changes.osc.gz file, then use osm2pgsql with -append and -e options to generate a expire.list file, finally, i use "cat /data/mod_map/expire.list | /root/src/mod_tile/render_expired -m osmcarto -z 10 -Z 18 -T=10" command to re-renderd the tile, but the error occurs.</p></div>
<div class="comment-info" id="comment-53900-info">
<span class="comment-age">(07 Jan '17, 08:02)</span>
<a class="comment-user userinfo" href="/users/12524/yuyy">yuyy</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-53854">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-53854-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    One Answer:
                    </div>
<div class="tabsA"><a href="/questions/53854/the-renderd_expire-command-update-wrong-tiles?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/53854/the-renderd_expire-command-update-wrong-tiles?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/53854/the-renderd_expire-command-update-wrong-tiles?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/53854/the-renderd_expire-command-update-wrong-tiles?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="53967"></a>
<div class="answer answered-by-owner" id="answer-container-53967">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/53967/up/" id="post-53967-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-53967-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/53967/down/" id="post-53967-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>I think it was caused by the conflict id in the changes.osc.gz file and the tile server database. I installed my own rails port, and when i use the editor to make a changes file, the index id of the node and way are begin at 1, but there has be a node or a way which id is 1 in the tile server database, so when i use osm2pgsql with -append option to import the changes file into the database, the error occurs.</p>
<p>And now, what confuses me is that the index id of the nodes and ways are automatically generated by the osmosis command, how can i set them to start at a large index number?</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/53967/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>10 Jan '17, 11:19</strong>
</p>
<img alt="yuyy's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/3522efac952d508cf251cd2590e68ca5?s=32&amp;d=identicon&amp;r=g" width="32">
<p><a href="/users/12524/yuyy">yuyy</a><br/>
<span class="score" title="236 reputation points">236</span><span title="22 badges"><span class="badge1">●</span><span class="badgecount">22</span></span><span title="24 badges"><span class="silver">●</span><span class="badgecount">24</span></span><span title="31 badges"><span class="bronze">●</span><span class="badgecount">31</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="yuyy has one accepted answer">20%</span>
</p>
</img></div>
</div>
<div class="comments-container" id="comments-container-53967">
</div>
<div class="comment-tools" id="comment-tools-53967">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-53967-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/53854/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="X33SNAPaPEUWQmqFGcsuERkyRpJd9tO7"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>