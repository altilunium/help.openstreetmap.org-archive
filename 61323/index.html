<meta charset="UTF-8"><link rel="stylesheet" type="text/css" href="../style.css"><div id="CALeft">
<div class="headNormal">
<h1><a href="/questions/61323/displaying-osm-in-an-android-webview-with-openlayers3">Displaying OSM in an android webview with Openlayers3</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/61323/up/" id="post-61323-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-61323-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/61323/down/" id="post-61323-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/61323/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>Good evening everyone,</p>
<p>I am currently trying to display the OSM from Openlayer3 using javascript in an HTML page. As long as I stay on a classic webpage (on local with a tomcat) it work just fine and I display my own datas from a GeoJson file.</p>
<p>Now i want to do the same on an android webview using the same HTML &amp; JS files, exported openlayers.js/css and the html in the assets folder. The problem is the map itself doesn't show, just the controls and copyright at the bottom. I have allowed javascript in my webview as i can execute other function from a JavascriptInterface class.</p>
<p>Is there any restrictions with openlayers/osm and android ?</p>
<p>Note : I am currently restricted to just Openlayers and a webview for this project, so i can't use things like leaflet or any Google API.</p>
<p>My current code is :</p>
<pre><code>public class MapActivity extends AppCompatActivity {

private HashSet&lt;Point&gt; points;
private WebView webView;
private WebSettings wSettings;
private AssetManager assetManager;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    assetManager = getApplicationContext().getAssets();
    try {
        InputStream targetStream = assetManager.open("lieuxjson.json");
        points = GeoJsonParser.readJsonStream(targetStream);
    } catch (java.io.IOException e) {
        e.printStackTrace();
        //stop activity
    }
    WebView webView = new WebView(this);
    webView.setClickable(true);
    webView.setFocusableInTouchMode(true);
    wSettings = webView.getSettings();
    wSettings.setJavaScriptEnabled(true);
    WebClientClass webViewClient = new WebClientClass();
    webView.setWebViewClient(webViewClient);
    WebChromeClient webChromeClient = new WebChromeClient();
    webView.setWebChromeClient(webChromeClient);
    webView.addJavascriptInterface(new WebAppInterface(this), "Android");
    webView.loadUrl("file:///android_asset/index.html");
    setContentView(webView);
}}
</code></pre>
<p>And the JS with a div id="map" and ol.js &amp; ol.css imported :</p>
<pre><code>var world = new ol.layer.Tile({ source: new ol.source.OSM() });
world.setZIndex(0);


var myview = new ol.View({
    center: ol.proj.fromLonLat([37.41, 8.82]),
    zoom: 3
  });

var map = new ol.Map({
  target: 'map',
  layers: [world],
  view: myview
});
</code></pre>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-website" href="/tags/website/" rel="tag" title="see questions tagged 'website'">website</a>
<a class="post-tag tag-link-android" href="/tags/android/" rel="tag" title="see questions tagged 'android'">android</a>
<a class="post-tag tag-link-openlayers" href="/tags/openlayers/" rel="tag" title="see questions tagged 'openlayers'">openlayers</a>
<a class="post-tag tag-link-webview" href="/tags/webview/" rel="tag" title="see questions tagged 'webview'">webview</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>22 Dec '17, 14:08</strong>
</p>
<img alt="Bruce%20Swain's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/f78618f82ddd41bed74fabf19eaf8865?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/14572/bruce-swain">Bruce Swain</a><br/>
<span class="score" title="21 reputation points">21</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">●</span><span class="badgecount">3</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Bruce Swain has no accepted answers">0%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/61323/">
                edited
                <strong>22 Dec '17, 16:53</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-61323">
</div>
<div class="comment-tools" id="comment-tools-61323">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-61323-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<form action="/questions/61323/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="1NERe2wtR1RzcrwfMI58OxOhQY6E7Fr3"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>