<meta charset="UTF-8"><link rel="stylesheet" type="text/css" href="../style.css"><div id="CALeft">
<div class="headNormal">
<h1><a href="/questions/83603/maperitive-generate-tiles-matching-real-boundaries">Maperitive: generate tiles matching real boundaries</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/83603/up/" id="post-83603-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-83603-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/83603/down/" id="post-83603-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/83603/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>Hello,</p>
<p>I'm relatively new to this world. I think my objective is pretty simple but I'm having a little trouble trying to achieve it. </p>
<p>What I need: take a part of my city and generate the corresponding tiles for use them offline with GPS data. Basically draw a point at the position I'm in.</p>
<p>What I'm doing: first, I'm locating my area with OSM data using Maperitive. I manually draw a bounding area and I generate the tiles. So far everything works fine.</p>
<p>The problem: the boundaries I draw don't match with the real tiles boundaries. <strong>The resulting JSON contains the boundaries I draw, but not the real tiles boundaries, plus the tiles also don't have matching boundaries between different zoom levels</strong>. This makes sense because of the standard division of the world. Just in case, I illustrate with some images that I found and that describe the situation:</p>
<p><img alt="alt text" src="https://lh3.googleusercontent.com/-OQZmnRDK5Zs/Vx4yWKUTX1I/AAAAAAAAAIE/CAl_zqtLFIQvfJWkbEgMurB0JFiEnKLLQCLcB/s320/Area.png"/></p>
<p><img alt="alt text" src="https://lh3.googleusercontent.com/-jHfe7rfvzbg/Vx4yY_f5n3I/AAAAAAAAAII/QUojPcBA-HEFMxWG_hlhF5RWomtIx-WPgCLcB/s320/Zoom%2B10%2BArea.png"/></p>
<p><img alt="alt text" src="https://lh3.googleusercontent.com/-tTJwVQMXwjk/Vx4ybDimAhI/AAAAAAAAAIM/4dvqhuwn5zAKXbZC-xoLswpolsNaOdTzwCLcB/s320/Zoom%2B11%2BArea.png"/></p>
<p><strong>The question</strong>: is there any way to crop an area and get all the necessary tiles to make them match with the original boundaries?</p>
<p>Greetings.</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-boundaries" href="/tags/boundaries/" rel="tag" title="see questions tagged 'boundaries'">boundaries</a>
<a class="post-tag tag-link-osm" href="/tags/osm/" rel="tag" title="see questions tagged 'osm'">osm</a>
<a class="post-tag tag-link-maperitive" href="/tags/maperitive/" rel="tag" title="see questions tagged 'maperitive'">maperitive</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>28 Feb '22, 10:06</strong>
</p>
<img alt="Sergio's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/afd9a800e915f09ad316211adbbf52bf?s=32&amp;d=identicon&amp;r=g" width="32">
<p><a href="/users/21459/sergio">Sergio</a><br/>
<span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">●</span><span class="badgecount">2</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Sergio has no accepted answers">0%</span>
</p>
</img></div>
</div>
<div class="comments-container" id="comments-container-83603">
</div>
<div class="comment-tools" id="comment-tools-83603">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-83603-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    One Answer:
                    </div>
<div class="tabsA"><a href="/questions/83603/maperitive-generate-tiles-matching-real-boundaries?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/83603/maperitive-generate-tiles-matching-real-boundaries?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/83603/maperitive-generate-tiles-matching-real-boundaries?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/83603/maperitive-generate-tiles-matching-real-boundaries?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="83615"></a>
<div class="answer answered-by-owner" id="answer-container-83615">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/83615/up/" id="post-83615-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-83615-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/83615/down/" id="post-83615-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>After reading and reading I ended up by resolving my particular problem. The first point is that I wasn't giving it the right focus.</p>
<p>It wasn't about the "real tile boundaries" I was talking about, it was about that <strong>the tiles are the boundaries</strong>. Each tile represent an XYZ point on the global map, and the way Maperitive downloads and stores them is that. It creates the first folder (Z), the sub folders (X) and the files (Y).  The nomenclature of every data is the value for the axis.</p>
<p>Solution: for knowing in what tile my coordinates were, I just had to transform my Lat, Lon values as the documentation says. Finally, knowing that the image files are 256x256 and starting from the upper left corner, the only thing needed is to know where the point is inside the image multiplying the floating part by 256.</p>
<p>I coded a Python solution to get this knowing Lat, Lon:</p>
<pre><code>import math
lat_deg = 43.253192
lon_deg = -2.914479
zoom = 19
lat_rad = math.radians(lat_deg)
n = 2.0 ** zoom
xtile = float((lon_deg + 180.0) / 360.0 * n)
ytile = float((1.0 - math.asinh(math.tan(lat_rad)) / math.pi) / 2.0 * n)
print("Tesela para ", lat_deg, lon_deg)
print("--------------------------------------")
print("Carpeta raiz:", zoom)
print("Sub carpeta:", (int)(xtile))
print("Fichero de imagen", (int)(ytile))
print("Pixel X en tesela: ", (xtile % 1)*256)
print("Pixel Y en tesela: ",  (ytile % 1)*256)
</code></pre>
<p>And that's all. I hope this helps someone with no experiencie like me.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/83615/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>01 Mar '22, 02:21</strong>
</p>
<img alt="Sergio's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/afd9a800e915f09ad316211adbbf52bf?s=32&amp;d=identicon&amp;r=g" width="32">
<p><a href="/users/21459/sergio">Sergio</a><br/>
<span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">●</span><span class="badgecount">2</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Sergio has no accepted answers">0%</span>
</p>
</img></div>
</div>
<div class="comments-container" id="comments-container-83615">
</div>
<div class="comment-tools" id="comment-tools-83615">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-83615-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/83603/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="oU17lc3Z6sSJML6F8ExOxMYKroliYZs0"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>