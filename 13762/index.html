<meta charset="UTF-8"><link rel="stylesheet" type="text/css" href="../style.css"><div id="CALeft">
<div class="headNormal">
<h1><a href="/questions/13762/how-to-check-nominatim-planet-import-execution-is-running-in-background-or-terminated">How to check Nominatim planet import execution is running in background or terminated?</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/13762/up/" id="post-13762-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-13762-score" title="current number of votes">
    1
</div>
<a class="ajax-command post-vote down" href="/vote/13762/down/" id="post-13762-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/13762/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>I am doing Nominatim OSM installation as per the steps given in <a href="http://wiki.openstreetmap.org/wiki/Nominatim/Installation">http://wiki.openstreetmap.org/wiki/Nominatim/Installation</a>. Currently I am on following command </p>
<blockquote>
<p>./utils/setup.php --osm-file
/usr/share/osmgeplanet/gujarat.osm.bz2
--all</p>
</blockquote>
<p>Script is running and the last line of output is "Partitions" and I can see around 589 tables in DB. But after one-two days no progress is there. Is script is terminated in background? How can I find the error? How can I check that script is running in background or not? </p>
<p>As I can see in the setup.php after writing "partitions" keyword as output, script is going to execute a large script (around 1.5MB sql queries) in postgresql shell. So how can I check if its still running or not? If terminated what is the error? </p>
<p>Please guide.</p>
<p><strong>EDIT</strong></p>
<p>Output of select * from pg_stat_activity where datname = 'nominatim'; is:</p>
<pre><code>datid  |  datname  | procpid | usesysid | usename | current_query | waiting | xact_start |          query_start          |         backend_start         | client_addr | client _port
</code></pre>
<p>---------+-----------+---------+----------+---------+---------------+---------+------------+-------------------------------+-------------------------------+-------------+-------------
 2393113 | nominatim |    4537 |    16385 | root    | &lt;idle&gt;        | f       |            | 2012-06-25 13:27:22.345186+02 | 2012-06-25 12:55:53.153181+02 |             |   -1
 2393113 | nominatim |    5399 |    16385 | root    | &lt;idle&gt;        | f       |            | 2012-06-25 13:32:27.59859+02  | 2012-06-25 13:27:22.387147+02 |             |   -1
(2 rows)</p>
<p>So is my process is currently runniing?</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-import" href="/tags/import/" rel="tag" title="see questions tagged 'import'">import</a>
<a class="post-tag tag-link-nominatim" href="/tags/nominatim/" rel="tag" title="see questions tagged 'nominatim'">nominatim</a>
<a class="post-tag tag-link-osm" href="/tags/osm/" rel="tag" title="see questions tagged 'osm'">osm</a>
<a class="post-tag tag-link-postgresql" href="/tags/postgresql/" rel="tag" title="see questions tagged 'postgresql'">postgresql</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>25 Jun '12, 13:35</strong>
</p>
<img alt="Ravi%20Kotwani's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/b3013a84207a32bed7ddfad7004100f7?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/3908/ravi-kotwani">Ravi Kotwani</a><br/>
<span class="score" title="136 reputation points">136</span><span title="6 badges"><span class="badge1">●</span><span class="badgecount">6</span></span><span title="6 badges"><span class="silver">●</span><span class="badgecount">6</span></span><span title="9 badges"><span class="bronze">●</span><span class="badgecount">9</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Ravi Kotwani has no accepted answers">0%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/13762/">
                edited
                <strong>26 Jun '12, 06:49</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-13762">
</div>
<div class="comment-tools" id="comment-tools-13762">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-13762-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    2 Answers:
                    </div>
<div class="tabsA"><a href="/questions/13762/how-to-check-nominatim-planet-import-execution-is-running-in-background-or-terminated?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/13762/how-to-check-nominatim-planet-import-execution-is-running-in-background-or-terminated?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/13762/how-to-check-nominatim-planet-import-execution-is-running-in-background-or-terminated?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/13762/how-to-check-nominatim-planet-import-execution-is-running-in-background-or-terminated?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="13769"></a>
<div class="answer" id="answer-container-13769">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/13769/up/" id="post-13769-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-13769-score" title="current number of votes">
    4
</div>
<a class="ajax-command post-vote down" href="/vote/13769/down/" id="post-13769-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>Normally, Nominatim shouldn't be silent for more than a few hours unless you try to import the entire planet on a slow machine. Even then, it should not hang in this particular line.</p>
<p>You can check what postgresql is doing with psql:</p>
<pre><code> psql -d postgres -c "select * from pg_stat_activity where datname = 'nominatim'"
</code></pre>
<p>You can ignore the lines where the query is <code>&lt;IDLE&gt;</code>. But if you see another query there stuck in waiting state, something might be blocking Nominatim. If you can't find a reason, stop the import, restart postgresql and restart the import. If you still get stuck in the same place, file a bug report in <a href="https://trac.openstreetmap.org/newticket">trac</a> or <a href="https://github.com/twain47/Nominatim/issues">github</a>. </p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/13769/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>25 Jun '12, 17:21</strong>
</p>
<img alt="lonvia's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/d888b712d85dee0aa304297f2dc697c7?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/2921/lonvia">lonvia</a><br/>
<span class="score" title="6213 reputation points"><span class="">6.2k</span></span><span title="2 badges"><span class="badge1">●</span><span class="badgecount">2</span></span><span title="57 badges"><span class="silver">●</span><span class="badgecount">57</span></span><span title="89 badges"><span class="bronze">●</span><span class="badgecount">89</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="lonvia has 43 accepted answers">40%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/13769/">
                edited
                <strong>26 Jun '12, 07:46</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-13769">
<a name="13779"></a>
<div class="comment" id="comment-13779">
<div class="comment-score" id="post-13779-score"></div>
<div class="comment-text"><p>I can see 2 rows as the result of above query. Value of  "current_query" field name is "&lt;idle&gt;". Value of "waiting" field is "f". For more details of result of above query, you can see my this edited question.
What this columns mean? Is my process is currently running in backend or not?</p></div>
<div class="comment-info" id="comment-13779-info">
<span class="comment-age">(26 Jun '12, 06:51)</span>
<a class="comment-user userinfo" href="/users/3908/ravi-kotwani">Ravi Kotwani</a>
</div>
</div>
<a name="13781"></a>
<div class="comment" id="comment-13781">
<div class="comment-score" id="post-13781-score"></div>
<div class="comment-text"><p>You can ignore the lines with &lt;idle&gt;, those are just open connections to the database. If there are no other lines, then it is not a database access that is stuck. I edited my answer to make that more clear.
Finding another cause is more difficult. Just try to restart the import. It shouldn't take more than a few hours overall. If you get stuck again, ask over at the <a href="http://wiki.openstreetmap.org/wiki/Contact#IRC">IRC channel</a>.</p></div>
<div class="comment-info" id="comment-13781-info">
<span class="comment-age">(26 Jun '12, 07:56)</span>
<a class="comment-user userinfo" href="/users/2921/lonvia">lonvia</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-13769">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-13769-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<a name="13771"></a>
<div class="answer" id="answer-container-13771">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/13771/up/" id="post-13771-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-13771-score" title="current number of votes">
    3
</div>
<a class="ajax-command post-vote down" href="/vote/13771/down/" id="post-13771-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>You really should be running the install while running a <a href="https://www.gnu.org/software/screen/">screen</a> session. That way if you disconnect (intentionally or not) your commands will continue to execute.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/13771/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>25 Jun '12, 19:10</strong>
</p>
<img alt="Norm1's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/e17c2bfaed82349f7a355866ff24e4cf?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/3409/norm1">Norm1</a><br/>
<span class="score" title="126 reputation points">126</span><span title="4 badges"><span class="badge1">●</span><span class="badgecount">4</span></span><span title="5 badges"><span class="silver">●</span><span class="badgecount">5</span></span><span title="8 badges"><span class="bronze">●</span><span class="badgecount">8</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Norm1 has no accepted answers">0%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/13771/">
                edited
                <strong>05 May '16, 01:25</strong>
</a>
</p>
<img alt="Harry%20Wood's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/9e04333be840d50c6aa66fb112aad77c?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/107/harry-wood">Harry Wood</a><br/>
<span class="score" title="9489 reputation points"><span class="">9.5k</span></span><span title="25 badges"><span class="badge1">●</span><span class="badgecount">25</span></span><span title="88 badges"><span class="silver">●</span><span class="badgecount">88</span></span><span title="128 badges"><span class="bronze">●</span><span class="badgecount">128</span></span></p>
</div>
</div>
<div class="comments-container" id="comments-container-13771">
</div>
<div class="comment-tools" id="comment-tools-13771">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-13771-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/13762/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="e1p4oVBfWWEXvWvEvFxJY1GteTpzGb6c"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>