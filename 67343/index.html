<meta charset="UTF-8"><link rel="stylesheet" type="text/css" href="../style.css"><div id="CALeft">
<div class="headNormal">
<h1><a href="/questions/67343/osm-grey-city-area">osm grey city area</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/67343/up/" id="post-67343-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-67343-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/67343/down/" id="post-67343-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/67343/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>Hello,
I need to get cities boundaries, I know how to do it by query the planet_osm_polygon table and get the exact result as in www.openstreetmap.org
but its differ from the real city area as marked in grey</p>
<p>e.g Towcester: <a href="https://www.openstreetmap.org/relation/1641604">https://www.openstreetmap.org/relation/1641604</a></p>
<p>As it can see the area marked in orange is much bigger than the city area</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-boundaries" href="/tags/boundaries/" rel="tag" title="see questions tagged 'boundaries'">boundaries</a>
<a class="post-tag tag-link-planet_osm_polygon" href="/tags/planet_osm_polygon/" rel="tag" title="see questions tagged 'planet_osm_polygon'">planet_osm_polygon</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>24 Dec '18, 15:08</strong>
</p>
<img alt="altopalo's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/53c4a40bd104f3de1bbc6ccb735e52eb?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/14437/altopalo">altopalo</a><br/>
<span class="score" title="53 reputation points">53</span><span title="8 badges"><span class="badge1">●</span><span class="badgecount">8</span></span><span title="10 badges"><span class="silver">●</span><span class="badgecount">10</span></span><span title="13 badges"><span class="bronze">●</span><span class="badgecount">13</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="altopalo has no accepted answers">0%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/67343/">
                edited
                <strong>24 Dec '18, 15:09</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-67343">
<a name="67344"></a>
<div class="comment" id="comment-67344">
<div class="comment-score" id="post-67344-score">2</div>
<div class="comment-text"><p>What do you mean by "the real city area" exactly? It looks like the "area marked as grey" is mapped as landuse=residential. It doesn't correspond to any administrative boundary and naturally a city may have other landuses such as commercial or industrial.</p></div>
<div class="comment-info" id="comment-67344-info">
<span class="comment-age">(24 Dec '18, 15:29)</span>
<a class="comment-user userinfo" href="/users/14272/alan_gr">alan_gr</a>
</div>
</div>
<a name="67346"></a>
<div class="comment not_top_scorer" id="comment-67346">
<div class="comment-score" id="post-67346-score"></div>
<div class="comment-text"><p>Tn'x for the data
So I looks for a way to get that 'grey area' (landuse=residential)  from the osm dump DB.
I assume the area I gets and also seen in the map is the administrative area of the city.</p></div>
<div class="comment-info" id="comment-67346-info">
<span class="comment-age">(24 Dec '18, 15:52)</span>
<a class="comment-user userinfo" href="/users/14437/altopalo">altopalo</a>
</div>
</div>
<a name="67347"></a>
<div class="comment" id="comment-67347">
<div class="comment-score" id="post-67347-score">3</div>
<div class="comment-text"><p>Landuse=residential has nothing to do with administration, it simply marks areas of land that mappers perceive as primarily used for housing.</p>
<p>If you want adminstrative areas you will need to look at boundary relations, but that seems to be where you started as you already gave an example of such a relation.</p></div>
<div class="comment-info" id="comment-67347-info">
<span class="comment-age">(24 Dec '18, 18:35)</span>
<a class="comment-user userinfo" href="/users/14272/alan_gr">alan_gr</a>
</div>
</div>
<a name="67351"></a>
<div class="comment not_top_scorer" id="comment-67351">
<div class="comment-score" id="post-67351-score"></div>
<div class="comment-text"><p>Tn'x but I know how to get the administrative area.</p>
<p>I'm looking for a way to get the Landuse=residentialstrative area of specific city by query the postgis DB.</p></div>
<div class="comment-info" id="comment-67351-info">
<span class="comment-age">(25 Dec '18, 07:28)</span>
<a class="comment-user userinfo" href="/users/14437/altopalo">altopalo</a>
</div>
</div>
<a name="67366"></a>
<div class="comment" id="comment-67366">
<div class="comment-score" id="post-67366-score">2</div>
<div class="comment-text"><p>Well, you'd query the database the same way as you did for the administrative boundary, but instead query for landuse=residential objects. As has been mentioned, though, this won't give you the complete area of a settlement. There will likely also be landuse=industrial, landuse=commercial, landuse=retail, leisure=park, amenity=school, and many other types of areas that together combine to form the area of the settlement. This also assumes that the landuses and other areas have all been mapped, which isn't guaranteed.</p></div>
<div class="comment-info" id="comment-67366-info">
<span class="comment-age">(27 Dec '18, 16:56)</span>
<a class="comment-user userinfo" href="/users/8189/alester">alester</a>
</div>
</div>
<a name="67785"></a>
<div class="comment not_top_scorer" id="comment-67785">
<div class="comment-score" id="post-67785-score"></div>
<div class="comment-text"><p>Thanks <a href="https://help.openstreetmap.org/users/8189/alester"></a><a href="https://help.openstreetmap.org/users/8189/alester">@alester</a>
Tried your advice and indeed I get  a list of polygons inside the polygon I want to, but if i look e.g: on the landuse=residential some are really residential but some are not truly place of people (the gray areas in the map)</p>
<p>e.g this query about Buckland (village in UK)</p>
<p>select i.osm_id, i.name, i.landuse
from planet_osm_polygon i join planet_osm_polygon o 
on ST_Contains (o.way, i.way)
where o.osm_id = -4108597
and i.landuse = 'residential'</p>
<p>94353763;"";"residential"
203007994;"";"residential"
203007897;"";"residential"
195214668;"";"residential"
59825490;"Ashtree Farm";"residential"
187233334;"";"residential"
95029739;"";"residential"
94441095;"";"residential"
98217350;"";"residential"
...</p></div>
<div class="comment-info" id="comment-67785-info">
<span class="comment-age">(29 Jan '19, 14:41)</span>
<a class="comment-user userinfo" href="/users/14437/altopalo">altopalo</a>
</div>
</div>
<a name="67786"></a>
<div class="comment" id="comment-67786">
<div class="comment-score" id="post-67786-score">1</div>
<div class="comment-text"><p>You say "some are really residential but some are not truly place of people".  Can you give an example of one in that area that is "not truly place of people"?</p></div>
<div class="comment-info" id="comment-67786-info">
<span class="comment-age">(29 Jan '19, 15:12)</span>
<a class="comment-user userinfo" href="/users/387/someoneelse">SomeoneElse ♦</a>
</div>
</div>
<a name="67804"></a>
<div class="comment" id="comment-67804">
<div class="comment-score" id="post-67804-score">1</div>
<div class="comment-text"><p>Do you mean <a href="https://www.openstreetmap.org/way/59825490#map=18/51.67190/-1.52064">Ashtree Farm</a> ? It's mapped as a residential area, it's "grey" on the map. It's probably the area around the farm house. A place where people live, hence landuse=residential is correct.</p>
<p>Maybe this does not correspond to the area's you want to extract, but I fear that your definition of "city boundaries" does not match any OSM concept, as others pointed out.</p></div>
<div class="comment-info" id="comment-67804-info">
<span class="comment-age">(30 Jan '19, 04:09)</span>
<a class="comment-user userinfo" href="/users/5390/escada">escada</a>
</div>
</div>
<a name="67805"></a>
<div class="comment not_top_scorer" id="comment-67805">
<div class="comment-score" id="post-67805-score"></div>
<div class="comment-text"><p>thanks <a href="https://help.openstreetmap.org/users/387/someoneelse"></a><a href="https://help.openstreetmap.org/users/387/someoneelse">@SomeoneElse</a> &amp; <a href="https://help.openstreetmap.org/users/5390/escada"></a><a href="https://help.openstreetmap.org/users/5390/escada">@escada</a></p>
<p>e.g:
94353763: <a href="https://www.openstreetmap.org/way/94353763">https://www.openstreetmap.org/way/94353763</a> - green area</p>
<p>1369487 : <a href="https://www.openstreetmap.org/relation/1369487">https://www.openstreetmap.org/relation/1369487</a> is the village and what I need.</p>
<p>What i'm tying to do is by getting a point, decide if its urban area or not.</p></div>
<div class="comment-info" id="comment-67805-info">
<span class="comment-age">(30 Jan '19, 06:18)</span>
<a class="comment-user userinfo" href="/users/14437/altopalo">altopalo</a>
</div>
</div>
<a name="67811"></a>
<div class="comment not_top_scorer" id="comment-67811">
<div class="comment-score" id="post-67811-score"></div>
<div class="comment-text"><p>I'm not sure why you say 94353763 is a green area. It happens to be surrounded by a wood, but the area itself consists of houses and their gardens (visible in any aerial imagery background) so its mapping as residential is correct, and so is its display as grey in the standard map.</p>
<p>What do you see as the difference between these houses and the ones in 1369487 that qualifies one group of houses as urban and not the other?</p></div>
<div class="comment-info" id="comment-67811-info">
<span class="comment-age">(30 Jan '19, 11:57)</span>
<a class="comment-user userinfo" href="/users/14272/alan_gr">alan_gr</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-67343">
<span class="comments-showing">
            showing 5 of 10
        </span>
<a class="show-all-comments-link" href="#">show 5 more comments</a>
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-67343-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    One Answer:
                    </div>
<div class="tabsA"><a href="/questions/67343/osm-grey-city-area?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/67343/osm-grey-city-area?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/67343/osm-grey-city-area?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/67343/osm-grey-city-area?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="67813"></a>
<div class="answer answered-by-owner" id="answer-container-67813">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/67813/up/" id="post-67813-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-67813-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/67813/down/" id="post-67813-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>Thanks all for the great info, after some digging I found the way to do what I need.</p>
<p>The purpose is to find the residential boundaries of a given settlement (city, village). for my purpose a farm or few houses alone is not urban so I don't need it</p>
<p>So here are the steps I done, if someone will need it also:</p>
<p>-- 1. find the polygon of the city/village (actually I already have the osm_id of the village in my DB,  but to complete the explanation ...) This returned a polygon that include the village but a lot of open areas around it.</p>
<pre><code>select name, osm_id from planet_osm_polygon where name = 'Buckland'
</code></pre>
<p>-- 2. get id of the relation(s) that are inside the polygon, need the items with negative osm_id</p>
<pre><code>select i.osm_id, i.name, i.landuse 
from planet_osm_polygon i join planet_osm_polygon o on ST_Contains (o.way, i.way) 
where o.osm_id = -4108597 and i.landuse = 'residential' and i.osm_id &lt; 0
</code></pre>
<p>-- 3. get the outer way from planet_osm_rels table</p>
<pre><code>select * from planet_osm_rels where id = 1369487;
</code></pre>
<p>-- 4. get the nodes from planet_osm_ways</p>
<pre><code>select * from planet_osm_ways where id = 94437443;
</code></pre>
<p>-- 5. get the way's nodes data of the from node table</p>
<pre><code>select * from planet_osm_nodes where id = 1096978061;
</code></pre>
<p>I checked it on few locations and its seems to work, of course need to rewrite the queries more efficiently.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/67813/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>30 Jan '19, 14:12</strong>
</p>
<img alt="altopalo's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/53c4a40bd104f3de1bbc6ccb735e52eb?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/14437/altopalo">altopalo</a><br/>
<span class="score" title="53 reputation points">53</span><span title="8 badges"><span class="badge1">●</span><span class="badgecount">8</span></span><span title="10 badges"><span class="silver">●</span><span class="badgecount">10</span></span><span title="13 badges"><span class="bronze">●</span><span class="badgecount">13</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="altopalo has no accepted answers">0%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/67813/">
                edited
                <strong>18 Feb '19, 15:58</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-67813">
</div>
<div class="comment-tools" id="comment-tools-67813">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-67813-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/67343/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="nOGW025VtjO0SjjBjor1dFPAzGhTaW71"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>