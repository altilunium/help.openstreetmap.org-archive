<meta charset="utf-8"/><link href="../style.css" rel="stylesheet" type="text/css"/><div id="CALeft"><center><a href="../"><img id="ll" src="https://help.openstreetmap.org/upfiles/osm_help_logo_6.png"/></a></center>
<div class="headNormal">
<h1><a href="/questions/69044/missing-nodes-from-httpslz4overpass-apideapiinterpreter">Missing nodes from https://lz4.overpass-api.de/api/interpreter</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/69044/up/" id="post-69044-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-69044-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/69044/down/" id="post-69044-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/69044/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>I'm trying to download xml data giving a coordenates from my page calling to "https://overpass-api.de/api/map?bbox=-0.678492,39.657480,-0.665617,39.667391". After this I get the map.osm file.</p>
<p>The problem begins when I call to the page mentioned above several times in a few time (maybe 10 times in 8-10 minutes). When I do this, I get (not always) a "failed to open stream: HTTP request failed! HTTP/1.1 429 Too Many Requests" error in my php script. This is the map I get when it works:
<img alt="alt text" src="https://help.openstreetmap.org/upfiles/osm-ok.jpg"/></p>
<p>So, as a second option I tried to call to "https://lz4.overpass-api.de/api/interpreter?data=[bbox];(node;way;relation;);out%20bb;&amp;bbox=-0.678492,39.657480,-0.665617,39.667391" in order to avoid the error on the previous URL. The problem doing this is that the downloaded map.osm file seems to miss some nodes, so they can't be found when drawing map.
This is the map I get from this URL:
<img alt="alt text" src="https://help.openstreetmap.org/upfiles/osm-wrong.jpg"/></p>
<p><br/>I don't know if this is my mistake, but I compared both map.osm files, and they don't have de same data.
<br/>- Could it be an OSM problem?
<br/>- Which URL should I use? "https://overpass-api.de/api/map" or "https://lz4.overpass-api.de/api/interpreter"?</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-overpassapi" href="/tags/overpassapi/" rel="tag" title="see questions tagged 'overpassapi'">overpassapi</a>
<a class="post-tag tag-link-nodes" href="/tags/nodes/" rel="tag" title="see questions tagged 'nodes'">nodes</a>
<a class="post-tag tag-link-http429" href="/tags/http429/" rel="tag" title="see questions tagged 'http429'">http429</a>
<a class="post-tag tag-link-overpass-api" href="/tags/overpass-api/" rel="tag" title="see questions tagged 'overpass-api'">overpass-api</a>
<a class="post-tag tag-link-missing" href="/tags/missing/" rel="tag" title="see questions tagged 'missing'">missing</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>02 May '19, 13:04</strong>
</p>
<img alt="r3287's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/fef9101b2d83bd25c1ce368c4bbc666e?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/16623/r3287">r3287</a><br/>
<span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">●</span><span class="badgecount">2</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="r3287 has no accepted answers">0%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-69044">
<a name="69074"></a>
<div class="comment" id="comment-69074">
<div class="comment-score" id="post-69074-score">1</div>
<div class="comment-text"><p>I kindly invite you to read the error message, in particular the words <em>Too many requests</em>.</p></div>
<div class="comment-info" id="comment-69074-info">
<span class="comment-age">(03 May '19, 21:43)</span>
<a class="comment-user userinfo" href="/users/3480/roland-olbricht">Roland Olbricht</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-69044">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-69044-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    One Answer:
                    </div>
<div class="tabsA"><a href="/questions/69044/missing-nodes-from-httpslz4overpass-apideapiinterpreter?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/69044/missing-nodes-from-httpslz4overpass-apideapiinterpreter?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/69044/missing-nodes-from-httpslz4overpass-apideapiinterpreter?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/69044/missing-nodes-from-httpslz4overpass-apideapiinterpreter?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="69075"></a>
<div class="answer" id="answer-container-69075">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/69075/up/" id="post-69075-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-69075-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/69075/down/" id="post-69075-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>No, this is not a problem in OSM. You ask the server to retrieve ways and relations without the node referenced there. The server faithfully sends back that data to you.</p>
<p>The script is most likely turning missing nodes into the coordinate (0,0) which explains the line segments leaving the image to the bottom.</p>
<p>I would like to encourage you to make you familiar with the OpenStreetMap data model first.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/69075/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>03 May '19, 21:47</strong>
</p>
<img alt="Roland%20Olbricht's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/fcfdb0825826fd13d2ff0d83d58819c6?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/3480/roland-olbricht">Roland Olbricht</a><br/>
<span class="score" title="6666 reputation points"><span class="">6.7k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="64 badges"><span class="silver">●</span><span class="badgecount">64</span></span><span title="89 badges"><span class="bronze">●</span><span class="badgecount">89</span></span><br>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Roland Olbricht has 40 accepted answers">36%</span>
</br></p>
</div>
</div>
<div class="comments-container" id="comments-container-69075">
<a name="69083"></a>
<div class="comment" id="comment-69083">
<div class="comment-score" id="post-69083-score"></div>
<div class="comment-text"><p>Thanks for your response. First of all, I think I'm familiar with OSM data, as I'm doing this script since some months ago. I don't know what do you mean with "the node referenced there". I thought passing bounding box was enough to get an area.</p>
<p>Secondly, it seems like the second URL returns all nodes except those that are outside the bounding area, that's the reason why my script doesn't know where it has to continue drawing more lines (because the .osm file makes reference to a node ID, but when tries to find that node, it does not exist) and goes to the bottom of the image.</p>
<p>It doesn't make much sense that asking for the same bounding area, it receives different nodes from both URLs.</p>
<p>Do you think I'm missing something when asking to the server?</p></div>
<div class="comment-info" id="comment-69083-info">
<span class="comment-age">(04 May '19, 12:19)</span>
<a class="comment-user userinfo" href="/users/16623/r3287">r3287</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-69075">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-69075-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/69044/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="0svKa6LKRcjGRS9geP3of1zCTYI4DtdZ"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>