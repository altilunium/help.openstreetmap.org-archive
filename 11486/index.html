<meta charset="UTF-8"><link rel="stylesheet" type="text/css" href="../style.css"><div id="CALeft">
<div class="headNormal">
<h1><a href="/questions/11486/splitter-artifacts-in-nhd-maps">Splitter artifacts in NHD maps</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/11486/up/" id="post-11486-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-11486-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/11486/down/" id="post-11486-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/11486/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>OSM experts,</p>
<p>Thanks for your time.  I'm experimenting with building maps from US NHD data and have encountered a problem that only comes up when I split my osm files with splitter.  I'm using the latest svn version of it and mkgmap.  Here's the short version:</p>
<p>(1) Use ogr2osm with a suitable translation file to convert NHDFlowline.shp -&gt; NHDFlowline.osm and NHDWaterbody.shp -&gt; NHDWaterbody.osm</p>
<p>(2) Use sed to add dummy database fields so that these osm files are acceptable to osmosis.</p>
<p>(3) Use osmosis to delete nodes that aren't used by ways in these files, eg</p>
<pre><code>osmosis --rx NHDWaterbody.osm --tf accept-way natural=water,natural=wetland,landuse=reservoir,man_made=reservoir,leisure=swimming_pool --used-node  --wx NHDWaterbody.filtered.osm
</code></pre>
<p>(4) Run splitter:</p>
<pre><code>splitter --split-file=areas.list --mapid=20000000 --max-nodes=2400000  NHDFlowline.filtered.osm NHDWaterbody.filtered.osm
</code></pre>
<p>(5) Run mkgmap (with loads of options that aren't relevant, experimentation shows).</p>
<p>In the case of the subbassin I'm experimenting with, two of the three tiles have large, spurious, angular lakes. I've put a screenshot from from qlandkartegt at <a href="http://www.math.sjsu.edu/~stanley/Screenshot.png">link text</a> for the time being.</p>
<p>If it helps any, one large angular water area is given the name that belongs to a lake near, but not touching the edge of the tile containing that spurious lake.  Another clue, perhaps, is that between the actual lake of that name and the spurious region in the adjoining tile is a lake the straddles the two tiles, but appears in neither.</p>
<p>Further possible hints: </p>
<p>(1) mkgmap can actually handle this modest amount of data without splitting.  Just using mkgmap, I don't get the spurious water area when building a map from the two filtered osm files. </p>
<p>(2) I can split either  NHDFlowline.filtered.osm or the NHDWaterbody.filtered.osm file using the areas.list file generated when splitting them together, and the mkgmap results are good. </p>
<p>Thanks for any pointers!</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-splitter" href="/tags/splitter/" rel="tag" title="see questions tagged 'splitter'">splitter</a>
<a class="post-tag tag-link-problem" href="/tags/problem/" rel="tag" title="see questions tagged 'problem'">problem</a>
<a class="post-tag tag-link-nhd" href="/tags/nhd/" rel="tag" title="see questions tagged 'nhd'">nhd</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>24 Mar '12, 04:40</strong>
</p>
<img alt="Utea's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/3a1ff01c0aea36852c07f21c2c416de2?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/3166/utea">Utea</a><br/>
<span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">●</span><span class="badgecount">2</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Utea has no accepted answers">0%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-11486">
</div>
<div class="comment-tools" id="comment-tools-11486">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-11486-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<form action="/questions/11486/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="L4GlfSE3ozt8NZquvPIDKLGqgKL942Ds"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>