<meta charset="UTF-8"><link rel="stylesheet" type="text/css" href="../style.css"><div id="CALeft">
<div class="headNormal">
<h1><a href="/questions/74358/osm-software-setup-troubleshooting">OSM software setup troubleshooting</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/74358/up/" id="post-74358-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-74358-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/74358/down/" id="post-74358-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/74358/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>I'm done with my first suite setup attempt =&gt; the maps render blank and I have no idea how to troubleshoot.  Any tips on where should I start please?  To make things worse, I'm both OSM and Linux novice too.</p>
<p>For what it's worth, I ran "sudo -u renderaccount -- /usr/local/bin/renderd -fc /usr/local/etc/renderd.conf" manually and did not notice any errors.  Some .meta files are getting generated in directories under /var/lib/mod_tile/ajt.  For rendering I used this example <a href="https://switch2osm.github.io/using-tiles/getting-started-with-leaflet/">https://switch2osm.github.io/using-tiles/getting-started-with-leaflet/</a> and did replace 'https://{s}.tile.openstreetmap.org' with 'http://ip address'.</p>
<p>I followed the instructions at <a href="https://switch2osm.org/serving-tiles/manually-building-a-tile-server-18-04-lts/">https://switch2osm.org/serving-tiles/manually-building-a-tile-server-18-04-lts/</a> and am wondering if the various pieces of software/ styles/ fonts that will be used for rendering - starting from osm2pgsql in the list - do those need to be installed logged in as the user who'll do the rendering?  In this particular document renderaccount.</p>
<p>Also, if I'll have to throw away the VM and redo the setup again, are there any better setup instructions?</p>
<p>Thanks very much,  Eugen</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-setup" href="/tags/setup/" rel="tag" title="see questions tagged 'setup'">setup</a>
<a class="post-tag tag-link-osm" href="/tags/osm/" rel="tag" title="see questions tagged 'osm'">osm</a>
<a class="post-tag tag-link-software" href="/tags/software/" rel="tag" title="see questions tagged 'software'">software</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>25 Apr '20, 03:32</strong>
</p>
<img alt="eugen_nw's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/ad8f49d67fd7b8e25376900e86f57542?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/18251/eugen_nw">eugen_nw</a><br/>
<span class="score" title="31 reputation points">31</span><span title="2 badges"><span class="badge1">●</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">●</span><span class="badgecount">2</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="eugen_nw has no accepted answers">0%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/74358/">
                edited
                <strong>25 Apr '20, 03:46</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-74358">
</div>
<div class="comment-tools" id="comment-tools-74358">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-74358-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    2 Answers:
                    </div>
<div class="tabsA"><a href="/questions/74358/osm-software-setup-troubleshooting?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/74358/osm-software-setup-troubleshooting?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/74358/osm-software-setup-troubleshooting?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/74358/osm-software-setup-troubleshooting?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="74366"></a>
<div class="answer" id="answer-container-74366">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/74366/up/" id="post-74366-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-74366-score" title="current number of votes">
    1
</div>
<a class="ajax-command post-vote down" href="/vote/74366/down/" id="post-74366-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<blockquote>
<p>Some .meta files are getting generated in directories</p>
</blockquote>
<p>That means that it's rendering tiles, which is the hard bit, and we just need to figure out why you can't see them in a browser.  </p>
<p>What I'd suggest first is to use the web developer tools in your browser (usually via f12) to have a look at any errors and to see what's not loading.</p>
<p>When you tried "http://yourserveripaddress/hot/0/0/0.png" did that work?  Did you try the html file “sample_leaflet.html” in mod_tile’s “extras” folder?</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/74366/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>25 Apr '20, 23:12</strong>
</p>
<img alt="SomeoneElse's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/0bf1aa22f7f5e045b0eb8beb79fe7907?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/387/someoneelse">SomeoneElse ♦</a><br/>
<span class="score" title="36866 reputation points"><span class="">36.9k</span></span><span title="71 badges"><span class="badge1">●</span><span class="badgecount">71</span></span><span title="370 badges"><span class="silver">●</span><span class="badgecount">370</span></span><span title="866 badges"><span class="bronze">●</span><span class="badgecount">866</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="SomeoneElse has 228 accepted answers">16%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/74366/">
                edited
                <strong>28 Apr '20, 01:12</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-74366">
<a name="74429"></a>
<div class="comment" id="comment-74429">
<div class="comment-score" id="post-74429-score"></div>
<div class="comment-text"><p>Thanks very much <a href="https://help.openstreetmap.org/users/387/someoneelse"></a><a href="https://help.openstreetmap.org/users/387/someoneelse">@SomeoneElse</a> for having looked into this!</p>
<p>"http://yourserveripaddress/hot/0/0/0.png" works, it shows a small &amp; blank map of the world.</p>
<p>I cleared everything under /var/lib/mod_tile/ajtk, ran "sudo -u renderaccount -- /usr/local/bin/renderd -fc /usr/local/etc/renderd.conf" manually and did not notice any error.  The browser's developer view complains only about not being able to find favicon.ico, other than that it loads successfully various .PNG files.</p>
<p>I loaded into postgres the data from us-pacific-latest.osm.pbf that I downloaded from <a href="https://download.geofabrik.de/north-america.html">https://download.geofabrik.de/north-america.html</a></p>
<p>I took a quick peek into the gis database and the tables seem to be populated with data:</p>
<p>gis=# SELECT COUNT(*) FROM "planet_osm_ways";
-[ RECORD 1 ]-
count | 486952</p>
<p>gis=# SELECT COUNT(*) FROM "planet_osm_nodes";
-[ RECORD 1 ]--
count | 9573637</p>
<p>Right on the Linux VM where I have this running I opened the ~/src/mod_tile/extra/sample_leaflet.html file in FireFox and I see only a blank map.</p>
<p>I'd guess that the expected behavior would be that if I zoom into the west coast of the N. American continent to see some map being rendered. I see only a blank map.</p></div>
<div class="comment-info" id="comment-74429-info">
<span class="comment-age">(28 Apr '20, 01:08)</span>
<a class="comment-user userinfo" href="/users/18251/eugen_nw">eugen_nw</a>
</div>
</div>
<a name="74430"></a>
<div class="comment" id="comment-74430">
<div class="comment-score" id="post-74430-score"></div>
<div class="comment-text"><p>Is there a way we can see the Mapnik component's log?  Is there a possibility that it cannot read the data from the Postgres database?</p></div>
<div class="comment-info" id="comment-74430-info">
<span class="comment-age">(28 Apr '20, 01:12)</span>
<a class="comment-user userinfo" href="/users/18251/eugen_nw">eugen_nw</a>
</div>
</div>
<a name="74431"></a>
<div class="comment" id="comment-74431">
<div class="comment-score" id="post-74431-score"></div>
<div class="comment-text"><p>Assuming you're running renderd in the background as you zoom around you should see "renderd" messages to /var/log/syslog .</p></div>
<div class="comment-info" id="comment-74431-info">
<span class="comment-age">(28 Apr '20, 01:28)</span>
<a class="comment-user userinfo" href="/users/387/someoneelse">SomeoneElse ♦</a>
</div>
</div>
<a name="74488"></a>
<div class="comment not_top_scorer" id="comment-74488">
<div class="comment-score" id="post-74488-score"></div>
<div class="comment-text"><p>As I run renderd interactively, I see in renderd's output START/DONE TILE information and that it writes data into metafiles. In the browser's F12 window I do see calls like 'http://51.141.179.146/osm_tiles/7/20/43.png' displayed in red and with (canceled) Status. That may very well explain the behavior that I'm experiencing and shows that the rendering is not very successful.</p>
<p>This begs the question on what logs I should start looking at to diagnose this problem and where are those logs located? Alternatively, what do I need to do in order to enable the required logs to get generated? From what I've seen so far, renderd appears to be doing the right thing, so it could be either Mapnik, Postgres or some fault in the data import process.</p></div>
<div class="comment-info" id="comment-74488-info">
<span class="comment-age">(30 Apr '20, 01:25)</span>
<a class="comment-user userinfo" href="/users/18251/eugen_nw">eugen_nw</a>
</div>
</div>
<a name="74496"></a>
<div class="comment" id="comment-74496">
<div class="comment-score" id="post-74496-score">1</div>
<div class="comment-text"><p>If you demand a tile at zoom 7 by the browser which had not been rendered before, your browser would have to wait minutes and minutes for that (meta)tile to render and caps the connection before the rendering is finished. Tiles below zoom 12 have to better be pre-rendered by render_list.</p></div>
<div class="comment-info" id="comment-74496-info">
<span class="comment-age">(30 Apr '20, 07:29)</span>
<a class="comment-user userinfo" href="/users/17439/spiekerooger">Spiekerooger</a>
</div>
</div>
<a name="74506"></a>
<div class="comment not_top_scorer" id="comment-74506">
<div class="comment-score" id="post-74506-score"></div>
<div class="comment-text"><p>Thanks very much <a href="https://help.openstreetmap.org/users/17439/spiekerooger"></a><a href="https://help.openstreetmap.org/users/17439/spiekerooger">@Spiekerooger</a> for having looked into this!  I can certainly run render_list beforehand.</p>
<p>The required .PNG files are getting generated during rendering, right?  Where are they cached please?  In the subdirectories of my /var/lib/mod_tile/ equivalent directory I see only *.meta files.</p>
<p>I see information like below in renderd's output which made me believe that the rendering completed.</p>
<p>renderd[13515]: DEBUG: START TILE ajt 6 8-15 16-23, new metatile<br/>
renderd[13515]: Rendering projected coordinates 6 8 16 -&gt; -15028131.257100|5009377.085700 -10018754.171400|10018754.171400 to a 8 x 8 tile<br/>
renderd[13515]: DEBUG: DONE TILE ajt 6 8-15 16-23 in 0.757 seconds
debug: Creating and writing a metatile to /datadrive/caches/osm_tiles/ajt/6/0/0/0/1/128.meta</p></div>
<div class="comment-info" id="comment-74506-info">
<span class="comment-age">(30 Apr '20, 11:09)</span>
<a class="comment-user userinfo" href="/users/18251/eugen_nw">eugen_nw</a>
</div>
</div>
<a name="74507"></a>
<div class="comment" id="comment-74507">
<div class="comment-score" id="post-74507-score">1</div>
<div class="comment-text"><p>They are only cached as metatitle in /var/lib/mod_tile or its equivalent. mod_tile (the apache module) retrieves the acutal tiles from the meta tile to display them.</p>
<p>What did you changed the TileLayer URL in your leaflet setup to?</p>
<p>It should be <a href="http://51.141.179.146/osm_tiles/{z}/{x}/{y}.png">http://51.141.179.146/osm_tiles/{z}/{x}/{y}.png</a> if "osm_tiles" is the url as defined in the renderd.conf.</p></div>
<div class="comment-info" id="comment-74507-info">
<span class="comment-age">(30 Apr '20, 12:43)</span>
<a class="comment-user userinfo" href="/users/17439/spiekerooger">Spiekerooger</a>
</div>
</div>
<a name="74516"></a>
<div class="comment not_top_scorer" id="comment-74516">
<div class="comment-score" id="post-74516-score"></div>
<div class="comment-text"><p>Thanks very much again!</p>
<p>Yes I have it set to 'http://51.141.179.146/osm_tiles/{z}/{x}/{y}.png'  The problem was that I did not have mod_tile configured in Apache2.  I did configure it and now all the 'http://51.141.179.146/osm_tiles/7/20/43.png' type calls sent from the browser are successful.  However, the map is still blank so now I'll start looking at the data in the Postgres database as I guess that missing/unreadable data may cause the tiles to display empty.</p>
<p>Alternatively, is it possible to enable logging in mod_tile so I can get an idea on what it does?</p></div>
<div class="comment-info" id="comment-74516-info">
<span class="comment-age">(30 Apr '20, 19:44)</span>
<a class="comment-user userinfo" href="/users/18251/eugen_nw">eugen_nw</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-74366">
<span class="comments-showing">
            showing 5 of 8
        </span>
<a class="show-all-comments-link" href="#">show 3 more comments</a>
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-74366-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<a name="74615"></a>
<div class="answer answered-by-owner" id="answer-container-74615">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/74615/up/" id="post-74615-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-74615-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/74615/down/" id="post-74615-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>I think that <a href="https://help.openstreetmap.org/users/17439/spiekerooger">@Spiekerooger</a> suggestion to run render_list got my maps to show, thanks very much!</p>
<p>I am not certain though because I did lots of tweaking using various pieces of information from two other OMS setup instructions websites.  As of right now, I think that <a href="https://www.linuxbabe.com/ubuntu/openstreetmap-tile-server-ubuntu-18-04-osm">https://www.linuxbabe.com/ubuntu/openstreetmap-tile-server-ubuntu-18-04-osm</a> has the best list of setup instructions.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/74615/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>04 May '20, 22:15</strong>
</p>
<img alt="eugen_nw's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/ad8f49d67fd7b8e25376900e86f57542?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/18251/eugen_nw">eugen_nw</a><br>
<span class="score" title="31 reputation points">31</span><span title="2 badges"><span class="badge1">●</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">●</span><span class="badgecount">2</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="eugen_nw has no accepted answers">0%</span>
</br></br></p>
</div>
</div>
<div class="comments-container" id="comments-container-74615">
</div>
<div class="comment-tools" id="comment-tools-74615">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-74615-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/74358/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="pO7hMbT80GLb7YVDEYWpfDsnA4iqkMze"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>