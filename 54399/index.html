<meta charset="utf-8"/><link href="../style.css" rel="stylesheet" type="text/css"/><div id="CALeft"><center><a href="../"><img id="ll" src="https://help.openstreetmap.org/upfiles/osm_help_logo_6.png"/></a></center>
<div class="headNormal">
<h1><a href="/questions/54399/how-to-query-and-select-the-polygon-by-postal-code">How to query and select the polygon by postal code ?</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/54399/up/" id="post-54399-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-54399-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/54399/down/" id="post-54399-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/54399/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>Hi OSM community,</p>
<p>I am totally new to Geodata and gis, so please try to answer even if its a dumb question.</p>
<p>My task is to find the distance between 2 given addresses using osm.</p>
<p>What I have done so far ?</p>
<ol>
<li>Downloaded osm.pbf file for my region</li>
<li>Imported it to local postgresql postgis enabled database with different tables (planet_osm_line, planet_osm_nodes, planet_osm_point, planet_osm_polygon.. etc)</li>
</ol>
<p>Approach for my task:</p>
<p>So to calculate the distance between 2 points I thought of gecoding the addresses first and then use st_distance() to find the distance between the 2 points. (Please correct me if my approach is not advisable)</p>
<p>Where I am stuck ?</p>
<p>To select the polygon using the postal code, I thought of filtering it through postal_code. Unfortunately it does not have a column named postal_code. So how could I achieve this using the above mentioned tables and geocode the address.</p>
<p>EDIT 1: Or is it possible to just extract "addr:city", "addr:country", "addr:housenumber", "addr:housename", "addr:postcode", "addr:street", "lat", "lon"fields from osm file using osmconvert and then query against it to get the lat/lon ?</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-osm2pgsql" href="/tags/osm2pgsql/" rel="tag" title="see questions tagged 'osm2pgsql'">osm2pgsql</a>
<a class="post-tag tag-link-postgis" href="/tags/postgis/" rel="tag" title="see questions tagged 'postgis'">postgis</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>01 Feb '17, 15:25</strong>
</p>
<img alt="3yK's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/2a95229b87eba17c63a633a8fe609aa2?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/13278/3yk">3yK</a><br/>
<span class="score" title="11 reputation points">11</span><span title="4 badges"><span class="badge1">●</span><span class="badgecount">4</span></span><span title="4 badges"><span class="silver">●</span><span class="badgecount">4</span></span><span title="8 badges"><span class="bronze">●</span><span class="badgecount">8</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="3yK has no accepted answers">0%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/54399/">
                edited
                <strong>01 Feb '17, 15:54</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-54399">
</div>
<div class="comment-tools" id="comment-tools-54399">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-54399-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    One Answer:
                    </div>
<div class="tabsA"><a href="/questions/54399/how-to-query-and-select-the-polygon-by-postal-code?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/54399/how-to-query-and-select-the-polygon-by-postal-code?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/54399/how-to-query-and-select-the-polygon-by-postal-code?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/54399/how-to-query-and-select-the-polygon-by-postal-code?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="54400"></a>
<div class="answer" id="answer-container-54400">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/54400/up/" id="post-54400-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-54400-score" title="current number of votes">
    1
</div>
<a class="ajax-command post-vote down" href="/vote/54400/down/" id="post-54400-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>It is of course possible to extract the addresses. Take a look at <a href="http://wiki.openstreetmap.org/wiki/Nominatim">http://wiki.openstreetmap.org/wiki/Nominatim</a></p>
<p>It depends on where you are located, but there is a good chance that there won't be polygon features associated with postal codes, or perhaps even much address data at all.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/54400/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>01 Feb '17, 16:12</strong>
</p>
<img alt="maxerickson's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/c860445e868ebb21da141635a4aa7b06?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/10973/maxerickson">maxerickson</a><br/>
<span class="score" title="12700 reputation points"><span class="">12.7k</span></span><span title="10 badges"><span class="badge1">●</span><span class="badgecount">10</span></span><span title="83 badges"><span class="silver">●</span><span class="badgecount">83</span></span><span title="176 badges"><span class="bronze">●</span><span class="badgecount">176</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="maxerickson has 93 accepted answers">32%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-54400">
<a name="54406"></a>
<div class="comment" id="comment-54406">
<div class="comment-score" id="post-54406-score"></div>
<div class="comment-text"><p>But the installation of nominatim seems a little bit complicated. My query looks simple. </p>
<p>Is it possible to geocode using the question I asked in the section EDIT 1 ? will it miss some data ?</p>
<p>What are the advantages of using nominatim over manual querying ?</p></div>
<div class="comment-info" id="comment-54406-info">
<span class="comment-age">(01 Feb '17, 16:42)</span>
<a class="comment-user userinfo" href="/users/13278/3yk">3yK</a>
</div>
</div>
<a name="54409"></a>
<div class="comment" id="comment-54409">
<div class="comment-score" id="post-54409-score">1</div>
<div class="comment-text"><p>You can investigate the results nominatim returns using the public server:</p>
<p><a href="http://nominatim.openstreetmap.org/">http://nominatim.openstreetmap.org/</a></p>
<p>nominatim builds on the osm2pgsql schema that you have used above, adding indexes and associations that are not necessarily explicitly given in any of the osm2gpsql tables. So what you are doing is starting to implement pieces of what nominatim does.</p></div>
<div class="comment-info" id="comment-54409-info">
<span class="comment-age">(01 Feb '17, 17:01)</span>
<a class="comment-user userinfo" href="/users/10973/maxerickson">maxerickson</a>
</div>
</div>
<a name="54427"></a>
<div class="comment" id="comment-54427">
<div class="comment-score" id="post-54427-score">1</div>
<div class="comment-text"><p>Nominatim takes the same data as you did but processes and stores it in such a way that geocoding is fast. This includes combining information from different types of relations and objects.</p>
<p>Postal code boundaries as mapped as separate relations in some countries (e.g. Germany, part of Belgium). This technique is not possible in e.g. the USA and the UK where zip codes are not areas.</p></div>
<div class="comment-info" id="comment-54427-info">
<span class="comment-age">(02 Feb '17, 12:04)</span>
<a class="comment-user userinfo" href="/users/5390/escada">escada</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-54400">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-54400-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/54399/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="RMnoLIT3izjlMmiSSaAVO3mXeDRpNdOP"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>