<meta charset="UTF-8"><link rel="stylesheet" type="text/css" href="../style.css"><div id="CALeft">
<div class="headNormal">
<h1><a href="/questions/45043/get-coordinates-from-osm-website-with-javascript">Get coordinates from OSM website with Javascript</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/45043/up/" id="post-45043-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-45043-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/45043/down/" id="post-45043-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/45043/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>I have a script that queries the front browser tab and if it's an OpenStreetMap.org map URL, extracts the latitude and longitude of the map's centre. This used to be accomplished simply by sending the following Javascript to the front tab:</p>
<pre><code>map.getCenter();
</code></pre>
<p>However, I haven't used the script in some time and this no longer works. I believe OSM was still using OpenLayers when I last used the script successfully and it's now using Leaflet? In any case, I've spent a couple of hours trying to find the map variable that I can send the <code>getCenter()</code> function to as detailed in the <a href="http://leafletjs.com/reference.html#map-get-methods">Leaflet documentation</a>, but no joy. Can anyone tell me how I can use Javascript to get the centre of the map on the current OSM website? To be clear, I'm not trying to write my own mapping application using OSM, I want this to work with the main OpenStreetMap.org website.</p>
<p>Thanks in advance.</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-leaflet" href="/tags/leaflet/" rel="tag" title="see questions tagged 'leaflet'">leaflet</a>
<a class="post-tag tag-link-openstreetmap" href="/tags/openstreetmap/" rel="tag" title="see questions tagged 'openstreetmap'">openstreetmap</a>
<a class="post-tag tag-link-javascript" href="/tags/javascript/" rel="tag" title="see questions tagged 'javascript'">javascript</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>03 Sep '15, 19:48</strong>
</p>
<img alt="Jolin%20Warren's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/7919ba114865547c7b7fafc112dbc024?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/460/jolin-warren">Jolin Warren</a><br/>
<span class="score" title="11 reputation points">11</span><span title="2 badges"><span class="badge1">●</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">●</span><span class="badgecount">2</span></span><span title="5 badges"><span class="bronze">●</span><span class="badgecount">5</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Jolin Warren has no accepted answers">0%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-45043">
</div>
<div class="comment-tools" id="comment-tools-45043">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-45043-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    2 Answers:
                    </div>
<div class="tabsA"><a href="/questions/45043/get-coordinates-from-osm-website-with-javascript?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/45043/get-coordinates-from-osm-website-with-javascript?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/45043/get-coordinates-from-osm-website-with-javascript?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/45043/get-coordinates-from-osm-website-with-javascript?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="45044"></a>
<div class="answer accepted-answer" id="answer-container-45044">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/45044/up/" id="post-45044-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-45044-score" title="current number of votes">
    2
</div>
<a class="ajax-command post-vote down" href="/vote/45044/down/" id="post-45044-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="accept-answer on" href="/accept_answer/45044/" rel="nofollow" title="Jolin Warren has selected this answer as the correct answer">
</a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>Center lat/lon and zoom level are in the URL of where ever your www.openstreetmap.org window is looking. . . Its been a while since I've looked at Javascript but I think you can access the URL within your code and then parse out the stuff you want.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/45044/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>03 Sep '15, 20:30</strong>
</p>
<img alt="n76's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/f60af53a4eba0c21f25c22674fb4a8cc?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/5918/n76">n76</a><br/>
<span class="score" title="10839 reputation points"><span class="">10.8k</span></span><span title="10 badges"><span class="badge1">●</span><span class="badgecount">10</span></span><span title="82 badges"><span class="silver">●</span><span class="badgecount">82</span></span><span title="172 badges"><span class="bronze">●</span><span class="badgecount">172</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="n76 has 48 accepted answers">17%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-45044">
<a name="45045"></a>
<div class="comment" id="comment-45045">
<div class="comment-score" id="post-45045-score"></div>
<div class="comment-text"><p>I did think about doing that, but the URL doesn't automatically update as you drag the map. One option is doing a page source dump and then searching through, as there are embedded links in the page that have updated lat/lon, but I'd rather not be screen scraping if I can avoid it. I'd prefer a cleaner solution where I query the lat/lon specifically. If it's possible!</p></div>
<div class="comment-info" id="comment-45045-info">
<span class="comment-age">(03 Sep '15, 20:43)</span>
<a class="comment-user userinfo" href="/users/460/jolin-warren">Jolin Warren</a>
</div>
</div>
<a name="45051"></a>
<div class="comment" id="comment-45051">
<div class="comment-score" id="post-45051-score"></div>
<div class="comment-text"><p>Thanks, that helped. I don't know what I was doing previously, but it turns out that the latitude, longitude, and zoom are continuously updated in the URL, and that bookmarklet uses the URL (<code>window.location.hash</code>). This works wonderfully. Thanks for your help.</p></div>
<div class="comment-info" id="comment-45051-info">
<span class="comment-age">(04 Sep '15, 13:03)</span>
<a class="comment-user userinfo" href="/users/460/jolin-warren">Jolin Warren</a>
</div>
</div>
<a name="45052"></a>
<div class="comment" id="comment-45052">
<div class="comment-score" id="post-45052-score"></div>
<div class="comment-text"><p>My mistake. I don't know what I was doing before, but you are right that the lat/lon and zoom are always updated in the URL (after the hash). Thanks stf, this is the way to go. You'll see from my <a href="#45051">answer below</a> that I used the Javascript property <code>window.location.hash</code> to extract the info I needed. Many thanks.</p></div>
<div class="comment-info" id="comment-45052-info">
<span class="comment-age">(04 Sep '15, 13:04)</span>
<a class="comment-user userinfo" href="/users/460/jolin-warren">Jolin Warren</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-45044">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-45044-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<a name="45047"></a>
<div class="answer" id="answer-container-45047">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/45047/up/" id="post-45047-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-45047-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/45047/down/" id="post-45047-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>There's a bookmarklet <a href="http://wiki.openstreetmap.org/wiki/OS_Locator_Musical_Chairs">here</a> that does it so I'm sure that you could get some info out of that :)</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/45047/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>03 Sep '15, 21:00</strong>
</p>
<img alt="SomeoneElse's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/0bf1aa22f7f5e045b0eb8beb79fe7907?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/387/someoneelse">SomeoneElse ♦</a><br/>
<span class="score" title="36866 reputation points"><span class="">36.9k</span></span><span title="71 badges"><span class="badge1">●</span><span class="badgecount">71</span></span><span title="370 badges"><span class="silver">●</span><span class="badgecount">370</span></span><span title="866 badges"><span class="bronze">●</span><span class="badgecount">866</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="SomeoneElse has 228 accepted answers">16%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-45047">
</div>
<div class="comment-tools" id="comment-tools-45047">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-45047-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/45043/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="KBjVAXugKEtLl8PMMRdoZlo4truCOMyB"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>