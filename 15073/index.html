<meta charset="utf-8"/><link href="../style.css" rel="stylesheet" type="text/css"/><div id="CALeft"><center><a href="../"><img id="ll" src="https://help.openstreetmap.org/upfiles/osm_help_logo_6.png"/></a></center>
<div class="headNormal">
<h1><a href="/questions/15073/how-to-get-a-list-of-streetnames-located-in-a-polygon">how to get a list of streetnames located in a polygon</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/15073/up/" id="post-15073-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-15073-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/15073/down/" id="post-15073-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/15073/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>How would one implement the following functionality : a user draws a polygon on a map and receives as a result a list of streetnames (or addresses) which are located within the polygon. </p>
<p>Doesn't matter which maps, api or scripting language. Any ideas?</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-geocoding" href="/tags/geocoding/" rel="tag" title="see questions tagged 'geocoding'">geocoding</a>
<a class="post-tag tag-link-reverse" href="/tags/reverse/" rel="tag" title="see questions tagged 'reverse'">reverse</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>14 Aug '12, 14:41</strong>
</p>
<img alt="jvm985's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/0605c7c14899a65be4ee3dc022cef244?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/4294/jvm985">jvm985</a><br/>
<span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">●</span><span class="badgecount">2</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="jvm985 has no accepted answers">0%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-15073">
</div>
<div class="comment-tools" id="comment-tools-15073">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-15073-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    2 Answers:
                    </div>
<div class="tabsA"><a href="/questions/15073/how-to-get-a-list-of-streetnames-located-in-a-polygon?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/15073/how-to-get-a-list-of-streetnames-located-in-a-polygon?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/15073/how-to-get-a-list-of-streetnames-located-in-a-polygon?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/15073/how-to-get-a-list-of-streetnames-located-in-a-polygon?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="15105"></a>
<div class="answer" id="answer-container-15105">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/15105/up/" id="post-15105-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-15105-score" title="current number of votes">
    1
</div>
<a class="ajax-command post-vote down" href="/vote/15105/down/" id="post-15105-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>If you are able to split the polygon into bounding boxes you can use multiple <a href="http://wiki.openstreetmap.org/wiki/Overpass_API">OverpassAPI</a> queries.</p>
<p>This example query will list all ways with a highway and a way tag:</p>
<pre><code><a href="http://overpass.osm.rambler.ru/cgi/interpreter?data=[out:json];way[highway][name]%2850.66%2C10.91%2C50.7%2C10.95%29%3Bout%3B">http://overpass.osm.rambler.ru/cgi/interpreter?data=[out:json];way[highway][name]%2850.66%2C10.91%2C50.7%2C10.95%29%3Bout%3B</a>
</code></pre>
<p><strike>(Note: the regular expression <em>name~'.'</em> is only required due to a recently introduced <a href="http://help.openstreetmap.org/questions/15101/overpassapi-query-with-two-specific-keys-and-any-value">bug</a> and can be simplified by just specifying <em>name</em> in the future).</strike></p>
<p>You just have to parse this output and extract all <em>name</em> fields.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/15105/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>15 Aug '12, 08:36</strong>
</p>
<img alt="scai's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/52d3234f3be58156770e8a91d575bfbd?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/158/scai">scai ♦</a><br/>
<span class="score" title="33317 reputation points"><span class="">33.3k</span></span><span title="21 badges"><span class="badge1">●</span><span class="badgecount">21</span></span><span title="309 badges"><span class="silver">●</span><span class="badgecount">309</span></span><span title="459 badges"><span class="bronze">●</span><span class="badgecount">459</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="scai has 168 accepted answers">23%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/15105/">
                edited
                <strong>15 Aug '12, 11:56</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-15105">
<a name="15109"></a>
<div class="comment" id="comment-15109">
<div class="comment-score" id="post-15109-score">1</div>
<div class="comment-text"><p>The bug has been fixed.</p></div>
<div class="comment-info" id="comment-15109-info">
<span class="comment-age">(15 Aug '12, 11:43)</span>
<a class="comment-user userinfo" href="/users/3480/roland-olbricht">Roland Olbricht</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-15105">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-15105-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<a name="15081"></a>
<div class="answer" id="answer-container-15081">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/15081/up/" id="post-15081-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-15081-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/15081/down/" id="post-15081-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>First you need to determine what the inner surface of your closed way is (if the way is oriented, you can save this with "left" or "right").</p>
<p>You can do this by connecting an arbitrary point of your polygon with a special point that will never be included in the polygon (like the north pole, there are no streets there).</p>
<p>Now, if the drawn line intersects with your polygon, draw the line again from that intersection point, until it doesn't intersect any more. After that, you can check if the line is right or left from the polygon boundary.</p>
<p>After that, for each point in your dataset*, you draw a line from the point (the direction doesn't matter). If the line doesn't cut with the drawn polygon, it's not in it. If the line cuts, you can check wether the part between your node and the line is left or right from your polygon and thus check if it's in or out the polygon. </p>
<p>And as a last thing, get all the ways that have a node in the selection you've received.</p>
<p>*) you can filter your dataset a bit on beforehand by placing the polygon in a BBOX and filtering on that BBOX first.</p>
<p>This method requires you know how to calculate intersection points and how to check if a line segment is left or right of an other segment (in other words, calculate the corner between two segments).</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/15081/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>14 Aug '12, 16:49</strong>
</p>
<img alt="Sanderd17's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/1fe9a0c696a5000fb304ababea9f83af?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/280/sanderd17">Sanderd17</a><br/>
<span class="score" title="1111 reputation points"><span class="">1.1k</span></span><span title="5 badges"><span class="badge1">●</span><span class="badgecount">5</span></span><span title="16 badges"><span class="silver">●</span><span class="badgecount">16</span></span><span title="37 badges"><span class="bronze">●</span><span class="badgecount">37</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Sanderd17 has 15 accepted answers">31%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-15081">
<a name="15087"></a>
<div class="comment" id="comment-15087">
<div class="comment-score" id="post-15087-score"></div>
<div class="comment-text"><p>thanks for your reply which is quite helpful. </p>
<p>The thing is that I don't have a dataset with coordinates. I want the script to return a set of streetnames that are (partly) enclosed. I could come up with a list of streetnames, but not simple coordinates.</p>
<p>Does that make sense?</p></div>
<div class="comment-info" id="comment-15087-info">
<span class="comment-age">(14 Aug '12, 18:12)</span>
<a class="comment-user userinfo" href="/users/4294/jvm985">jvm985</a>
</div>
</div>
<a name="15088"></a>
<div class="comment" id="comment-15088">
<div class="comment-score" id="post-15088-score"></div>
<div class="comment-text"><p>Oh, so you want to get it live from OSM?</p>
<p>That depends on how big the polygon is, and how often you do a query in the same area.</p>
<p>You can first calculate a BBOX (biggest and smallest lat-lon values), and get data from OSM in that BBOX. This would work if your polygon is small enough.</p>
<p>Otherwise, you will have to work with an offline database.</p></div>
<div class="comment-info" id="comment-15088-info">
<span class="comment-age">(14 Aug '12, 18:18)</span>
<a class="comment-user userinfo" href="/users/280/sanderd17">Sanderd17</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-15081">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-15081-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/15073/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="ayynsjJq57KF6HzdFWxqcyFt4sUZ7PNh"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>