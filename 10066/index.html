<meta charset="UTF-8"><link rel="stylesheet" type="text/css" href="../style.css"><div id="CALeft">
<div class="headNormal">
<h1><a href="/questions/10066/what-is-wrong-with-my-batch-file">What is wrong with my batch file?</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/10066/up/" id="post-10066-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-10066-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/10066/down/" id="post-10066-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/10066/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>I have just purchased a new computer with windows 7 and 4GByte RAM.</p>
<p>I have installed java.jar version 6 (as directed by osm-instructions!</p>
<p>I have installed josm-latest.jar to C:osm\</p>
<p>josm-latest.jar starts and runs without any problem: i.e. as expected!</p>
<p>I have created a batch file josm.bat in C:osm to invoke the Xmx option but it does not work and I cannot figure out why.</p>
<p><img alt="alt text" src="http://help.openstreetmap.org/upfiles/Capture.PNG"/></p>
<p>Whats wrong?
For any advice I will be very grateful</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-josm" href="/tags/josm/" rel="tag" title="see questions tagged 'josm'">josm</a>
<a class="post-tag tag-link-xmx" href="/tags/xmx/" rel="tag" title="see questions tagged 'xmx'">xmx</a>
<a class="post-tag tag-link-batch" href="/tags/batch/" rel="tag" title="see questions tagged 'batch'">batch</a>
<a class="post-tag tag-link-java" href="/tags/java/" rel="tag" title="see questions tagged 'java'">java</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>19 Jan '12, 17:19</strong>
</p>
<img alt="dcp's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/cd4569f9fa1aac11eb6b19d6de309ea6?s=32&amp;d=identicon&amp;r=g" width="32">
<p><a href="/users/716/dcp">dcp</a><br/>
<span class="score" title="721 reputation points">721</span><span title="37 badges"><span class="badge1">●</span><span class="badgecount">37</span></span><span title="44 badges"><span class="silver">●</span><span class="badgecount">44</span></span><span title="56 badges"><span class="bronze">●</span><span class="badgecount">56</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="dcp has no accepted answers">0%</span>
</p>
</img></div>
</div>
<div class="comments-container" id="comments-container-10066">
<a name="10067"></a>
<div class="comment" id="comment-10067">
<div class="comment-score" id="post-10067-score"></div>
<div class="comment-text"><p>What is the output when you type "java -version" ?</p>
<p>Do you have Win7 and Java as 32bit or 64bit version?</p></div>
<div class="comment-info" id="comment-10067-info">
<span class="comment-age">(19 Jan '12, 17:24)</span>
<a class="comment-user userinfo" href="/users/99/stephan75">stephan75</a>
</div>
</div>
<a name="10070"></a>
<div class="comment" id="comment-10070">
<div class="comment-score" id="post-10070-score"></div>
<div class="comment-text"><p>java -version does not pass the version but replies with the same text  as above i.e. `java´ is not recognised..........
I don't know how to determine whether I have 32bit or 64bit versions.
I am still looking.
It seems that my batch file can´t find java. I just don´t know!</p></div>
<div class="comment-info" id="comment-10070-info">
<span class="comment-age">(19 Jan '12, 17:56)</span>
<a class="comment-user userinfo" href="/users/716/dcp">dcp</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-10066">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-10066-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    4 Answers:
                    </div>
<div class="tabsA"><a href="/questions/10066/what-is-wrong-with-my-batch-file?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/10066/what-is-wrong-with-my-batch-file?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/10066/what-is-wrong-with-my-batch-file?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/10066/what-is-wrong-with-my-batch-file?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="10068"></a>
<div class="answer" id="answer-container-10068">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/10068/up/" id="post-10068-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-10068-score" title="current number of votes">
    3
</div>
<a class="ajax-command post-vote down" href="/vote/10068/down/" id="post-10068-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>I am using this: <code>start java.exe -Xmx1024M -jar josm-%downloadFileVersion%.jar</code> and it works.<br/>
Your problem might be that java directory is not in PATH (try writng set PATH). Add it to PATH or use full path for java (C:Program Files...java.exe).</p>
<p>The whole starting script:</p>
<pre><code>@echo off
rem default settings

set downloadFileVersion=tested
set runTracerServer=true

rem read parameters
:Loop
IF "%1"=="" GOTO Continue

    echo %1
    GOTO %1

    :/latest
        set downloadFileVersion=latest
        goto :END_SWITCH

    :/noupdate
        goto runapps

    :/notracer
    set runTracerServer=false
        goto :END_SWITCH

    :/help
        echo:JOSM starter script
        echo:starts JOSM tested or latest version, updates the program if needed. 
        echo:keeps all settings in the directory from where it was started
        echo:run [/latest] [/notracer] [/help] [/noupdate]
        echo:    /latest    runs latest version instead of tested
        echo:    /notracer  does not run tracer server
        echo:    /help  displays this help
        echo:    /noupdate  does not run update, any parameters after this one are ignored
        goto end

    :/?
    goto /help

    :-?
        goto /help

    :-help
        goto /help

    GOTO END_SWITCH
    :END_SWITCH
SHIFT
GOTO Loop
:Continue

echo:Setting up settings + plugin location
set APPDATA=appdata
echo:set to %APPDATA%

echo:Determining actual %downloadFileVersion% version number (server)
curl <a href="http://josm.openstreetmap.de/%downloadFileVersion%">http://josm.openstreetmap.de/%downloadFileVersion%</a> -verbose -o %downloadFileVersion%.txt
set /p serverVersion=&lt;%downloadFileVersion%.txt

echo:Determining current version
java.exe -Xmx1024M -jar josm-%downloadFileVersion%.jar -? | findstr /C:"Revision" &gt; <a href="http://current.txt">current.txt</a>
set /p temp=&lt;<a href="http://current.txt">current.txt</a>
set currentVersion=%temp:~10,4%

echo Server %downloadFileVersion%: %serverVersion%
echo Local %downloadFileVersion%: %currentVersion%

set /a diffVersion=serverVersion-currentVersion
echo Difference: %diffVersion%

if %diffVersion% == 0 (
    echo:JOSM is up to date 
    goto runapps
) else (
    echo:Update or downgrade needed
)

echo:Downloading latest version
rem Download to temporary file, then copy and remove - to prevent file corruption when download fails
curl <a href="http://josm.openstreetmap.de/download/josm-%downloadFileVersion%.jar">http://josm.openstreetmap.de/download/josm-%downloadFileVersion%.jar</a> -o josm-%downloadFileVersion%-download.jar
rem todo - check download success
move /Y josm-%downloadFileVersion%-download.jar josm-%downloadFileVersion%.jar
del josm-%downloadFileVersion%-download.jar

:runapps

echo:Starting JOSM 
start java.exe -Xmx1024M -jar josm-%downloadFileVersion%.jar

if %runTracerServer% == true (
    echo:Starting tracer server
    start TracerServer\bin\Osm.Kn.Trace.Server.exe
)

rem pause

rem Delete temporary files
del %downloadFileVersion%.txt
del <a href="http://current.txt">current.txt</a>

:end
</code></pre>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/10068/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>19 Jan '12, 17:32</strong>
</p>
<img alt="LM_1's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/15c1efc9ebb466f69907a3e85693e739?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/1619/lm_1">LM_1</a><br>
<span class="score" title="3287 reputation points"><span class="">3.3k</span></span><span title="33 badges"><span class="badge1">●</span><span class="badgecount">33</span></span><span title="51 badges"><span class="silver">●</span><span class="badgecount">51</span></span><span title="88 badges"><span class="bronze">●</span><span class="badgecount">88</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="LM_1 has 7 accepted answers">10%</span>
</br></p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/10068/">
                edited
                <strong>19 Jan '12, 17:40</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-10068">
<a name="10071"></a>
<div class="comment" id="comment-10071">
<div class="comment-score" id="post-10071-score"></div>
<div class="comment-text"><p>Wow! This is a above my level of competance!</p>
<p>I can´t even figure out what this batch file will do!</p></div>
<div class="comment-info" id="comment-10071-info">
<span class="comment-age">(19 Jan '12, 17:58)</span>
<a class="comment-user userinfo" href="/users/716/dcp">dcp</a>
</div>
</div>
<a name="10097"></a>
<div class="comment" id="comment-10097">
<div class="comment-score" id="post-10097-score"></div>
<div class="comment-text"><p>It downloads (updates) the latest or tested version if it there is one  available and starts JOSM. Plus it starts tracer server, but that is really useful only in the Czech Republic.</p></div>
<div class="comment-info" id="comment-10097-info">
<span class="comment-age">(20 Jan '12, 10:20)</span>
<a class="comment-user userinfo" href="/users/1619/lm_1">LM_1</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-10068">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-10068-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<a name="10069"></a>
<div class="answer" id="answer-container-10069">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/10069/up/" id="post-10069-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-10069-score" title="current number of votes">
    3
</div>
<a class="ajax-command post-vote down" href="/vote/10069/down/" id="post-10069-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>LM_1 has provided an interesting, if lengthy batch file. Mine, on 64 bit Windows 7, simply reads:</p>
<pre><code>C:\Windows\SysWOW64\java -Xmx1500m -jar C:\Users\Ed\Downloads\JOSM\josm-latest.jar
</code></pre>
<p>Which I think is "using the full path" as he suggested:</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/10069/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>19 Jan '12, 17:44</strong>
</p>
<img alt="EdLoach's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/f25a8392e12ed696b16554b3d08e4e2b?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/339/edloach">EdLoach ♦</a><br/>
<span class="score" title="19478 reputation points"><span class="">19.5k</span></span><span title="16 badges"><span class="badge1">●</span><span class="badgecount">16</span></span><span title="156 badges"><span class="silver">●</span><span class="badgecount">156</span></span><span title="280 badges"><span class="bronze">●</span><span class="badgecount">280</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="EdLoach has 93 accepted answers">22%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-10069">
<a name="10072"></a>
<div class="comment" id="comment-10072">
<div class="comment-score" id="post-10072-score"></div>
<div class="comment-text"><p>Are you suggesting that my batch-file should be moved to to:</p>
<p>C:WindowsSysWOW64\</p></div>
<div class="comment-info" id="comment-10072-info">
<span class="comment-age">(19 Jan '12, 18:06)</span>
<a class="comment-user userinfo" href="/users/716/dcp">dcp</a>
</div>
</div>
<a name="10074"></a>
<div class="comment" id="comment-10074">
<div class="comment-score" id="post-10074-score">1</div>
<div class="comment-text"><p>No. When you run the command <em>java</em> it will look for the file <em>java.exe</em> or <em>java.bat</em> in the current directory and then in the list of directories in the <em>PATH</em> variable. If it can not find the file it will print an error message.</p>
<p>If you run the command <em>C:WindowsSysWOW64java</em> it will look for the file in *C:WindowsSysWOW64*.</p>
<p>LM_1 is sugesting that you run <em>start java</em> whitch uses a different <em>PATH</em>, while EdLoach sugests that you use the full path. It does not matter where the batch file is located.</p>
<p>(Moving the batch file to *C:WindowsSysWOW64* would fix the problem.)</p></div>
<div class="comment-info" id="comment-10074-info">
<span class="comment-age">(19 Jan '12, 20:30)</span>
<a class="comment-user userinfo" href="/users/131/gnonthgol">Gnonthgol ♦</a>
</div>
</div>
<a name="10085"></a>
<div class="comment" id="comment-10085">
<div class="comment-score" id="post-10085-score"></div>
<div class="comment-text"><p>I changed my josm.bat file to :
C:WindowsSysWOW64java -Xmx1024m -jar C:osmjosm-latest</p>
<p>This is what was returned:
Error occurred during initialization of VM
Could not reserve enough space for object heap
Could not create the Java virtual machine</p>
<p>I then reduced the -Xmx requirements to 512 and this functioned.</p>
<p>But this begs the question: Why, if I buy a new computer with 6GByte of RAM, can`t I get more than 512MByte allocated. -Xmx1024m functioned on my old computer with 2GByte of RAM. Could it be that my RAM is defect?</p></div>
<div class="comment-info" id="comment-10085-info">
<span class="comment-age">(20 Jan '12, 06:44)</span>
<a class="comment-user userinfo" href="/users/716/dcp">dcp</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-10069">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-10069-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<a name="12842"></a>
<div class="answer" id="answer-container-12842">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/12842/up/" id="post-12842-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-12842-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/12842/down/" id="post-12842-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>There is a YouTube tutorial video of CMD and Java,</p>
<p><a href="http://www.youtube.com/watch?v=Hl-zzrqQoSE">link</a></p>
<p>i hope it helps you...</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/12842/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>21 May '12, 12:46</strong>
</p>
<img alt="nadi106's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/aa84f224b2a82f15b2a76e4c49cf1c39?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/3647/nadi106">nadi106</a><br/>
<span class="score" title="-1 reputation points">-1</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">●</span><span class="badgecount">2</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="nadi106 has no accepted answers">0%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-12842">
<a name="12844"></a>
<div class="comment" id="comment-12844">
<div class="comment-score" id="post-12844-score"></div>
<div class="comment-text"><p>That covers sticking Java in the path (which was the original problem) but doesn't cover 32- vs 64-bit stuff though - have a look <a href="http://answers.microsoft.com/en-us/windows/forum/windows_7-windows_programs/why-is-java-under-program-files-and-windows/58cc27a9-a4cd-4d5f-baf6-9c4fae780828">here</a> for a question on that and <a href="http://msdn.microsoft.com/en-us/magazine/cc300794.aspx">here</a> for more detailed information.</p>
<p>A stackoverflow question about the "heap" message (unfortunately without an answer to the "but I have 6Gb" issue) is <a href="http://stackoverflow.com/questions/6642184/could-not-reserve-enough-space-for-object-heap-to-start-jvm">here</a>.</p></div>
<div class="comment-info" id="comment-12844-info">
<span class="comment-age">(21 May '12, 13:23)</span>
<a class="comment-user userinfo" href="/users/387/someoneelse">SomeoneElse ♦</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-12842">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-12842-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<a name="12846"></a>
<div class="answer" id="answer-container-12846">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/12846/up/" id="post-12846-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-12846-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/12846/down/" id="post-12846-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>In answer to this question:</p>
<p>'But this begs the question: Why, if I buy a new computer with 6GByte of RAM, can`t I get more than 512MByte allocated. -Xmx1024m functioned on my old computer with 2GByte of RAM. Could it be that my RAM is defect?'</p>
<p>I suspect that you need to use the 64-bit Java.exe not the 32-bit one.  On my (Windows 7, 4Gb) PC 32-bit Java fails to start JOSM with 1.4Gb max allocated, but 64-bit Java has not problem with 3Gb.</p>
<p>Your 32-bit version of Java is probably installed in somewhere like:</p>
<pre><code>"c:\Program Files (x86)\Java\jdk1.6.0_32\bin\"
(also available via) "c:\windows\syswow64\"
</code></pre>
<p>Your 64-bit version of Java is probably installed in somewhere like:</p>
<pre><code>"C:\Program Files\Java\jre6\bin\"
</code></pre>
<p>Try using that to start JOSM instead.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/12846/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>21 May '12, 13:41</strong>
</p>
<img alt="SomeoneElse's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/0bf1aa22f7f5e045b0eb8beb79fe7907?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/387/someoneelse">SomeoneElse ♦</a><br/>
<span class="score" title="36866 reputation points"><span class="">36.9k</span></span><span title="71 badges"><span class="badge1">●</span><span class="badgecount">71</span></span><span title="370 badges"><span class="silver">●</span><span class="badgecount">370</span></span><span title="866 badges"><span class="bronze">●</span><span class="badgecount">866</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="SomeoneElse has 228 accepted answers">16%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-12846">
</div>
<div class="comment-tools" id="comment-tools-12846">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-12846-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/10066/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="0F3yftEfhvnNjwt7dCS0Prv0txfb17pL"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>