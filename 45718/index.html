<meta charset="UTF-8"><link rel="stylesheet" type="text/css" href="../style.css"><div id="CALeft">
<div class="headNormal">
<h1><a href="/questions/45718/clip-part-from-map-with-a-boundary-polygon-and-adjust-intersected-polygons-from-boundary">Clip part from map with a boundary polygon and adjust intersected polygons from boundary</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/45718/up/" id="post-45718-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-45718-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/45718/down/" id="post-45718-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/45718/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
   1
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>I want to extract (clip) a part of the map with a predefined boundary polygon. I have seen that I can do it with <strong>osmosis</strong> or <strong>osmconvert</strong>. But I get the problem, that polygons that intersects the predefined boundary polygon are no more polygons but only lines (because the polygon gets cropped). How can I automatically adjust intersected polygons to the boundary polygon?</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-boundaries" href="/tags/boundaries/" rel="tag" title="see questions tagged 'boundaries'">boundaries</a>
<a class="post-tag tag-link-intersection" href="/tags/intersection/" rel="tag" title="see questions tagged 'intersection'">intersection</a>
<a class="post-tag tag-link-extract" href="/tags/extract/" rel="tag" title="see questions tagged 'extract'">extract</a>
<a class="post-tag tag-link-polygon" href="/tags/polygon/" rel="tag" title="see questions tagged 'polygon'">polygon</a>
<a class="post-tag tag-link-multipolygon" href="/tags/multipolygon/" rel="tag" title="see questions tagged 'multipolygon'">multipolygon</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>05 Oct '15, 13:22</strong>
</p>
<img alt="phlegx's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/fa82129a285be4619d5009aa2e2083a9?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/11536/phlegx">phlegx</a><br/>
<span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">●</span><span class="badgecount">3</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="phlegx has no accepted answers">0%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/45718/">
                edited
                <strong>05 Oct '15, 13:22</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-45718">
<a name="45719"></a>
<div class="comment" id="comment-45719">
<div class="comment-score" id="post-45719-score"></div>
<div class="comment-text"><p>Please explain what you want to do with the extract once created. This will make it easier for us to suggest something.</p></div>
<div class="comment-info" id="comment-45719-info">
<span class="comment-age">(05 Oct '15, 14:45)</span>
<a class="comment-user userinfo" href="/users/104/frederik-ramm">Frederik Ramm ♦</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-45718">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-45718-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    One Answer:
                    </div>
<div class="tabsA"><a href="/questions/45718/clip-part-from-map-with-a-boundary-polygon-and-adjust-intersected-polygons-from-boundary?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/45718/clip-part-from-map-with-a-boundary-polygon-and-adjust-intersected-polygons-from-boundary?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/45718/clip-part-from-map-with-a-boundary-polygon-and-adjust-intersected-polygons-from-boundary?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/45718/clip-part-from-map-with-a-boundary-polygon-and-adjust-intersected-polygons-from-boundary?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="45751"></a>
<div class="answer" id="answer-container-45751">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/45751/up/" id="post-45751-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-45751-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/45751/down/" id="post-45751-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>From your question I understand that you are aiming at clipping the map objects to/by an arbitrary polygon (CP, the Clipping Polygon). Especially, clipping areas defined by Multi-polygon relations. The subject is pretty complex and I don't think you will find open/public code doing that. At the same time area clipping is one of the essential functions of any modern vector map-making so, many of us (must) have it. Here are some hints to one possible solution.  <br/>
 1. Pre-processing. Eliminate any replications (nodes, vectors...) and convert area objects into simple/primitive disjunctive objects (one outer and arbitrary inner border polygons). Strictly, this step is not necessary but soon or later these events may cause algorithm exceptions.  <br/>
 2. Detect and handle trivial cases (the area is guaranteed outside/inside the CP, the CP is inside a hole, the CP is covered by the area and so on). In these cases polygons don't need to be really clipped.  <br/>
 3. For any area border polygon P, that should be clipped, detect the inside-out and the consecutive outside-in crossings with the CP (note that if one of these crossings exist the other one must exist too). Replace the outside P segment between these crossing points with the corresponding CP segment providing the same orientation.  <br/>
 4. Now, you have all polygons inside the CP (strictly inside or eventually with partly overlapping borders exactly on the CP). Make the area restructuring (detect the outer and the corresponding inner polygons).
 5. Finally, if you really want a precise area clipping, remove the overlapping outer-inner polygon segments and reconnect the 2 complementary outer/inner segment.  <br/>
Note that while this is working fine, in practice we usually use another model. We detect all vector tails that are not outside the CP (e.g. country border, district border). This tile coverage provides a bit more than the first (more or less academic) option. Note also that there are many fine details missing in the hints. Most of them you may find in Polygon Algebra and Topology student books.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/45751/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>06 Oct '15, 14:28</strong>
</p>
<img alt="sanser's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/03cd9ea0efd97a7040fda0d6a76aba8e?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/3194/sanser">sanser</a><br>
<span class="score" title="695 reputation points">695</span><span title="38 badges"><span class="badge1">●</span><span class="badgecount">38</span></span><span title="39 badges"><span class="silver">●</span><span class="badgecount">39</span></span><span title="55 badges"><span class="bronze">●</span><span class="badgecount">55</span></span><br>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="sanser has 2 accepted answers">5%</span>
</br></br></p>
</div>
</div>
<div class="comments-container" id="comments-container-45751">
</div>
<div class="comment-tools" id="comment-tools-45751">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-45751-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/45718/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="yCRdUP09qIBJVsQDKxPoJN7OhyfhufAz"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>