<meta charset="UTF-8"><link rel="stylesheet" type="text/css" href="../style.css"><div id="CALeft">
<div class="headNormal">
<h1><a href="/questions/68797/filter-query-by-total-amount-of-certain-locations-from-same-brand">filter query by total amount of certain locations from same brand</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/68797/up/" id="post-68797-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-68797-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/68797/down/" id="post-68797-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/68797/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>edit: I meant overpass not nominatum</p>
<p>Hi there, I have a map where I show small locations. In order to do so I send a query to Overpass-api (for example 'amenity=supermarket') , then when it gets back I filter out all the big brand names (from a local hand typed array) and display the result on the map. </p>
<p>To save time and data usage on both sides it would be great to filter the results on the overpass side before returning the result. For example 'if name and type has more then 10 locations in country x then remove from result'. </p>
<p>My question: is this even possible? </p>
<p>p.s. I know of a 'corporate' or 'chain' tag for shops, but it doesn's seem to be spread much so that's not of use, yet. </p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-filter" href="/tags/filter/" rel="tag" title="see questions tagged 'filter'">filter</a>
<a class="post-tag tag-link-query" href="/tags/query/" rel="tag" title="see questions tagged 'query'">query</a>
<a class="post-tag tag-link-tags" href="/tags/tags/" rel="tag" title="see questions tagged 'tags'">tags</a>
<a class="post-tag tag-link-overpass" href="/tags/overpass/" rel="tag" title="see questions tagged 'overpass'">overpass</a>
<a class="post-tag tag-link-poi" href="/tags/poi/" rel="tag" title="see questions tagged 'poi'">poi</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>15 Apr '19, 15:48</strong>
</p>
<img alt="tijmenheid's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/89858e1d0e500ae658bf8cf7fc4964c9?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/16106/tijmenheid">tijmenheid</a><br/>
<span class="score" title="41 reputation points">41</span><span title="5 badges"><span class="badge1">●</span><span class="badgecount">5</span></span><span title="5 badges"><span class="silver">●</span><span class="badgecount">5</span></span><span title="11 badges"><span class="bronze">●</span><span class="badgecount">11</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="tijmenheid has no accepted answers">0%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/68797/">
                edited
                <strong>16 Apr '19, 12:09</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-68797">
</div>
<div class="comment-tools" id="comment-tools-68797">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-68797-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    2 Answers:
                    </div>
<div class="tabsA"><a href="/questions/68797/filter-query-by-total-amount-of-certain-locations-from-same-brand?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/68797/filter-query-by-total-amount-of-certain-locations-from-same-brand?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/68797/filter-query-by-total-amount-of-certain-locations-from-same-brand?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/68797/filter-query-by-total-amount-of-certain-locations-from-same-brand?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="68973"></a>
<div class="answer accepted-answer" id="answer-container-68973">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/68973/up/" id="post-68973-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-68973-score" title="current number of votes">
    1
</div>
<a class="ajax-command post-vote down" href="/vote/68973/down/" id="post-68973-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="accept-answer on" href="/accept_answer/68973/" rel="nofollow" title="tijmenheid has selected this answer as the correct answer">
</a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>You can use a query like <a href="https://overpass-turbo.eu/s/Ii9">this one</a>. The parameter for the number of equal named objects is in line 4.</p>
<p>Whether it makes sense if a different question. Note that there are many supermarkets with spelling variants in their name, keeping the less popular spelling variants intact. Or have combined names like "REWE Ihr Kaufpark", thus distinct from "REWE".</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/68973/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>26 Apr '19, 19:01</strong>
</p>
<img alt="Roland%20Olbricht's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/fcfdb0825826fd13d2ff0d83d58819c6?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/3480/roland-olbricht">Roland Olbricht</a><br/>
<span class="score" title="6666 reputation points"><span class="">6.7k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="64 badges"><span class="silver">●</span><span class="badgecount">64</span></span><span title="89 badges"><span class="bronze">●</span><span class="badgecount">89</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Roland Olbricht has 40 accepted answers">36%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-68973">
<a name="69039"></a>
<div class="comment" id="comment-69039">
<div class="comment-score" id="post-69039-score"></div>
<div class="comment-text"><p>Thanks Roland, the 'count' is indeed what I was looking for. (though the example doesn'T seem to work) For now the filtering I do with JS, and some tricks to filter out 'REWE Ihr Kaufpark' were a bit hard in the beginning but got it working now.</p></div>
<div class="comment-info" id="comment-69039-info">
<span class="comment-age">(02 May '19, 08:54)</span>
<a class="comment-user userinfo" href="/users/16106/tijmenheid">tijmenheid</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-68973">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-68973-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<a name="68801"></a>
<div class="answer" id="answer-container-68801">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/68801/up/" id="post-68801-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-68801-score" title="current number of votes">
    4
</div>
<a class="ajax-command post-vote down" href="/vote/68801/down/" id="post-68801-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>You are not saying what infrastructure you are using (your own instance of Nominatim or some public one) nor if you would be able to change that. But what you are trying to do seems to me to be better served by the <a href="https://wiki.openstreetmap.org/wiki/Overpass_API">Overpass API</a>. With that you can search for keys (e. g. amenity=supermarket), look in specific areas, count results and add/subtract result sets.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/68801/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>15 Apr '19, 17:30</strong>
</p>
<img alt="TZorn's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/ddebc8d5f4e0458413eacf65e36561a9?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/10133/tzorn">TZorn</a><br/>
<span class="score" title="12350 reputation points"><span class="">12.3k</span></span><span title="7 badges"><span class="badge1">●</span><span class="badgecount">7</span></span><span title="64 badges"><span class="silver">●</span><span class="badgecount">64</span></span><span title="225 badges"><span class="bronze">●</span><span class="badgecount">225</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="TZorn has 63 accepted answers">15%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-68801">
<a name="68807"></a>
<div class="comment" id="comment-68807">
<div class="comment-score" id="post-68807-score"></div>
<div class="comment-text"><p>Oops you're right I meant OVerpass-api, just corrected it. Searches work fine, but do you know of a way to filter searches before returning them? (I mean like the example I posted, not the general ones)</p></div>
<div class="comment-info" id="comment-68807-info">
<span class="comment-age">(16 Apr '19, 12:12)</span>
<a class="comment-user userinfo" href="/users/16106/tijmenheid">tijmenheid</a>
</div>
</div>
<a name="68814"></a>
<div class="comment" id="comment-68814">
<div class="comment-score" id="post-68814-score">2</div>
<div class="comment-text"><p>I suggest you look at the language guide and the query examples linked to on the Overpass API page I quoted above. There you find examples of how to count and filter. If you still have issues post the query you are starting with here and someone can give you specific help (too advanced for myself).</p></div>
<div class="comment-info" id="comment-68814-info">
<span class="comment-age">(16 Apr '19, 13:58)</span>
<a class="comment-user userinfo" href="/users/10133/tzorn">TZorn</a>
</div>
</div>
<a name="68825"></a>
<div class="comment" id="comment-68825">
<div class="comment-score" id="post-68825-score"></div>
<div class="comment-text"><p>Thanks for the suggestion TZorn, will take another look, maybe I'll find something to fix it with.</p></div>
<div class="comment-info" id="comment-68825-info">
<span class="comment-age">(17 Apr '19, 14:21)</span>
<a class="comment-user userinfo" href="/users/16106/tijmenheid">tijmenheid</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-68801">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-68801-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/68797/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="hG8AVqIIKgENseSok2ZNpeOER9ndz6N6"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>