<meta charset="UTF-8"><link rel="stylesheet" type="text/css" href="../style.css"><div id="CALeft">
<div class="headNormal">
<h1><a href="/questions/52724/serving-tiles-with-style-in-4326">Serving Tiles (with style) in 4326</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/52724/up/" id="post-52724-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-52724-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/52724/down/" id="post-52724-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/52724/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>Is it possible to serve files in SRS 4326? I am following the directions for deploying my own server, and in the section for OSM Bright I see a snippet regarding WGS84 (what I think is 4326), but that's all I see.</p>
<p>I am able to get my tiles to display, but there's ZERO style overlayed on them. All I see is the planet without any cities, roads, etc. </p>
<p>Am I on the wrong track?</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-wgs84" href="/tags/wgs84/" rel="tag" title="see questions tagged 'wgs84'">wgs84</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>28 Oct '16, 14:27</strong>
</p>
<img alt="ismail44's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/fbe7fec63244565a6dc744a1b1f48e99?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/12920/ismail44">ismail44</a><br/>
<span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">●</span><span class="badgecount">2</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="ismail44 has no accepted answers">0%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-52724">
<a name="52725"></a>
<div class="comment" id="comment-52725">
<div class="comment-score" id="post-52725-score"></div>
<div class="comment-text"><p>I don't think so, but it depends what track you're following.  Can you tell us what you have done so far? 
Lot of guidance you'll find is dedicated to give you a map in Mercator,  so it can be a good idea to have a small extract of OSM rendered in this projection then adapt the database and style for 4326.</p></div>
<div class="comment-info" id="comment-52725-info">
<span class="comment-age">(29 Oct '16, 08:06)</span>
<a class="comment-user userinfo" href="/users/5587/yvecai">yvecai</a>
</div>
</div>
<a name="52729"></a>
<div class="comment" id="comment-52729">
<div class="comment-score" id="post-52729-score"></div>
<div class="comment-text"><p>I have followed the instructions for installing openstreet on ubuntu 14.04 from scratch to the letter. The only difference is that I am importing the planet with the "-l" switch in the osm2pgsql command.</p></div>
<div class="comment-info" id="comment-52729-info">
<span class="comment-age">(29 Oct '16, 14:25)</span>
<a class="comment-user userinfo" href="/users/12920/ismail44">ismail44</a>
</div>
</div>
<a name="52733"></a>
<div class="comment" id="comment-52733">
<div class="comment-score" id="post-52733-score"></div>
<div class="comment-text"><p>Are you sure your style file works in 4326?</p></div>
<div class="comment-info" id="comment-52733-info">
<span class="comment-age">(29 Oct '16, 21:11)</span>
<a class="comment-user userinfo" href="/users/5587/yvecai">yvecai</a>
</div>
</div>
<a name="52734"></a>
<div class="comment" id="comment-52734">
<div class="comment-score" id="post-52734-score"></div>
<div class="comment-text"><p>That's what I think is wrong... my styles aren't showing up?</p></div>
<div class="comment-info" id="comment-52734-info">
<span class="comment-age">(30 Oct '16, 01:36)</span>
<a class="comment-user userinfo" href="/users/12920/ismail44">ismail44</a>
</div>
</div>
<a name="52735"></a>
<div class="comment" id="comment-52735">
<div class="comment-score" id="post-52735-score"></div>
<div class="comment-text"><p>Before correcting your style,  maybe try to render a map in Mercator if not already done.</p></div>
<div class="comment-info" id="comment-52735-info">
<span class="comment-age">(30 Oct '16, 06:26)</span>
<a class="comment-user userinfo" href="/users/5587/yvecai">yvecai</a>
</div>
</div>
<a name="52762"></a>
<div class="comment not_top_scorer" id="comment-52762">
<div class="comment-score" id="post-52762-score"></div>
<div class="comment-text"><p>So... serving the tiles in spherical mercator worked just fine... I guess the trick now is going to be to find out how to serve them in lat/lon mercator... which, I would expect that I just need to find the correct .shp files for OSMBright in the correct mercator???</p></div>
<div class="comment-info" id="comment-52762-info">
<span class="comment-age">(31 Oct '16, 14:35)</span>
<a class="comment-user userinfo" href="/users/12920/ismail44">ismail44</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-52724">
<span class="comments-showing">
            showing 5 of 6
        </span>
<a class="show-all-comments-link" href="#">show 1 more comments</a>
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-52724-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    One Answer:
                    </div>
<div class="tabsA"><a href="/questions/52724/serving-tiles-with-style-in-4326?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/52724/serving-tiles-with-style-in-4326?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/52724/serving-tiles-with-style-in-4326?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/52724/serving-tiles-with-style-in-4326?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="52769"></a>
<div class="answer" id="answer-container-52769">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/52769/up/" id="post-52769-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-52769-score" title="current number of votes">
    3
</div>
<a class="ajax-command post-vote down" href="/vote/52769/down/" id="post-52769-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>The style has a list of layers - usually in an .mml or .yml file - and each layer has projection information to go with it. Since OSMBright is made for a database imported in Mercator units, and yours is in latitude and longitude, nothing will work - in effect, your data for the whole world will crouch somewhere near "null island" in the sea off Africa.</p>
<p>But all is not lost, you just need to inform your style that the data source is in EPSG:4326 instead of Mercator, then things will work again as expected. Look for layers configured to access the database with something like</p>
<pre><code>"srs": "+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=<a href="http://help.openstreetmap.org/users/2957/nullpointer">@null</a> +wktext +no_defs +over"
</code></pre>
<p>and change that to</p>
<pre><code>"srs" : "+init=epsg:4326"
</code></pre>
<p>BUT:</p>
<p>This whole exercise is only half of what you want. It is good that the style now knows your data source is in EPSG:4326 but you will also want to request tiles in that projection. It is no problem to use a command line tool like nik2img.py to create images in EPSG:4326 but all the standard tile generating programs like renderd etc. are geared towards the EPSG:3857 tiling scheme (where the world is quadratic). You'll have a hard time setting these standard utilities up to support non-mercator tiles because the assumption that standard mercator tiles are used is hardcoded in many places.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/52769/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>31 Oct '16, 22:47</strong>
</p>
<img alt="Frederik%20Ramm's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/a2b38d937e70ab39d895d17da0dd1ba4?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/104/frederik-ramm">Frederik Ramm ♦</a><br/>
<span class="score" title="82494 reputation points"><span class="">82.5k</span></span><span title="92 badges"><span class="badge1">●</span><span class="badgecount">92</span></span><span title="720 badges"><span class="silver">●</span><span class="badgecount">720</span></span><span title="1273 badges"><span class="bronze">●</span><span class="badgecount">1273</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Frederik Ramm has 417 accepted answers">23%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-52769">
<a name="52770"></a>
<div class="comment" id="comment-52770">
<div class="comment-score" id="post-52770-score"></div>
<div class="comment-text"><p><a href="http://help.openstreetmap.org/users/104/frederik-ramm">@frederik</a>, thanks for a very insightful comment. I am getting my tiles from osm in .pbf format and using osm2pgsql to import them. If I pass in the "-l" option, would that take care of my tile generation problem (Assuming, of course, that I fix the style's mercation)?</p></div>
<div class="comment-info" id="comment-52770-info">
<span class="comment-age">(31 Oct '16, 23:41)</span>
<a class="comment-user userinfo" href="/users/12920/ismail44">ismail44</a>
</div>
</div>
<a name="52806"></a>
<div class="comment" id="comment-52806">
<div class="comment-score" id="post-52806-score"></div>
<div class="comment-text"><p>The maps that you can produce are (unless we're talking north and south of 85°) the <em>same</em>, wether you import without <code>-l</code> and use the unmodified style, or import with <code>-l</code> and correct for that in the style. The thing you want to do differently is the actual production of the tiles. The problem with that is that the "Google Mercator" tiling scheme is standardised and well documented - if you give me the coordinates of a tile I can tell you exactly what's going to be on that tile. But to my knowledge an EPSG:4326 tile scheme is not standardised. It begins with the world tile at zoom 0 - in Google Mercator this is obvious, it's one single quadratic tile. But in EPSG:4326 the world is a rectangle twice as wide as it is high. Does that mean we have two tiles on z0? Or one tile where the bottom half is empty? Or the top half? Or 64 pixels unused above the world image and 64 pixels below? When a certain tile is requested, the rendering engine needs to know which bounding box to render the tile for, and this will be hard-wired to EPSG:3857 in most setups.</p></div>
<div class="comment-info" id="comment-52806-info">
<span class="comment-age">(02 Nov '16, 23:37)</span>
<a class="comment-user userinfo" href="/users/104/frederik-ramm">Frederik Ramm ♦</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-52769">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-52769-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/52724/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="8BS0EAOMGtNu86OMvvNvP5433mfi0n9U"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>