<meta charset="UTF-8"><link rel="stylesheet" type="text/css" href="../style.css"><div id="CALeft">
<div class="headNormal">
<h1><a href="/questions/52889/problem-with-my-josm-custom-presets">Problem with my JOSM custom presets</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/52889/up/" id="post-52889-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-52889-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/52889/down/" id="post-52889-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/52889/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
   1
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>I have a strange problem with several of my custom presets that I've tried to fix many times without success. Below is my XML preset for tagging certain waterway features. When I invoke it on a new untagged river or stream way, the section to tag source:name (a multiselect key) is always grayed out. However, if the way is already tagged with waterway=stream or waterway=river, that section behaves as it should and I can select one of the values from the source:name multiselect and apply the tags. Furthermore, the default note "Actual direction of flow unknown." only appears in the first scenario. If there is an existing waterway tag as in the second situation, it does not appear. </p>
<p>The identical behavior is observed in the second item, Lakes/Ponds. If no tags exist on a closedway, the source:name section is grayed out. If a water=pond, or water=lake tag exists before the preset is invoked, everything works as it should.</p>
<p>Can someone lend a hand? Any help or suggestions will be most appreciated.</p>
<p>Dave</p>
<p><strong>(Note: I have replaced &lt; and &gt; with @ symbols to allow XML code to display herein. Also, all "_" get automatically removed when posting XML code)</strong></p>
<pre><code>@presets xmlns="http://josm.openstreetmap.de/tagging-preset-1.0"@

@group name="Waters" @

@item name="Waterways" type="way" icon="presets/river.png" @

@combo key="waterway" text="Type of waterway" values="river,stream,canal,drain,ditch" default="" /@

@check key="intermittent" text="Intermittent?" disable_off="true" /@

@text key="name" text="Name" default=""/@

@text key="name:th" text="Name:th" default=""/@

@text key="name:en" text="Name:en" default=""/@

@multiselect key="source" text="Source(s)" values="Bing;survey;Mapbox Satellite;USGS Topo;MSR Topo;GPS;AK GINA" default="Bing" delete_if_empty="true"/@

<a href="http://help.openstreetmap.org/users/2577/spacebat"><a href="http://help.openstreetmap.org/users/2577/spacebat"><a href="http://help.openstreetmap.org/users/2577/spacebat">@space</a></a></a>/@

@multiselect key="source:name" text="Source(s) of name" values="personal_knowledge;survey;USGS Topo;MSR Topo;physical sign on bridge" default="" delete_if_empty="true"/@

<a href="http://help.openstreetmap.org/users/2577/spacebat"><a href="http://help.openstreetmap.org/users/2577/spacebat"><a href="http://help.openstreetmap.org/users/2577/spacebat">@space</a></a></a>/@

@optional@

@text key="note" text="Note" default="Actual direction of flow unknown."/@

@text key="ref" text="Reference" default=""/@

@text key="wikipedia:en" text="Wikipedia" default=""/@

@/optional@

@/item@

@item name="Lakes/Ponds" icon="presets/water.png" type="node,closedway" @

<a href="http://help.openstreetmap.org/users/2495/keypocket"><a href="http://help.openstreetmap.org/users/2495/keypocket"><a href="http://help.openstreetmap.org/users/2495/keypocket">@key</a></a></a> key="natural" value="water" /@

@check key="salt" text="Salt Water" disable_off="true" /@

@combo key="water" text="Pond, Reservoir, Lake" values="pond,lake,reservoir,oxbow,lagoon" default="pond" values_searchable="true" /@

@text key="name" text="Name" default=""   /@

@text key="ele" text="Elevation" default=""   /@

@multiselect key="source" text="Source(s)" values="Bing;Mapbox Satellite;USGS Topo;MSR Topo;GPS;AK GINA" default="Bing" /@

@multiselect key="source:name" text="Source(s) of name" values="personal_knowledge;survey;USGS Topo;MSR Topo;physical sign" default=""  /@

@text key="note" text="Note" default=""   /@

@/item@

@item name="Riverbank" icon="presets/water.png" type="closedway" @

<a href="http://help.openstreetmap.org/users/2495/keypocket"><a href="http://help.openstreetmap.org/users/2495/keypocket"><a href="http://help.openstreetmap.org/users/2495/keypocket">@key</a></a></a> key="waterway" value="riverbank" /@

@multiselect key="source" text="Source(s)" values="Bing;Mapbox;USGS Topo;MSR Topo;GPS;AK GINA" default="Bing" /@

@text key="note" text="Note" default=""   /@

@/item@

@item name="Dam" type="way,node,closedway" @

<a href="http://help.openstreetmap.org/users/2495/keypocket"><a href="http://help.openstreetmap.org/users/2495/keypocket"><a href="http://help.openstreetmap.org/users/2495/keypocket">@key</a></a></a> key="waterway" value="dam" /@

@text key="name" text="Name" default=""   /@

@text key="name:th" text="Name:th" default=""/@

@text key="name:en" text="Name:en" default=""/@

@multiselect key="source" text="Source(s)" values="Bing;survey;Mapbox Satellite;USGS Topo;MSR Topo;GPS;AK GINA" default="Bing" delete_if_empty="true"/@

@multiselect key="source:name" text="Source(s) of name" values="personal_knowledge;survey;USGS Topo;MSR Topo;physical sign" default="" delete_if_empty="true" /@

<a href="http://help.openstreetmap.org/users/2577/spacebat"><a href="http://help.openstreetmap.org/users/2577/spacebat"><a href="http://help.openstreetmap.org/users/2577/spacebat">@space</a></a></a>/@

@text key="note" text="Note" default=""  /@

@/item@

@/group@

@/presets@
</code></pre>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-xml" href="/tags/xml/" rel="tag" title="see questions tagged 'xml'">xml</a>
<a class="post-tag tag-link-josm" href="/tags/josm/" rel="tag" title="see questions tagged 'josm'">josm</a>
<a class="post-tag tag-link-presets" href="/tags/presets/" rel="tag" title="see questions tagged 'presets'">presets</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>11 Nov '16, 01:10</strong>
</p>
<img alt="AlaskaDave's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/04dddf6f5ffde333747d385af3ce5829?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/5016/alaskadave">AlaskaDave</a><br/>
<span class="score" title="5415 reputation points"><span class="">5.4k</span></span><span title="76 badges"><span class="badge1">●</span><span class="badgecount">76</span></span><span title="107 badges"><span class="silver">●</span><span class="badgecount">107</span></span><span title="164 badges"><span class="bronze">●</span><span class="badgecount">164</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="AlaskaDave has 17 accepted answers">16%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/52889/">
                edited
                <strong>11 Nov '16, 09:09</strong>
</a>
</p>
<img alt="scai's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/52d3234f3be58156770e8a91d575bfbd?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/158/scai">scai ♦</a><br/>
<span class="score" title="33317 reputation points"><span class="">33.3k</span></span><span title="21 badges"><span class="badge1">●</span><span class="badgecount">21</span></span><span title="309 badges"><span class="silver">●</span><span class="badgecount">309</span></span><span title="459 badges"><span class="bronze">●</span><span class="badgecount">459</span></span></p>
</div>
</div>
<div class="comments-container" id="comments-container-52889">
</div>
<div class="comment-tools" id="comment-tools-52889">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-52889-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    2 Answers:
                    </div>
<div class="tabsA"><a href="/questions/52889/problem-with-my-josm-custom-presets?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/52889/problem-with-my-josm-custom-presets?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/52889/problem-with-my-josm-custom-presets?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/52889/problem-with-my-josm-custom-presets?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="52895"></a>
<div class="answer accepted-answer" id="answer-container-52895">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/52895/up/" id="post-52895-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-52895-score" title="current number of votes">
    1
</div>
<a class="ajax-command post-vote down" href="/vote/52895/down/" id="post-52895-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="accept-answer on" href="/accept_answer/52895/" rel="nofollow" title="AlaskaDave has selected this answer as the correct answer">
</a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>Hi <a href="http://help.openstreetmap.org/users/5016/alaskadave">@AlaskaDave</a>,<br/>
Looks like the default="" in the multiselect is causing the problem. I removed the default and source:name came up properly. By the way, as per the documentation (<a href="https://josm.openstreetmap.de/wiki/TaggingPresets">https://josm.openstreetmap.de/wiki/TaggingPresets</a>)  delete_if_empty attribute is deprecated. The modified entry looks like as follows:
<code>
&lt;multiselect key="source:name" text="Source(s) of name" values="personal_knowledge;survey;USGS Topo;MSR Topo;physical sign on bridge" /&gt;
</code></p>
<p>However, I could not figure out how to get the default value for optional attributes for nodes/ways with pre-existing tags. Could not find anything in the documentation. I would imagine that it is the normal behavior. If the tags are already present, one may not be required to put a default attribute which is optional.</p>
<p>Hope this helps.<br/>
Prime</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/52895/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>12 Nov '16, 07:28</strong>
</p>
<img alt="primej's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/94b5bf3dcc698b1a4051d49f3204996e?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/8383/primej">primej</a><br>
<span class="score" title="106 reputation points">106</span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="primej has 2 accepted answers">100%</span>
</br></br></p>
</div>
</div>
<div class="comments-container" id="comments-container-52895">
<a name="52896"></a>
<div class="comment" id="comment-52896">
<div class="comment-score" id="post-52896-score">1</div>
<div class="comment-text"><p>Many thanks. I tried removing the delete_if_empty parameters first and that seemed to do the trick. I did not know that it had been deprecated. My multiselect and combo statements work as expected now even with the default set to "Bing" or some other value. I also added the values_sort="false" parameter to my combo and multiselect directives because that behaviour, new to JOSM for the past several releases AFAIK, was annoying me.</p></div>
<div class="comment-info" id="comment-52896-info">
<span class="comment-age">(12 Nov '16, 12:08)</span>
<a class="comment-user userinfo" href="/users/5016/alaskadave">AlaskaDave</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-52895">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-52895-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<a name="52890"></a>
<div class="answer" id="answer-container-52890">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/52890/up/" id="post-52890-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-52890-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/52890/down/" id="post-52890-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>The main difference that I see with the preset that I maintain (BENELUX) is that I keep all combo and multiselects in the optional part. I do not notice the behaviour that you see.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/52890/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>11 Nov '16, 07:01</strong>
</p>
<img alt="escada's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/813a136afe7d4c95fd5bccdd78705e0e?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/5390/escada">escada</a><br/>
<span class="score" title="19043 reputation points"><span class="">19.0k</span></span><span title="16 badges"><span class="badge1">●</span><span class="badgecount">16</span></span><span title="166 badges"><span class="silver">●</span><span class="badgecount">166</span></span><span title="302 badges"><span class="bronze">●</span><span class="badgecount">302</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="escada has 97 accepted answers">21%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-52890">
<a name="52891"></a>
<div class="comment" id="comment-52891">
<div class="comment-score" id="post-52891-score"></div>
<div class="comment-text"><p>Thanks escada - That's not it. I moved those lines into the optional section and they still exhibit the same behavior.</p></div>
<div class="comment-info" id="comment-52891-info">
<span class="comment-age">(11 Nov '16, 08:09)</span>
<a class="comment-user userinfo" href="/users/5016/alaskadave">AlaskaDave</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-52890">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-52890-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/52889/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="rNP2ZQuZsQzN1WxkeJpTFBdD1FVxLjrd"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>