<meta charset="UTF-8"><link rel="stylesheet" type="text/css" href="../style.css"><div id="CALeft">
<div class="headNormal">
<h1><a href="/questions/4607/is-there-a-way-to-get-a-county-city-and-suburb-name-rendered-without-using-a-place-node">Is there a way to get a county, city and suburb name rendered without using a place=* node?</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/4607/up/" id="post-4607-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-4607-score" title="current number of votes">
    2
</div>
<a class="ajax-command post-vote down" href="/vote/4607/down/" id="post-4607-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/4607/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>Is there a way to map out and tag an entity such as county, city or suburb (or state, or village, etc., although I don't work with those as a matter of practice) <strong>as a polygon</strong> and have its name rendered in the same style and at the same zoom levels as it would be rendered if it were <strong>a node</strong> tagged as place=*? </p>
<p>Please note that I am <strong>not</strong> talking about the way the name of the <strong>area</strong> polygons is rendered, such as landuse=* or a building=* polygons. I am talking about the styles associated with the place=* hierarchy.</p>
<p>I am interested mostly in Mapnik, although if the answer is 'no' for Mapnik and 'yes' for another renderer, I would like to hear about that.</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-rendering" href="/tags/rendering/" rel="tag" title="see questions tagged 'rendering'">rendering</a>
<a class="post-tag tag-link-place" href="/tags/place/" rel="tag" title="see questions tagged 'place'">place</a>
<a class="post-tag tag-link-mapnik" href="/tags/mapnik/" rel="tag" title="see questions tagged 'mapnik'">mapnik</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>18 Apr '11, 19:45</strong>
</p>
<img alt="ponzu's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/c23c2891306229bb036de7ce63bb8c9b?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/831/ponzu">ponzu</a><br/>
<span class="score" title="2104 reputation points"><span class="">2.1k</span></span><span title="49 badges"><span class="badge1">●</span><span class="badgecount">49</span></span><span title="64 badges"><span class="silver">●</span><span class="badgecount">64</span></span><span title="83 badges"><span class="bronze">●</span><span class="badgecount">83</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="ponzu has no accepted answers">0%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/4607/">
                edited
                <strong>19 Apr '11, 19:52</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-4607">
<a name="4636"></a>
<div class="comment" id="comment-4636">
<div class="comment-score" id="post-4636-score"></div>
<div class="comment-text"><p>You might be confusing something when you say you do not want it in the way landuse or buildings behave, because actually it is the exact same way. The font and zoomlevel when the label appears depends on the style sheet. As Andy said: if you use the same styles as there already are for place nodes, the labels will look the same.</p></div>
<div class="comment-info" id="comment-4636-info">
<span class="comment-age">(19 Apr '11, 09:44)</span>
<a class="comment-user userinfo" href="/users/936/dieterdreist">dieterdreist</a>
</div>
</div>
<a name="4651"></a>
<div class="comment" id="comment-4651">
<div class="comment-score" id="post-4651-score"></div>
<div class="comment-text"><p>I don't think I am too confused. The names of place nodes appear at earlier zooms and have different fonts for different ranks. If I were to convert a place polygon to a multipolygon, as someone suggested elsewhere, then its name would get rendered in the center, but it would be rendered according the same rules as area polygons currently do. I did not want anyone suggesting this again.</p>
<p>I understand about the stylesheets, will query Andy about them more. The question was can I tag for the existing stylesheet to get the desirable result.</p></div>
<div class="comment-info" id="comment-4651-info">
<span class="comment-age">(19 Apr '11, 19:55)</span>
<a class="comment-user userinfo" href="/users/831/ponzu">ponzu</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-4607">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-4607-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    3 Answers:
                    </div>
<div class="tabsA"><a href="/questions/4607/is-there-a-way-to-get-a-county-city-and-suburb-name-rendered-without-using-a-place-node?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/4607/is-there-a-way-to-get-a-county-city-and-suburb-name-rendered-without-using-a-place-node?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/4607/is-there-a-way-to-get-a-county-city-and-suburb-name-rendered-without-using-a-place-node?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/4607/is-there-a-way-to-get-a-county-city-and-suburb-name-rendered-without-using-a-place-node?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="4632"></a>
<div class="answer" id="answer-container-4632">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/4632/up/" id="post-4632-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-4632-score" title="current number of votes">
    2
</div>
<a class="ajax-command post-vote down" href="/vote/4632/down/" id="post-4632-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>Yes, this is easy to achieve with a customised stylesheet in mapnik. </p>
<p>First, ensure the object is a candidate for the polygons table (in this case key "place" is already marked as such in the osm2pgsql default.style). Then you can add a layer definition to your mapnik style referring to the polygons table instead of the nodes table, but otherwise the same as the existing layer showing places. </p>
<p>If you use the same style rules for both the point- and polygon- layers then the text will show up in the same size and zoom levels, regardless of whether it's using the point or polygon table. And mapnik lets you use the same &lt;stylename&gt; declaration in multiple layers, so you don't need to make duplicate of the style rules.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/4632/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>19 Apr '11, 08:58</strong>
</p>
<img alt="Andy%20Allan's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/c3743b1b368f5e209eb8aad30164acc4?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/3/andy-allan">Andy Allan</a><br/>
<span class="score" title="12456 reputation points"><span class="">12.5k</span></span><span title="23 badges"><span class="badge1">●</span><span class="badgecount">23</span></span><span title="128 badges"><span class="silver">●</span><span class="badgecount">128</span></span><span title="153 badges"><span class="bronze">●</span><span class="badgecount">153</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Andy Allan has 46 accepted answers">28%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-4632">
<a name="4652"></a>
<div class="comment" id="comment-4652">
<div class="comment-score" id="post-4652-score"></div>
<div class="comment-text"><p>Well, I have now heard two versions of the answer: "It is easy" and "People have been bugging Mapnik about this for a long time". If it's easy, why hasn't it been implemented? Do you think anyone would mind if this became the standard behavior? We would not need place nodes anymore in addition to place polygons. The advice I received elsewhere was to delete the  node once a polygon for the same entity is available. That advice either did not take labeling into consideration or did not apply to places at all (it could have been about parks and such).</p></div>
<div class="comment-info" id="comment-4652-info">
<span class="comment-age">(19 Apr '11, 19:58)</span>
<a class="comment-user userinfo" href="/users/831/ponzu">ponzu</a>
</div>
</div>
<a name="4653"></a>
<div class="comment" id="comment-4653">
<div class="comment-score" id="post-4653-score"></div>
<div class="comment-text"><p>Also, could you please elaborate or point me to the discussion explaining how me customizing a Mapnik stylesheet can help affect what the map looks like in <a href="http://osm.org">osm.org</a>? I am not talking about producing a custom map, but about either tweaking my tagging in case it's what's preventing the current "official" Mapnik from rendering the names, or tweaking the "official" Mapniik. I am sorry if I did not make myself clear.</p></div>
<div class="comment-info" id="comment-4653-info">
<span class="comment-age">(19 Apr '11, 20:02)</span>
<a class="comment-user userinfo" href="/users/831/ponzu">ponzu</a>
</div>
</div>
<a name="4673"></a>
<div class="comment" id="comment-4673">
<div class="comment-score" id="post-4673-score">1</div>
<div class="comment-text"><p>The reason it isn't being done in mapnik today is because I only recently switched place to be a polygon candidate in osm2pgsql's default.style file. Once we've had a full rendering database reload on <a href="http://osm.org">osm.org</a>, we can start showing place=* polygons as well.</p></div>
<div class="comment-info" id="comment-4673-info">
<span class="comment-age">(20 Apr '11, 21:35)</span>
<a class="comment-user userinfo" href="/users/1224/lennard">Lennard</a>
</div>
</div>
<a name="4682"></a>
<div class="comment" id="comment-4682">
<div class="comment-score" id="post-4682-score"></div>
<div class="comment-text"><p>Excellent news. Follow-up questions: 1)Will the names be rendered in accordance with the place=* styles or same as any polygon? (Hint: I am hoping for the former). 2)Will it work on multipolygons as well as closed ways? 3)Does/will Mapnik support boundary relations? Specifically, will Mapnik respect the "label" role and generate the label where that node points, and will these relations need a place=* tag to get their labels rendered properly, or will Mapnik go on admin_level? If there are existing threads on this subject, please point me to them (Trac, forum, lists, IRC, wiki, etc.)</p></div>
<div class="comment-info" id="comment-4682-info">
<span class="comment-age">(20 Apr '11, 22:33)</span>
<a class="comment-user userinfo" href="/users/831/ponzu">ponzu</a>
</div>
</div>
<a name="4713"></a>
<div class="comment" id="comment-4713">
<div class="comment-score" id="post-4713-score">1</div>
<div class="comment-text"><p>1) The plan is to have them in the same style as place=* nodes.</p>
<p>2) They're the same as far as the rendering database is concerned.</p>
<p>3) Support for this would need to come from osm2pgsql in the first place. I'm not a huge fan of the label=* role, and that's an understatement.</p>
<p>Support for place areas is distinctly different from boundary relations and admin_level. So yes, you'd need a place tag on the closed way or multipolygon relation.</p>
<p><a href="http://trac.openstreetmap.org/ticket/3110">http://trac.openstreetmap.org/ticket/3110</a> is an example from trac</p></div>
<div class="comment-info" id="comment-4713-info">
<span class="comment-age">(21 Apr '11, 20:52)</span>
<a class="comment-user userinfo" href="/users/1224/lennard">Lennard</a>
</div>
</div>
<a name="4716"></a>
<div class="comment not_top_scorer" id="comment-4716">
<div class="comment-score" id="post-4716-score"></div>
<div class="comment-text"><p>Let's be clear that I am talking about a role=label member of a boundary/multipolgon relation, and not the type=role relation, which is a competing proposal, allegedly honored by Osmarender, which I personally have no experience using and have no interest in. The Trac ticket you linked talks about the role relation, not role member. And when you reference label=* role, this makes me think of the label key applicable, for example, on manhole covers: <a href="http://wiki.openstreetmap.org/wiki/Key:label">http://wiki.openstreetmap.org/wiki/Key:label</a></p></div>
<div class="comment-info" id="comment-4716-info">
<span class="comment-age">(21 Apr '11, 21:59)</span>
<a class="comment-user userinfo" href="/users/831/ponzu">ponzu</a>
</div>
</div>
<a name="4718"></a>
<div class="comment not_top_scorer" id="comment-4718">
<div class="comment-score" id="post-4718-score"></div>
<div class="comment-text"><p>I think that if Mapnik starts rendering the name of a closed way polygon and multipolygon (including boundary relation as a subclass of a multipolygon) in accordance with the style associated with the place=* tag on the (multi)polygon and in the centroid of the polygon, most people should be happy. I personally would not care much if the label role is supported or not. I thought this role was necessary to cause the label the render. But since it has nothing to do with that, I personally lost interest in it. The use cases for this role are pretty specific and rare.</p></div>
<div class="comment-info" id="comment-4718-info">
<span class="comment-age">(21 Apr '11, 22:05)</span>
<a class="comment-user userinfo" href="/users/831/ponzu">ponzu</a>
</div>
</div>
<a name="4750"></a>
<div class="comment not_top_scorer" id="comment-4750">
<div class="comment-score" id="post-4750-score"></div>
<div class="comment-text"><p>When will a "full rendering database reload on <a href="http://osm.org">osm.org</a>" happen? Does that only happen irregularly, or is it going to happen automatically sometime, or is that what happens all the time? I don't understand what it means. I tried to search the wiki for an explanation, but couldn't find anything.</p></div>
<div class="comment-info" id="comment-4750-info">
<span class="comment-age">(23 Apr '11, 14:09)</span>
<a class="comment-user userinfo" href="/users/1239/spod">spod</a>
</div>
</div>
<a name="4751"></a>
<div class="comment not_top_scorer" id="comment-4751">
<div class="comment-score" id="post-4751-score"></div>
<div class="comment-text"><p>To be able to render the default map on <a href="http://osm.org">osm.org</a>, we take the OSM database and process/import that into another database to suit the map renderer. This is what a "rendering database reload" means.</p>
<p>Usually, this rendering database is kept up to date by applying changes as they happen. This is the normal operating mode.</p>
<p>Every once in a while, the whole db is reloaded from scratch. This used to happen once a week when we had no minutely updates. Then once these updates matured, the full reload interval increased. The last one was done over a year ago. I'm expecting another one before the summer.</p></div>
<div class="comment-info" id="comment-4751-info">
<span class="comment-age">(23 Apr '11, 15:00)</span>
<a class="comment-user userinfo" href="/users/1224/lennard">Lennard</a>
</div>
</div>
<a name="4757"></a>
<div class="comment not_top_scorer" id="comment-4757">
<div class="comment-score" id="post-4757-score"></div>
<div class="comment-text"><p>Thanks for the info Lennard - is there a way of being informed of/finding out when the full database reload has happened, so I can check that my multipolygon labels are then being rendered correctly?</p></div>
<div class="comment-info" id="comment-4757-info">
<span class="comment-age">(24 Apr '11, 04:56)</span>
<a class="comment-user userinfo" href="/users/1239/spod">spod</a>
</div>
</div>
<a name="4806"></a>
<div class="comment not_top_scorer" id="comment-4806">
<div class="comment-score" id="post-4806-score"></div>
<div class="comment-text"><p><a href="/users/1224/lennard/"></a><a href="/users/1224/lennard/">@Lennard</a> Let me make sure I understand. You have already made the necessary change to start having place polygon labels rendered in the style consistent with place nodes, and the reason we are not seeing them is because the database has to be fully refreshed? What about a brand new place polygon? Will it get its label rendered? My testing says it does not, but maybe I was testing prior to your change?</p></div>
<div class="comment-info" id="comment-4806-info">
<span class="comment-age">(25 Apr '11, 19:14)</span>
<a class="comment-user userinfo" href="/users/831/ponzu">ponzu</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-4632">
<span class="comments-showing">
            showing 5 of 11
        </span>
<a class="show-all-comments-link" href="#">show 6 more comments</a>
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-4632-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<a name="4809"></a>
<div class="answer" id="answer-container-4809">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/4809/up/" id="post-4809-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-4809-score" title="current number of votes">
    1
</div>
<a class="ajax-command post-vote down" href="/vote/4809/down/" id="post-4809-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>The new instructions* to handle place as polygons will only be activated once a full reimport is being done.</p>
<p>*osm2pgsql's default.style file</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/4809/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>25 Apr '11, 19:29</strong>
</p>
<img alt="Lennard's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/90263d23dc3f15a98d14d91e889b9d25?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/1224/lennard">Lennard</a><br/>
<span class="score" title="91 reputation points">91</span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="5 badges"><span class="bronze">●</span><span class="badgecount">5</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Lennard has no accepted answers">0%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-4809">
</div>
<div class="comment-tools" id="comment-tools-4809">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-4809-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<a name="4902"></a>
<div class="answer" id="answer-container-4902">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/4902/up/" id="post-4902-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-4902-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/4902/down/" id="post-4902-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>You might want to consider creating a relation for the polygon with boundary=administrative (with the admin_level being appropriate for the type of place). You can make the place node a member of the relation. See the <a href="http://wiki.openstreetmap.org/wiki/Relation:boundary">http://wiki.openstreetmap.org/wiki/Relation:boundary</a> page for details.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/4902/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>29 Apr '11, 01:00</strong>
</p>
<img alt="Ebenezer's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/f075add936ab95d2d368f2e48f5ddc22?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/603/ebenezer">Ebenezer</a><br/>
<span class="score" title="948 reputation points">948</span><span title="2 badges"><span class="badge1">●</span><span class="badgecount">2</span></span><span title="11 badges"><span class="silver">●</span><span class="badgecount">11</span></span><span title="21 badges"><span class="bronze">●</span><span class="badgecount">21</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Ebenezer has 2 accepted answers">9%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-4902">
<a name="4909"></a>
<div class="comment" id="comment-4909">
<div class="comment-score" id="post-4909-score"></div>
<div class="comment-text"><p>That doesn't do anything. The name of the place will be rendered in the place-appropriate style, but it will be due to the existence of the place node, not it's inclusion in the relation. I confirm that the name of a relation-based polygon (I.e., multipolygon or boundary) does get rendered currently in the centroid, but its style does not follow the place=* styles.</p></div>
<div class="comment-info" id="comment-4909-info">
<span class="comment-age">(29 Apr '11, 22:03)</span>
<a class="comment-user userinfo" href="/users/831/ponzu">ponzu</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-4902">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-4902-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/4607/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="8jIwhkeLxeKLGC7EVeFjJMGkd9jY7LBs"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>