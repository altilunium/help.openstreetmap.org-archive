<meta charset="utf-8"/><link href="../style.css" rel="stylesheet" type="text/css"/><div id="CALeft"><center><a href="../"><img id="ll" src="https://help.openstreetmap.org/upfiles/osm_help_logo_6.png"/></a></center>
<div class="headNormal">
<h1><a href="/questions/80016/404-not-rendering-after-some-time-running-fine">404 not rendering after some time running fine</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/80016/up/" id="post-80016-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-80016-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/80016/down/" id="post-80016-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/80016/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>I've been using open street maps for a while on our own server. The installation guides have been very easy to follow and generally the system has been working really well. We recently (~2-3 months ago) upgraded with a fresh install to update our maps and update the server to Ubuntu 20.04 using instructions here:</p>
<p><a href="https://switch2osm.org/serving-tiles/manually-building-a-tile-server-20-04-lts/">https://switch2osm.org/serving-tiles/manually-building-a-tile-server-20-04-lts/</a></p>
<p>As usual the installation was easy and the system was up and running importing data (dedicated Ec2 instance). 
After the import the system seemed to be working well. </p>
<p>However about every 6-12 hours we find that something in the system causes the tile rendering to start to fail, resulting in 404's on the calls to the tiles that haven't been rendered before. </p>
<p>The previous version we were running (about 18-24 months old) had this issue occasionally, we found by restarting the process roughly daily, the problem was never an issue. 
However in this latest installation, the restart of apache and rendered doesn't recover the process of tile rendering.  </p>
<p>In the logs I can see lines like this</p>
<pre><code>May  5 22:35:21 renderd[39527]: DEBUG: Connection 1, fd 37 closed, now 2 left
May  5 22:35:21 DEBUG: Got incoming request with protocol version 2
May  5 22:34:26 renderd[39527]: DEBUG: Got command Dirty fd(36) xml(ajt), z(18), x(241694), y(151967), mime(image/png), options()
May  5 22:34:26 renderd[39527]: DEBUG: Sending NotDone response(4)
</code></pre>
<p>I haven't had much luck finding logs that provide a clear error. 
The only thing that seems to help is to restart the whole server, after which it redneres fine for another 6-12 hours before failing again.</p>
<p>So 2 questions: </p>
<ul>
<li>How can I find logs that indicate what's wrong to try and resolve this issue? </li>
<li>How should I 'restart' the render process to ensure it starts working again (restarting the whole server should be unnecessary)</li>
</ul>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-rendering" href="/tags/rendering/" rel="tag" title="see questions tagged 'rendering'">rendering</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>06 May '21, 00:01</strong>
</p>
<img alt="Brian%20WM's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/143bcc0d47dc0d07f9abb1333f8011fc?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/20175/brian-wm">Brian WM</a><br/>
<span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">●</span><span class="badgecount">2</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Brian WM has no accepted answers">0%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-80016">
</div>
<div class="comment-tools" id="comment-tools-80016">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-80016-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<form action="/questions/80016/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="534fU6gYImJCFpkUhwrZcKjKv42Jkd6k"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>