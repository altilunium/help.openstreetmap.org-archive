<meta charset="UTF-8"><link rel="stylesheet" type="text/css" href="../style.css"><div id="CALeft">
<div class="headNormal">
<h1><a href="/questions/6167/rearranging-xml-to-excel-data-have-a-column-show-up-twice">Rearranging XML to Excel data - have a column show up twice</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/6167/up/" id="post-6167-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-6167-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/6167/down/" id="post-6167-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/6167/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>Hi there.</p>
<p>I would like to rearrange xml files in excel in the following format:</p>
<p>lat | long | k | v | v</p>
<p>If you are familiar with the xml schema I cant repeat column v twice. Essentially what I want to do is make an excel file for all restaurants with lat, long, name and cuisine.</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-xml" href="/tags/xml/" rel="tag" title="see questions tagged 'xml'">xml</a>
<a class="post-tag tag-link-csv" href="/tags/csv/" rel="tag" title="see questions tagged 'csv'">csv</a>
<a class="post-tag tag-link-export" href="/tags/export/" rel="tag" title="see questions tagged 'export'">export</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>04 Jul '11, 10:59</strong>
</p>
<img alt="bulleh's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/5c8b9c96fdc4d80e3e198f3268a159f8?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/1673/bulleh">bulleh</a><br/>
<span class="score" title="14 reputation points">14</span><span title="2 badges"><span class="badge1">●</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">●</span><span class="badgecount">2</span></span><span title="2 badges"><span class="bronze">●</span><span class="badgecount">2</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="bulleh has no accepted answers">0%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/6167/">
                edited
                <strong>04 Jul '11, 15:32</strong>
</a>
</p>
<img alt="emacsen's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/5f2082b86cc50d63c05f33f55166df2d?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/540/emacsen">emacsen</a><br/>
<span class="score" title="1191 reputation points"><span class="">1.2k</span></span><span title="16 badges"><span class="silver">●</span><span class="badgecount">16</span></span><span title="23 badges"><span class="bronze">●</span><span class="badgecount">23</span></span></p>
</div>
</div>
<div class="comments-container" id="comments-container-6167">
</div>
<div class="comment-tools" id="comment-tools-6167">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-6167-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    3 Answers:
                    </div>
<div class="tabsA"><a href="/questions/6167/rearranging-xml-to-excel-data-have-a-column-show-up-twice?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/6167/rearranging-xml-to-excel-data-have-a-column-show-up-twice?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/6167/rearranging-xml-to-excel-data-have-a-column-show-up-twice?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/6167/rearranging-xml-to-excel-data-have-a-column-show-up-twice?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="6169"></a>
<div class="answer" id="answer-container-6169">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/6169/up/" id="post-6169-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-6169-score" title="current number of votes">
    2
</div>
<a class="ajax-command post-vote down" href="/vote/6169/down/" id="post-6169-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>The Ruby library <strong><a href="http://osmlib.rubyforge.org">OSMlib</a></strong> allows <a href="http://osmlib.rubyforge.org/osmlib-export/rdoc/files/doc/format-csv.html">export into CSV</a>.</p>
<p>The example in the documentation pointed to above has a hospital example that mirrors your restaurant example. </p>
<p>One thing to be aware of, as it sounds like you're looking to extract the data out of OSM, is that the license persists, and your new dataset in CSV form is still under the CC-BY-SA license (until OSM completes the license transition).</p>
<p>So if you distribute this file, it must be under the terms of the CC-BY-SA. If you make a new map, it's a derived work, and if you combine this data with other data, it's a derived work. You should read the various license pages on the OSM Wiki for more information about this, in particular the page on <a href="http://wiki.openstreetmap.org/wiki/Common_licence_interpretations">Common license interpretations</a> may help.</p>
<p>OSM's a great resource for POI data. Good luck with your project!</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/6169/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>04 Jul '11, 13:57</strong>
</p>
<img alt="emacsen's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/5f2082b86cc50d63c05f33f55166df2d?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/540/emacsen">emacsen</a><br/>
<span class="score" title="1191 reputation points"><span class="">1.2k</span></span><span title="16 badges"><span class="silver">●</span><span class="badgecount">16</span></span><span title="23 badges"><span class="bronze">●</span><span class="badgecount">23</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="emacsen has 4 accepted answers">13%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/6169/">
                edited
                <strong>04 Jul '11, 15:53</strong>
</a>
</p>
<img alt="Richard's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/08324717c25d6067fa4ff23ef37d455f?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/5/richard">Richard ♦</a><br/>
<span class="score" title="30902 reputation points"><span class="">30.9k</span></span><span title="44 badges"><span class="badge1">●</span><span class="badgecount">44</span></span><span title="279 badges"><span class="silver">●</span><span class="badgecount">279</span></span><span title="412 badges"><span class="bronze">●</span><span class="badgecount">412</span></span></p>
</div>
</div>
<div class="comments-container" id="comments-container-6169">
</div>
<div class="comment-tools" id="comment-tools-6169">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-6169-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<a name="6170"></a>
<div class="answer" id="answer-container-6170">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/6170/up/" id="post-6170-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-6170-score" title="current number of votes">
    2
</div>
<a class="ajax-command post-vote down" href="/vote/6170/down/" id="post-6170-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>Not that it's really anything to do with OSM, but the Excel data import wizard will import one row per tag combination.  You can tell which tags are for the same item by looking at the "id" column.</p>
<p>How to rearrange the data in Excel is a question best asked somewhere like <a href="http://social.technet.microsoft.com/Forums/en/excel/threads">here</a>.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/6170/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>04 Jul '11, 13:58</strong>
</p>
<img alt="SomeoneElse's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/0bf1aa22f7f5e045b0eb8beb79fe7907?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/387/someoneelse">SomeoneElse ♦</a><br/>
<span class="score" title="36866 reputation points"><span class="">36.9k</span></span><span title="71 badges"><span class="badge1">●</span><span class="badgecount">71</span></span><span title="370 badges"><span class="silver">●</span><span class="badgecount">370</span></span><span title="866 badges"><span class="bronze">●</span><span class="badgecount">866</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="SomeoneElse has 228 accepted answers">16%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-6170">
</div>
<div class="comment-tools" id="comment-tools-6170">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-6170-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<a name="16247"></a>
<div class="answer" id="answer-container-16247">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/16247/up/" id="post-16247-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-16247-score" title="current number of votes">
    2
</div>
<a class="ajax-command post-vote down" href="/vote/16247/down/" id="post-16247-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>Meanwhile the newly introduced <tt>--csv</tt> option of <a href="https://wiki.openstreetmap.org/wiki/Osmconvert#Writing_CSV_Files">osmconvert</a> will help you to create CSV files rather easily. For example:</p>
<pre><code>./osmconvert shops.osm --all-to-nodes --csv="<a href="/users/260/idoneus"><a href="/users/260/idoneus">@id</a></a> <a href="/users/1350/longestaugust"><a href="/users/1350/longestaugust">@lon</a></a> @lat amenity shop name" --csv-headline
<a href="/users/260/idoneus"><a href="/users/260/idoneus">@id</a></a>               <a href="/users/1350/longestaugust"><a href="/users/1350/longestaugust">@lon</a></a>        @lat        amenity  shop       name
21548298          11.6122123  48.6884848  shop     bakery     Miller
21552613          9.0651970   49.9979332  shop     butcher    Jaeger
1000000168276611  6.6058085   51.4556093  shop     drugstore  AllForYou
</code></pre>
<p>To filter all restaurants out of an OSM file you may use <a href="https://wiki.openstreetmap.org/wiki/Osmfilter">osmfilter</a>.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/16247/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>19 Sep '12, 00:11</strong>
</p>
<img alt="Marqqs's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/3b5b4abfedd46928c7cd0d5cbf907ed3?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/4540/marqqs">Marqqs</a><br/>
<span class="score" title="448 reputation points">448</span><span title="5 badges"><span class="silver">●</span><span class="badgecount">5</span></span><span title="10 badges"><span class="bronze">●</span><span class="badgecount">10</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Marqqs has 2 accepted answers">22%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-16247">
</div>
<div class="comment-tools" id="comment-tools-16247">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-16247-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/6167/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="RzX6yLE49iDZA0Llzh04xYSSWq0IKgcu"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>