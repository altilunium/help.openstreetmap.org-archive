<meta charset="UTF-8"><link rel="stylesheet" type="text/css" href="../style.css"><div id="CALeft">
<div class="headNormal">
<h1><a href="/questions/68268/re-apply-daily-diff-with-osm2pgsql">Re-apply daily diff with osm2pgsql</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/68268/up/" id="post-68268-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-68268-score" title="current number of votes">
    1
</div>
<a class="ajax-command post-vote down" href="/vote/68268/down/" id="post-68268-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/68268/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>Hi all</p>
<p>I have imported the Europe dataset in PostgreSQL with osm2pgsql, and I apply daily updates with a routine every night.
Looking at the logs I keep, I believe one of the daily updates was not correctly applied.
I was thinking about simply re-playing those updates (edit : all the daily updates since the failure, of course). Would this work ?
From what I understand of the way osm2pgsql works it basically does inserts and deletes, so I'd say this could work, but I'd rather be sure.</p>
<p>Thanks for your help on this !</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-osm2pgsql" href="/tags/osm2pgsql/" rel="tag" title="see questions tagged 'osm2pgsql'">osm2pgsql</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>05 Mar '19, 07:55</strong>
</p>
<img alt="codata_al's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/6b4f06fde4e48d946ba27ad93d11187e?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/16365/codata_al">codata_al</a><br/>
<span class="score" title="31 reputation points">31</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="codata_al has no accepted answers">0%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/68268/">
                edited
                <strong>05 Mar '19, 08:38</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-68268">
</div>
<div class="comment-tools" id="comment-tools-68268">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-68268-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    2 Answers:
                    </div>
<div class="tabsA"><a href="/questions/68268/re-apply-daily-diff-with-osm2pgsql?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/68268/re-apply-daily-diff-with-osm2pgsql?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/68268/re-apply-daily-diff-with-osm2pgsql?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/68268/re-apply-daily-diff-with-osm2pgsql?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="68270"></a>
<div class="answer accepted-answer" id="answer-container-68270">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/68270/up/" id="post-68270-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-68270-score" title="current number of votes">
    3
</div>
<a class="ajax-command post-vote down" href="/vote/68270/down/" id="post-68270-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="accept-answer on" href="/accept_answer/68270/" rel="nofollow" title="codata_al has selected this answer as the correct answer">
</a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>osm2pgsql's update process is safe to replay. That means you can repeat updates provided you reapply all updates from the date that the update process failed and you apply them in the correct order. The database is only back to a consistent state when all updates have been processed.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/68270/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>05 Mar '19, 11:44</strong>
</p>
<img alt="lonvia's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/d888b712d85dee0aa304297f2dc697c7?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/2921/lonvia">lonvia</a><br/>
<span class="score" title="6213 reputation points"><span class="">6.2k</span></span><span title="2 badges"><span class="badge1">●</span><span class="badgecount">2</span></span><span title="57 badges"><span class="silver">●</span><span class="badgecount">57</span></span><span title="89 badges"><span class="bronze">●</span><span class="badgecount">89</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="lonvia has 43 accepted answers">40%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/68270/">
                edited
                <strong>05 Mar '19, 12:07</strong>
</a>
</p>
<img alt="SomeoneElse's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/0bf1aa22f7f5e045b0eb8beb79fe7907?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/387/someoneelse">SomeoneElse ♦</a><br/>
<span class="score" title="36866 reputation points"><span class="">36.9k</span></span><span title="71 badges"><span class="badge1">●</span><span class="badgecount">71</span></span><span title="370 badges"><span class="silver">●</span><span class="badgecount">370</span></span><span title="866 badges"><span class="bronze">●</span><span class="badgecount">866</span></span></p>
</div>
</div>
<div class="comments-container" id="comments-container-68270">
<a name="68271"></a>
<div class="comment" id="comment-68271">
<div class="comment-score" id="post-68271-score"></div>
<div class="comment-text"><p>That's excellent news Lonvia !</p>
<p>Thanks for your help !</p></div>
<div class="comment-info" id="comment-68271-info">
<span class="comment-age">(05 Mar '19, 12:07)</span>
<a class="comment-user userinfo" href="/users/16365/codata_al">codata_al</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-68270">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-68270-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<a name="69194"></a>
<div class="answer answered-by-owner" id="answer-container-69194">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/69194/up/" id="post-69194-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-69194-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/69194/down/" id="post-69194-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>Hi again !</p>
<p>Just to make sure I got this right : I've had ONE update failing (say, sequenceNumber = 2245 for instance), BUT the ones after that ran fine (2246 was applied, as well as 2247 and 2248).</p>
<p>It is fine to reapply all updates starting from 2245 (2245 to 2248), even though the updates from 2246 to 2248 had already been applied ?</p>
<p>Sorry for being so verbose, but I am not sure that my first message made it very clear that I had subsequent update successfully applied.</p>
<p>Thanks !</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/69194/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>15 May '19, 09:52</strong>
</p>
<img alt="codata_al's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/6b4f06fde4e48d946ba27ad93d11187e?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/16365/codata_al">codata_al</a><br/>
<span class="score" title="31 reputation points">31</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="codata_al has no accepted answers">0%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-69194">
<a name="69195"></a>
<div class="comment" id="comment-69195">
<div class="comment-score" id="post-69195-score">2</div>
<div class="comment-text"><p>Yes, that's what I meant with the answer above. If you want to reapply 2245, you <em>must</em> reapply 2246 to 2248 afterwards again. When all changes until 2248 are applied, your database is in a consistent state.</p></div>
<div class="comment-info" id="comment-69195-info">
<span class="comment-age">(15 May '19, 10:13)</span>
<a class="comment-user userinfo" href="/users/2921/lonvia">lonvia</a>
</div>
</div>
<a name="69196"></a>
<div class="comment" id="comment-69196">
<div class="comment-score" id="post-69196-score"></div>
<div class="comment-text"><p>Great, just wanted to be 100% sure.
Sorry for the noise, and thanks again !</p></div>
<div class="comment-info" id="comment-69196-info">
<span class="comment-age">(15 May '19, 10:18)</span>
<a class="comment-user userinfo" href="/users/16365/codata_al">codata_al</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-69194">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-69194-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/68268/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="k7I6cRLvFjDAVrM8FzLQy1HKBzAy9rjD"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>