<meta charset="UTF-8"><link rel="stylesheet" type="text/css" href="../style.css"><div id="CALeft">
<div class="headNormal">
<h1><a href="/questions/33698/adding-data-to-osm-file-before-processing-with-mkgmap">Adding data to OSM file before processing with mkgmap</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/33698/up/" id="post-33698-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-33698-score" title="current number of votes">
    1
</div>
<a class="ajax-command post-vote down" href="/vote/33698/down/" id="post-33698-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/33698/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>I generate my own garmin map files using mkgmap. I want to be able to search for addresses using postcodes in the uk. This data isn't widely entered on OSM and its not going to be until we get a paf file. However the office of national statistics publishes a postcode dump which would be sufficient for my purposes. Essentially I want to download the latest OSM data for the uk and the latest ons postcode file and combine them before putting through mkgmap. What is the best way to achieve this?</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-mkgmap" href="/tags/mkgmap/" rel="tag" title="see questions tagged 'mkgmap'">mkgmap</a>
<a class="post-tag tag-link-postcode" href="/tags/postcode/" rel="tag" title="see questions tagged 'postcode'">postcode</a>
<a class="post-tag tag-link-uk" href="/tags/uk/" rel="tag" title="see questions tagged 'uk'">uk</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>05 Jun '14, 08:32</strong>
</p>
<img alt="mcgin's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/b53da6e71be71966b21548ed7e92a57f?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/8979/mcgin">mcgin</a><br/>
<span class="score" title="26 reputation points">26</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">●</span><span class="badgecount">2</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="mcgin has no accepted answers">0%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-33698">
</div>
<div class="comment-tools" id="comment-tools-33698">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-33698-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    One Answer:
                    </div>
<div class="tabsA"><a href="/questions/33698/adding-data-to-osm-file-before-processing-with-mkgmap?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/33698/adding-data-to-osm-file-before-processing-with-mkgmap?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/33698/adding-data-to-osm-file-before-processing-with-mkgmap?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/33698/adding-data-to-osm-file-before-processing-with-mkgmap?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="33859"></a>
<div class="answer" id="answer-container-33859">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/33859/up/" id="post-33859-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-33859-score" title="current number of votes">
    1
</div>
<a class="ajax-command post-vote down" href="/vote/33859/down/" id="post-33859-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>I would simply create two separate layers: one for the OSM data, the other for the ONS or CodePoint Open data. You can then merge these using the --gmapsupp flag of mkgmap.</p>
<p>The more difficult problem is exactly how to transform the Code Point Open data so as to be usable with a Garmin device. Simply ensuring every postcode is tagged in this way "addr:postcode=SW1A 1AA" may not be adequate for your purposes (I presume using postcodes as a geolocation code, as used in commercial satnavs is one use case). </p>
<p>I am not familiar with the status of the address branch of the mkgmap code.</p>
<p>Extending the postcode data to produce approximate locations for actual addresses is theoretically possible (use the 12 million addresses from Land Registry Prices Paid and those from the National Register of Social Housing: both are Open Data sets licensed under OGL), but there are problems in identifying how house numbers increment on particular road segments. Note that most of this latter aspect could be done with OpenData sets without having to use OSM. In the next few months it is likely that some of these data sets will be made available in a modified, and more useful form, on <a href="http://openaddresses.io/">openaddresses.io</a></p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/33859/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>10 Jun '14, 19:06</strong>
</p>
<img alt="SK53's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/06cd84075f1adc2870ad102c7233e661?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/647/sk53">SK53 ♦</a><br/>
<span class="score" title="28084 reputation points"><span class="">28.1k</span></span><span title="48 badges"><span class="badge1">●</span><span class="badgecount">48</span></span><span title="268 badges"><span class="silver">●</span><span class="badgecount">268</span></span><span title="433 badges"><span class="bronze">●</span><span class="badgecount">433</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="SK53 has 121 accepted answers">22%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-33859">
<a name="33862"></a>
<div class="comment" id="comment-33862">
<div class="comment-score" id="post-33862-score"></div>
<div class="comment-text"><p>So it's the creation of that second layer that I'm after, is it simply another IMG file or what format does it need to be in?</p></div>
<div class="comment-info" id="comment-33862-info">
<span class="comment-age">(10 Jun '14, 20:52)</span>
<a class="comment-user userinfo" href="/users/8979/mcgin">mcgin</a>
</div>
</div>
<a name="33863"></a>
<div class="comment" id="comment-33863">
<div class="comment-score" id="post-33863-score">1</div>
<div class="comment-text"><p>Yes just another img file, probably also created with the gmapsupp option (necessary if your source needs to be split into several files) </p>
<p>something like mkgmap --gmapsupp gb_osm_gmapsupp.img ons_gmapsupp.img</p></div>
<div class="comment-info" id="comment-33863-info">
<span class="comment-age">(10 Jun '14, 21:17)</span>
<a class="comment-user userinfo" href="/users/647/sk53">SK53 ♦</a>
</div>
</div>
<a name="33864"></a>
<div class="comment" id="comment-33864">
<div class="comment-score" id="post-33864-score"></div>
<div class="comment-text"><p>So the next question is how to convert the postcode file to an IMG file.  I haven't seen any tools that do this, and I'm not sure what the format of the IMG file is in order to do it manually.</p></div>
<div class="comment-info" id="comment-33864-info">
<span class="comment-age">(10 Jun '14, 21:47)</span>
<a class="comment-user userinfo" href="/users/8979/mcgin">mcgin</a>
</div>
</div>
<a name="33869"></a>
<div class="comment" id="comment-33869">
<div class="comment-score" id="post-33869-score"></div>
<div class="comment-text"><p>You need it as an OSM XML file, so options might be ogr2ogr, QGIS (delimited text layer, save as an OGR compatible layer) &amp; JOSM, or load into PostGIS and use SQL to transform to the snapshot schema format &amp; Osmosis to read it into an OSM file. This may be best as a separate question.</p></div>
<div class="comment-info" id="comment-33869-info">
<span class="comment-age">(11 Jun '14, 07:54)</span>
<a class="comment-user userinfo" href="/users/647/sk53">SK53 ♦</a>
</div>
</div>
<a name="33898"></a>
<div class="comment" id="comment-33898">
<div class="comment-score" id="post-33898-score"></div>
<div class="comment-text"><p>Won't that result in negative ids in the OSM file as its not synced with the main OSM... Are negative ids even a problem?</p></div>
<div class="comment-info" id="comment-33898-info">
<span class="comment-age">(12 Jun '14, 06:26)</span>
<a class="comment-user userinfo" href="/users/8979/mcgin">mcgin</a>
</div>
</div>
<a name="56965"></a>
<div class="comment not_top_scorer" id="comment-56965">
<div class="comment-score" id="post-56965-score"></div>
<div class="comment-text"><p>So anyway, 3 years ago someone asked a valid question.
Pity there was no reply, as I'm in the same boat with no experience how to paddle.</p>
<p>I actually have a comma delimited file: lat, long, postcode, 
over 2.5 million entries.</p>
<p>I would reckon 85% are negative numbers, being UK postcodes.
So if I subtracted these numbers from 360 degrees, would that work?</p>
<p>After that, then what would I do?</p></div>
<div class="comment-info" id="comment-56965-info">
<span class="comment-age">(08 Jul '17, 21:17)</span>
<a class="comment-user userinfo" href="/users/13903/me-again">Me Again</a>
</div>
</div>
<a name="56972"></a>
<div class="comment not_top_scorer" id="comment-56972">
<div class="comment-score" id="post-56972-score"></div>
<div class="comment-text"><p>No longitude is a negative number. And the reply I gave then is still valid now. Convert your file into a suitable OSM form &amp; run mkgmap over the output.</p></div>
<div class="comment-info" id="comment-56972-info">
<span class="comment-age">(09 Jul '17, 12:48)</span>
<a class="comment-user userinfo" href="/users/647/sk53">SK53 ♦</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-33859">
<span class="comments-showing">
            showing 5 of 7
        </span>
<a class="show-all-comments-link" href="#">show 2 more comments</a>
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-33859-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/33698/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="3pam5V8ZoeB7KNLrNZtnlASKq5jjA4TD"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>