<meta charset="utf-8"/><link href="../style.css" rel="stylesheet" type="text/css"/><div id="CALeft"><center><a href="../"><img id="ll" src="https://help.openstreetmap.org/upfiles/osm_help_logo_6.png"/></a></center>
<div class="headNormal">
<h1><a href="/questions/62012/working-of-foreach-loop-in-overpass-ql">Working of foreach loop in Overpass QL</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/62012/up/" id="post-62012-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-62012-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/62012/down/" id="post-62012-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/62012/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>Dear All,</p>
<p>This is with reference to the explanation of foreach loop in Overpass QL on the following page: <a href="https://wiki.openstreetmap.org/wiki/Overpass_API/Overpass_QL#For-each_loop_.28foreach.29">query about foreach loop</a></p>
<p>Query 1:</p>
<p>Inside foreach loop, does ._ refer to one item in the set _ in the global namespace? </p>
<p>For example in this snippet:</p>
<pre><code>way[name="Foo"];
  foreach(
    (
      ._;
      &gt;;
    );
    out;
  );
</code></pre>
<p>Here way[name="Foo"]; will put every way with the name ="Foo" in the default set _ . 
Then foreach will loop over each way in _ ( the global default set) and at each iteration of the foreach loop ._ (inside the foreach loop) refers to ONE way with the name ="Foo" ie ONE way in the global default set.It is taking the union of that ONE way with the nodes constituting that particular way.</p>
<p>Whereas in the following code:</p>
<pre><code>way[name="Foo"];
(._;&gt;;);
out;
</code></pre>
<p>Out here ._ is the set containing ALL the ways with name="Foo".</p>
<p>Do I understand correctly? The meaning of ._ is different when it is within the foreach loop and when it is outside the foreach loop. Is that correct? Its something like a global vs a local variable.</p>
<p>Query 2: 
In this snippet : </p>
<pre><code>way[name="Foo"];
  foreach(
    (
      ._;
      &gt;;
    );
    out;
  );
</code></pre>
<p>The foreach will loop over the global _ and put each way in the global _ in _ (which is local to the foreach) and place the result of (union of local _ and it's nodes ) (._ ;&gt;;); in _ which is local to the foreach and is NOT the global default set. The out will refer to this local _ and print out the contents of the local _ . Is this correct?</p>
<p>Query 3:</p>
<p>It says that the following snippet of code (from here, once again 
link:<a href="https://wiki.openstreetmap.org/wiki/Overpass_API/Overpass_QL#For-each_loop_.28foreach.29">query about foreach loop</a>):-</p>
<pre><code>way[name="Foo"];
  foreach(
    (
      ._;
      &gt;;
    );
    out;
  );
</code></pre>
<p>will do the following:</p>
<p>For each way that has a name tag with value "Foo", this prints the nodes that belong to this way immediately followed by the way itself.</p>
<p>I think the order is the other way round. It seems to me that it will first print each way with the name tag with value Foo and then print the nodes that belong to this way.
Reason : inside the union in foreach loop we have  (._;&gt;;); which FIRST has the way and THEN the nodes and not the other way round. Have I misunderstood how this works?  </p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-overpass-ql" href="/tags/overpass-ql/" rel="tag" title="see questions tagged 'overpass-ql'">overpass-ql</a>
<a class="post-tag tag-link-loop" href="/tags/loop/" rel="tag" title="see questions tagged 'loop'">loop</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>08 Feb '18, 10:43</strong>
</p>
<img alt="ashimkapoor's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/514d8729582ac1f9386d46e13aa0050d?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/14729/ashimkapoor">ashimkapoor</a><br/>
<span class="score" title="21 reputation points">21</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">●</span><span class="badgecount">2</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="ashimkapoor has no accepted answers">0%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/62012/">
                edited
                <strong>08 Feb '18, 10:48</strong>
</a>
</p>
<img alt="scai's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/52d3234f3be58156770e8a91d575bfbd?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/158/scai">scai ♦</a><br/>
<span class="score" title="33317 reputation points"><span class="">33.3k</span></span><span title="21 badges"><span class="badge1">●</span><span class="badgecount">21</span></span><span title="309 badges"><span class="silver">●</span><span class="badgecount">309</span></span><span title="459 badges"><span class="bronze">●</span><span class="badgecount">459</span></span></p>
</div>
</div>
<div class="comments-container" id="comments-container-62012">
</div>
<div class="comment-tools" id="comment-tools-62012">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-62012-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<form action="/questions/62012/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="eK7NxodCj0bfSviMP2ucPry2KLFKgT02"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>