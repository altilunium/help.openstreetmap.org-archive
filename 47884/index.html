<meta charset="UTF-8"><link rel="stylesheet" type="text/css" href="../style.css"><div id="CALeft">
<div class="headNormal">
<h1><a href="/questions/47884/504-error-when-requesting-data-using-wget">504 error when requesting data using wget</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/47884/up/" id="post-47884-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-47884-score" title="current number of votes">
    1
</div>
<a class="ajax-command post-vote down" href="/vote/47884/down/" id="post-47884-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/47884/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>I am using wget to request data on the national borders of a few countries in Western Europe from the Overpass API. I use the following request:</p>
<pre><code>wget "http://overpass-api.de/api/interpreter?data=[out:xml][timeout:3600];(relation(45.0,-6.0,56.0,15.5)["boundary"="administrative"]["admin_level"="2"];node(r)-&gt;.admincentre;way(r);node(w););out;" -O res.osm
</code></pre>
<p>However, each time I get the following error response after a couple of minutes (the first part is in Dutch ;) ):</p>
<pre><code>HTTP-verzoek is verzonden; wachten op antwoord... 504 Gateway Timeout
</code></pre>
<p>Is there any way to resolve this error? I set the timeout to 3600 seconds, but it seems to be ignored. Is that on purpose and is my request too large? If this is the case, are there other options to request my data when sticking to the Overpass API?</p>
<p>Thanks in advance.</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-overpass" href="/tags/overpass/" rel="tag" title="see questions tagged 'overpass'">overpass</a>
<a class="post-tag tag-link-wget" href="/tags/wget/" rel="tag" title="see questions tagged 'wget'">wget</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>03 Feb '16, 22:12</strong>
</p>
<img alt="Steijn's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/b7a71ee7c9bc8c574ea76486008dea16?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/11918/steijn">Steijn</a><br/>
<span class="score" title="61 reputation points">61</span><span title="5 badges"><span class="badge1">●</span><span class="badgecount">5</span></span><span title="6 badges"><span class="silver">●</span><span class="badgecount">6</span></span><span title="9 badges"><span class="bronze">●</span><span class="badgecount">9</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Steijn has no accepted answers">0%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/47884/">
                edited
                <strong>03 Feb '16, 22:17</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-47884">
<a name="47905"></a>
<div class="comment" id="comment-47905">
<div class="comment-score" id="post-47905-score"></div>
<div class="comment-text"><p>Did you try one of the other <a href="https://wiki.openstreetmap.org/wiki/Overpass_API#Introduction">Overpass API instances</a>?</p></div>
<div class="comment-info" id="comment-47905-info">
<span class="comment-age">(04 Feb '16, 11:42)</span>
<a class="comment-user userinfo" href="/users/158/scai">scai ♦</a>
</div>
</div>
<a name="47919"></a>
<div class="comment" id="comment-47919">
<div class="comment-score" id="post-47919-score">2</div>
<div class="comment-text"><p>You may try to get your data country by country and later stitch the results with osmconvert or something else depending what you do with the data. 
You can use capitals to run your query on.</p>
<p>Reasonability: Some borders are fairly complex. For example Italy (7,600 km border length) is ~10MB due to mostly having marine border and simple land border but a small luxembourg (359 km border length) is already ~3MB. Germany  sits on 30MB of data.</p></div>
<div class="comment-info" id="comment-47919-info">
<span class="comment-age">(04 Feb '16, 18:13)</span>
<a class="comment-user userinfo" href="/users/268/rm87">RM87</a>
</div>
</div>
<a name="47922"></a>
<div class="comment" id="comment-47922">
<div class="comment-score" id="post-47922-score">1</div>
<div class="comment-text"><p>scai: I tried other overpass instances, but they yield the same error response. RM87: Ah, that's a nice approach. It works!</p></div>
<div class="comment-info" id="comment-47922-info">
<span class="comment-age">(04 Feb '16, 18:51)</span>
<a class="comment-user userinfo" href="/users/11918/steijn">Steijn</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-47884">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-47884-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    2 Answers:
                    </div>
<div class="tabsA"><a href="/questions/47884/504-error-when-requesting-data-using-wget?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/47884/504-error-when-requesting-data-using-wget?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/47884/504-error-when-requesting-data-using-wget?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/47884/504-error-when-requesting-data-using-wget?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="47923"></a>
<div class="answer answered-by-owner" id="answer-container-47923">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/47923/up/" id="post-47923-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-47923-score" title="current number of votes">
    1
</div>
<a class="ajax-command post-vote down" href="/vote/47923/down/" id="post-47923-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>The Overpass website gives the following information:</p>
<p><em>504 Gateway Timeout is sent if the server has already so much load that the request cannot be executed. In most cases, it is best to try again later. Please note that the server decides this based on the timeout and maxsize parameters of the request, so smaller values for them may also make the request acceptable.</em></p>
<p>So to me the problem seems to be related to the complexity of my request and the amount of requests made to the server at that moment. Cutting the requests in parts, as RM87 suggested earlier, indeed solves the problem.</p>
<p>However, is it possible to show some kind of traffic diagram of the Overpass instances? That way I can do my requests, I have several of them and also more complex, in the more quiet hours. :)</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/47923/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>04 Feb '16, 18:58</strong>
</p>
<img alt="Steijn's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/b7a71ee7c9bc8c574ea76486008dea16?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/11918/steijn">Steijn</a><br/>
<span class="score" title="61 reputation points">61</span><span title="5 badges"><span class="badge1">●</span><span class="badgecount">5</span></span><span title="6 badges"><span class="silver">●</span><span class="badgecount">6</span></span><span title="9 badges"><span class="bronze">●</span><span class="badgecount">9</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Steijn has no accepted answers">0%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-47923">
</div>
<div class="comment-tools" id="comment-tools-47923">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-47923-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<a name="47888"></a>
<div class="answer" id="answer-container-47888">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/47888/up/" id="post-47888-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-47888-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/47888/down/" id="post-47888-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p><code>wget</code> has its own timeout. Try to specify the same timeout via <code>--read-timeout=3600</code>. The default read timeout is 900 seconds according to my manpage.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/47888/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>04 Feb '16, 08:07</strong>
</p>
<img alt="scai's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/52d3234f3be58156770e8a91d575bfbd?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/158/scai">scai ♦</a><br/>
<span class="score" title="33317 reputation points"><span class="">33.3k</span></span><span title="21 badges"><span class="badge1">●</span><span class="badgecount">21</span></span><span title="309 badges"><span class="silver">●</span><span class="badgecount">309</span></span><span title="459 badges"><span class="bronze">●</span><span class="badgecount">459</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="scai has 168 accepted answers">23%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-47888">
<a name="47890"></a>
<div class="comment" id="comment-47890">
<div class="comment-score" id="post-47890-score">1</div>
<div class="comment-text"><p>hmm, I think the 504 is sent from the server because an upstream server (possibly the overpass interpreter) has not answered yet. See <a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes#5xx_Server_Error">http error codes</a>. So, wget's own timeout should not have mattered - yet.</p></div>
<div class="comment-info" id="comment-47890-info">
<span class="comment-age">(04 Feb '16, 09:00)</span>
<a class="comment-user userinfo" href="/users/5179/aseerel4c26">aseerel4c26 ♦</a>
</div>
</div>
<a name="47904"></a>
<div class="comment" id="comment-47904">
<div class="comment-score" id="post-47904-score"></div>
<div class="comment-text"><p>You are probably right. If a read timeout occurs then wget prints a different error message.</p></div>
<div class="comment-info" id="comment-47904-info">
<span class="comment-age">(04 Feb '16, 11:40)</span>
<a class="comment-user userinfo" href="/users/158/scai">scai ♦</a>
</div>
</div>
<a name="47921"></a>
<div class="comment" id="comment-47921">
<div class="comment-score" id="post-47921-score"></div>
<div class="comment-text"><p>I added the timeout flag of wget to my request. However it doesn't seem to solve my problem. Thanks anyway. :)</p></div>
<div class="comment-info" id="comment-47921-info">
<span class="comment-age">(04 Feb '16, 18:49)</span>
<a class="comment-user userinfo" href="/users/11918/steijn">Steijn</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-47888">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-47888-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/47884/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="Tb0Ycaf6hBNJs46EqVBoWy2FAktUuGqO"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>