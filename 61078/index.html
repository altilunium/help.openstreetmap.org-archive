<meta charset="UTF-8"><link rel="stylesheet" type="text/css" href="../style.css"><div id="CALeft">
<div class="headNormal">
<h1><a href="/questions/61078/overpass-how-can-i-create-my-own-area">Overpass: How can I create my own area</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/61078/up/" id="post-61078-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-61078-score" title="current number of votes">
    1
</div>
<a class="ajax-command post-vote down" href="/vote/61078/down/" id="post-61078-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/61078/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>Is it possible to create an area, as part of an Overpass query, for an arbitrary multypolygon relation? </p>
<p>Overpass does not create areas for multipolygons that have no name or postal code, according to <a href="https://github.com/drolbr/Overpass-API/blob/master/src/rules/areas.osm3s">areas.osm3s</a>. </p>
<p>For example, I'd like to find all orphan nodes in the area defined by <a href="http://www.openstreetmap.org/relation/6195356">relation 6195356</a>. </p>
<p><strong>If</strong> this relation had a built-in area, the Overpass query would be:</p>
<pre><code>  node (area:3606195356);     // Find all nodes in multipolygon
  (._; - (way(bn);node(w));); // Remove nodes used by ways
  (._; - node._[~"."~"."];);  // Remove nodes with tags
  (._; - (rel(bn);node(r));); // Remove nodes used by relations
  out meta qt geom;
</code></pre>
<p>The requested solution would be Overpass Query statement(s) that will replace <code>node (area:3606195356);</code></p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-overpass" href="/tags/overpass/" rel="tag" title="see questions tagged 'overpass'">overpass</a>
<a class="post-tag tag-link-area" href="/tags/area/" rel="tag" title="see questions tagged 'area'">area</a>
<a class="post-tag tag-link-overpass-ql" href="/tags/overpass-ql/" rel="tag" title="see questions tagged 'overpass-ql'">overpass-ql</a>
<a class="post-tag tag-link-multipolygon" href="/tags/multipolygon/" rel="tag" title="see questions tagged 'multipolygon'">multipolygon</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>08 Dec '17, 10:58</strong>
</p>
<img alt="zstadler's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/7f7ca553e7227a0e0fe502d1db88cb62?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/9907/zstadler">zstadler</a><br/>
<span class="score" title="116 reputation points">116</span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="5 badges"><span class="silver">●</span><span class="badgecount">5</span></span><span title="8 badges"><span class="bronze">●</span><span class="badgecount">8</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="zstadler has no accepted answers">0%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/61078/">
                closed
                <strong>11 Dec '17, 17:58</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-61078">
<a name="61144"></a>
<div class="comment" id="comment-61144">
<div class="comment-score" id="post-61144-score"></div>
<div class="comment-text"><p>The short and sad answer is it is not possible:</p>
<pre><code>... you as a user cannot influence the area creation process by sending queries to the server. It's all defined in the area creation rules, see Overpass_API/Areas Mmd (talk) 17:22, 9 December 2017 (UTC)
</code></pre>
<p>Ref: 
- <a href="https://wiki.openstreetmap.org/wiki/Overpass_API/status">https://wiki.openstreetmap.org/wiki/Overpass_API/status</a>
- <a href="https://wiki.openstreetmap.org/wiki/Overpass_API/Areas">https://wiki.openstreetmap.org/wiki/Overpass_API/Areas</a></p></div>
<div class="comment-info" id="comment-61144-info">
<span class="comment-age">(11 Dec '17, 17:57)</span>
<a class="comment-user userinfo" href="/users/9907/zstadler">zstadler</a>
</div>
</div>
<a name="61145"></a>
<div class="comment" id="comment-61145">
<div class="comment-score" id="post-61145-score"></div>
<div class="comment-text"><p>The short and sad answer is it is not possible:</p>
<pre><code>... you as a user cannot influence the area creation process by sending queries to the server. It's all defined in the area creation rules, see Overpass_API/Areas Mmd (talk) 17:22, 9 December 2017 (UTC)
</code></pre>
<p>Ref: <a href="https://wiki.openstreetmap.org/wiki/Overpass_API/status">https://wiki.openstreetmap.org/wiki/Overpass_API/status</a></p></div>
<div class="comment-info" id="comment-61145-info">
<span class="comment-age">(11 Dec '17, 18:01)</span>
<a class="comment-user userinfo" href="/users/9907/zstadler">zstadler</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-61078">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-61078-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    One Answer:
                    </div>
<div class="tabsA"><a href="/questions/61078/overpass-how-can-i-create-my-own-area?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/61078/overpass-how-can-i-create-my-own-area?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/61078/overpass-how-can-i-create-my-own-area?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/61078/overpass-how-can-i-create-my-own-area?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="61085"></a>
<div class="answer" id="answer-container-61085">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/61085/up/" id="post-61085-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-61085-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/61085/down/" id="post-61085-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>There's a <code>map_to_area</code> operation that creates an area:</p>
<p><a href="http://wiki.openstreetmap.org/wiki/Overpass_API/Overpass_QL#Map_way.2Frelation_to_area_.28map_to_area.29">http://wiki.openstreetmap.org/wiki/Overpass_API/Overpass_QL#Map_way.2Frelation_to_area_.28map_to_area.29</a></p>
<p>The documentation only says that the operation returns the area associated with the OSM object but it also appears to create it if it doesn't exist. I'm not sure how persistent the new areas are, but at the moment there is an area associated with that relation on the overpass-api.de server, apparently due to my experimenting.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/61085/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>08 Dec '17, 12:43</strong>
</p>
<img alt="maxerickson's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/c860445e868ebb21da141635a4aa7b06?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/10973/maxerickson">maxerickson</a><br/>
<span class="score" title="12700 reputation points"><span class="">12.7k</span></span><span title="10 badges"><span class="badge1">●</span><span class="badgecount">10</span></span><span title="83 badges"><span class="silver">●</span><span class="badgecount">83</span></span><span title="176 badges"><span class="bronze">●</span><span class="badgecount">176</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="maxerickson has 93 accepted answers">32%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/61085/">
                edited
                <strong>08 Dec '17, 12:44</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-61085">
<a name="61089"></a>
<div class="comment" id="comment-61089">
<div class="comment-score" id="post-61089-score"></div>
<div class="comment-text"><p>Unfortunately, this does not seem to work for the relation at hand. The following Overpass query returns nothing:</p>
<pre><code>    rel(6195356);
    map_to_area;
    out;
</code></pre></div>
<div class="comment-info" id="comment-61089-info">
<span class="comment-age">(08 Dec '17, 14:58)</span>
<a class="comment-user userinfo" href="/users/9907/zstadler">zstadler</a>
</div>
</div>
<a name="61092"></a>
<div class="comment" id="comment-61092">
<div class="comment-score" id="post-61092-score"></div>
<div class="comment-text"><p>Could be server specific. Here it returns an area: <a href="http://overpass-turbo.eu/s/tEL">http://overpass-turbo.eu/s/tEL</a></p>
<p>(with overpass-api.de selected in the settings)</p></div>
<div class="comment-info" id="comment-61092-info">
<span class="comment-age">(08 Dec '17, 16:22)</span>
<a class="comment-user userinfo" href="/users/10973/maxerickson">maxerickson</a>
</div>
</div>
<a name="61099"></a>
<div class="comment" id="comment-61099">
<div class="comment-score" id="post-61099-score"></div>
<div class="comment-text"><p>I'm getting an empty set from the overpass-api.de server</p>
<p><a href="http://overpass-api.de/api/interpreter?data=rel%286195356%29%3Bmap_to_area%3Bout%3B">http://overpass-api.de/api/interpreter?data=rel(6195356);map_to_area;out;</a></p>
<p>or</p>
<p><a href='http://overpass-api.de/api/interpreter?data=[out:popup("Results";[type];)];rel(6195356);map_to_area;out;'>http://overpass-api.de/api/interpreter?data=[out:popup("Result:";[type];)];rel(6195356);map_to_area;out;</a></p></div>
<div class="comment-info" id="comment-61099-info">
<span class="comment-age">(08 Dec '17, 20:58)</span>
<a class="comment-user userinfo" href="/users/9907/zstadler">zstadler</a>
</div>
</div>
<a name="61104"></a>
<div class="comment" id="comment-61104">
<div class="comment-score" id="post-61104-score"></div>
<div class="comment-text"><p>Here's the output I get clicking your first link:</p>
<pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;osm version="0.6" generator="Overpass API"&gt;
&lt;note&gt;The data included in this document is from www.openstreetmap.org. The data is made available under ODbL.&lt;/note&gt;
&lt;meta osm_base="2017-12-09T00:25:02Z" areas="2017-12-08T23:26:03Z"/&gt;

  &lt;area id="3606195356"&gt;
    &lt;tag k="name" v="Israel and Palestine"/&gt;
    &lt;tag k="name:de" v="Israel und Palästina"/&gt;
    &lt;tag k="name:en" v="Israel and Palestine"/&gt;
    &lt;tag k="note" v="Do not delete!"/&gt;
    &lt;tag k="type" v="multipolygon"/&gt;
  &lt;/area&gt;

&lt;/osm&gt;
</code></pre></div>
<div class="comment-info" id="comment-61104-info">
<span class="comment-age">(09 Dec '17, 00:28)</span>
<a class="comment-user userinfo" href="/users/10973/maxerickson">maxerickson</a>
</div>
</div>
<a name="61106"></a>
<div class="comment not_top_scorer" id="comment-61106">
<div class="comment-score" id="post-61106-score"></div>
<div class="comment-text"><p>Here is what I get:</p>
<pre><code>    &lt;?xml version="1.0" encoding="UTF-8"?&gt;
    &lt;osm version="0.6" generator="Overpass API 0.7.54.12 054bb0bb"&gt;
    &lt;note&gt;The data included in this document is from www.openstreetmap.org. The data is made available under ODbL.&lt;/note&gt;
    &lt;meta osm_base="2017-12-09T06:15:02Z" areas="2017-12-09T05:42:02Z"/&gt;

    &lt;/osm&gt;
</code></pre>
<p>Also note the difference in the "generator" text.</p>
<p>Strange indeed.</p></div>
<div class="comment-info" id="comment-61106-info">
<span class="comment-age">(09 Dec '17, 06:19)</span>
<a class="comment-user userinfo" href="/users/9907/zstadler">zstadler</a>
</div>
</div>
<a name="61107"></a>
<div class="comment not_top_scorer" id="comment-61107">
<div class="comment-score" id="post-61107-score"></div>
<div class="comment-text"><p>There seems to be a difference between the two servers behind overpass-api.de</p>
<pre><code>&gt; wget -q -O - <a href="http://178.63.48.217/api/interpreter?data=rel%286195356%29%3Bmap_to_area%3Bout%3B">http://178.63.48.217/api/interpreter?data=rel%286195356%29%3Bmap_to_area%3Bout%3B</a>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;osm version="0.6" generator="Overpass API 0.7.54.12 054bb0bb"&gt;
&lt;note&gt;The data included in this document is from www.openstreetmap.org. The data is made available under ODbL.&lt;/note&gt;
&lt;meta osm_base="2017-12-09T06:34:02Z" areas="2017-12-09T05:42:02Z"/&gt;

&lt;/osm&gt;

&gt; wget -q -O - <a href="http://136.243.42.136/api/interpreter?data=rel%286195356%29%3Bmap_to_area%3Bout%3B">http://136.243.42.136/api/interpreter?data=rel%286195356%29%3Bmap_to_area%3Bout%3B</a>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;osm version="0.6" generator="Overpass API"&gt;
&lt;note&gt;The data included in this document is from www.openstreetmap.org. The data is made available under ODbL.&lt;/note&gt;
&lt;meta osm_base="2017-12-09T06:34:02Z" areas="2017-12-09T05:21:02Z"/&gt;

  &lt;area id="3606195356"&gt;
    &lt;tag k="name" v="Israel and Palestine"/&gt;
    &lt;tag k="name:de" v="Israel und Pal├ñstina"/&gt;
    &lt;tag k="name:en" v="Israel and Palestine"/&gt;
    &lt;tag k="note" v="Do not delete!"/&gt;
    &lt;tag k="type" v="multipolygon"/&gt;
  &lt;/area&gt;

&lt;/osm&gt;
</code></pre></div>
<div class="comment-info" id="comment-61107-info">
<span class="comment-age">(09 Dec '17, 06:40)</span>
<a class="comment-user userinfo" href="/users/9907/zstadler">zstadler</a>
</div>
</div>
<a name="61117"></a>
<div class="comment" id="comment-61117">
<div class="comment-score" id="post-61117-score">2</div>
<div class="comment-text"><p>Apparently, the result provided the by "z.overpass-api.de" server (136.243.42.136), which contains the area element, is outdated. See <a href="https://github.com/drolbr/Overpass-API/issues/285#issuecomment-350312885">this comment for GitHub issue 285</a> and a <a href="https://wiki.openstreetmap.org/wiki/Overpass_API/status">9-Dec-2017 server issue report</a>.</p></div>
<div class="comment-info" id="comment-61117-info">
<span class="comment-age">(09 Dec '17, 17:44)</span>
<a class="comment-user userinfo" href="/users/9907/zstadler">zstadler</a>
</div>
</div>
<a name="61132"></a>
<div class="comment not_top_scorer" id="comment-61132">
<div class="comment-score" id="post-61132-score"></div>
<div class="comment-text"><p>It seems like the old areas were also removed from the "z.overpass-api.de" server (136.243.42.136):</p>
<pre>&gt; wget -q -O - <a href="http://z.overpass-api.de/api/interpreter?data=rel%286195356%29%3Bmap_to_area%3Bout%3B">http://z.overpass-api.de/api/interpreter?data=rel%286195356%29%3Bmap_to_area%3Bout%3B</a>

&lt;osm version="0.6" generator="Overpass API 0.7.54.12 054bb0bb"&gt;
&lt;note&gt;The data included in this document is from www.openstreetmap.org. The data is made available under ODbL.&lt;/note&gt;
&lt;meta osm_base="2017-12-11T09:57:02Z" areas="2017-12-11T08:55:02Z"/&gt;

&lt;/osm&gt;
</pre>
<p>The question remains open</p></div>
<div class="comment-info" id="comment-61132-info">
<span class="comment-age">(11 Dec '17, 10:00)</span>
<a class="comment-user userinfo" href="/users/9907/zstadler">zstadler</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-61085">
<span class="comments-showing">
            showing 5 of 8
        </span>
<a class="show-all-comments-link" href="#">show 3 more comments</a>
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-61085-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/61078/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="eDE34tTmH2knxTjW4w4doCj3ZvgyAADU"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>