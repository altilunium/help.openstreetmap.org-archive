<meta charset="UTF-8"><link rel="stylesheet" type="text/css" href="../style.css"><div id="CALeft">
<div class="headNormal">
<h1><a href="/questions/57275/trying-to-extract-countries-boundaries-from-geofabrik-extracts-getting-different-results-missing-boundaries">Trying to extract countries boundaries from geofabrik extracts, getting different results, missing boundaries</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/57275/up/" id="post-57275-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-57275-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/57275/down/" id="post-57275-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/57275/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>Hi, I'm trying to build a dataset with only countries boundaries out of a selected number of countries, I need all administrative levels, I have been able to find useful answers and wiki pages that have proved to be useful to create a pipeline with osmfilter and osm2pgsql. My pipeline  (any suggestion is welcome if something I'm saying is wrong) is set to filter out unwanted informations from osm files with osmfilter and then importing the files in PostgreSQL with osm2pgsql, then, I can view data with QGIS by importing layers from planet_osm_polygon tables.</p>
<p>I got issues with country borders, for example Canada and Mexico:
It is my understanding that Canada and Mexico are presents in geofabrik extracts of North America (north-america-latest.osm.pbf), Canada also has it's own file canada-latest.osm.pbf that should be a subset of North America.
I filter with:
osmfilter in.o5m --keep-relations="boundary=administrative" --keep-nodes= --keep-ways= -o=out.osm
Then add data to database:
osm2pgsql -s -C 1500 -d dbdest -U osm_importer out.osm</p>
<p>Examining the data with QGIS seems that North America with an admin_level level 2 filter shows Canada border along with US but not Mexico that should be there too; Canada only data, instead, at level 2 shows nothing but Graham and Moresby Island (Pacific) and St-Pierre and Sabre Island (Atlantic)</p>
<p>I hope I don't need to do a full OSM / planet import to address this issue.</p>
<p>Thanks</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-boundaries" href="/tags/boundaries/" rel="tag" title="see questions tagged 'boundaries'">boundaries</a>
<a class="post-tag tag-link-admin_level" href="/tags/admin_level/" rel="tag" title="see questions tagged 'admin_level'">admin_level</a>
<a class="post-tag tag-link-osmfilter" href="/tags/osmfilter/" rel="tag" title="see questions tagged 'osmfilter'">osmfilter</a>
<a class="post-tag tag-link-osm2pgsql" href="/tags/osm2pgsql/" rel="tag" title="see questions tagged 'osm2pgsql'">osm2pgsql</a>
<a class="post-tag tag-link-countries" href="/tags/countries/" rel="tag" title="see questions tagged 'countries'">countries</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>25 Jul '17, 22:30</strong>
</p>
<img alt="nicolape's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/6bfcfd2dfbb00ebb62d980a63796120f?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/13966/nicolape">nicolape</a><br/>
<span class="score" title="16 reputation points">16</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">●</span><span class="badgecount">3</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="nicolape has no accepted answers">0%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-57275">
</div>
<div class="comment-tools" id="comment-tools-57275">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-57275-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    One Answer:
                    </div>
<div class="tabsA"><a href="/questions/57275/trying-to-extract-countries-boundaries-from-geofabrik-extracts-getting-different-results-missing-boundaries?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/57275/trying-to-extract-countries-boundaries-from-geofabrik-extracts-getting-different-results-missing-boundaries?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/57275/trying-to-extract-countries-boundaries-from-geofabrik-extracts-getting-different-results-missing-boundaries?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/57275/trying-to-extract-countries-boundaries-from-geofabrik-extracts-getting-different-results-missing-boundaries?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="57276"></a>
<div class="answer accepted-answer" id="answer-container-57276">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/57276/up/" id="post-57276-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-57276-score" title="current number of votes">
    2
</div>
<a class="ajax-command post-vote down" href="/vote/57276/down/" id="post-57276-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="accept-answer on" href="/accept_answer/57276/" rel="nofollow" title="nicolape has selected this answer as the correct answer">
</a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>Why don't you simply use <a href="https://wambachers-osm.website/boundaries/">https://wambachers-osm.website/boundaries/</a> which was just a google away? (yes I'm aware that this is not really an answer to the question)</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/57276/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>25 Jul '17, 23:10</strong>
</p>
<img alt="SimonPoole's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/ad2513d6f8e3d709d576ace900c12fa5?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/2053/simonpoole">SimonPoole ♦</a><br/>
<span class="score" title="44667 reputation points"><span class="">44.7k</span></span><span title="13 badges"><span class="badge1">●</span><span class="badgecount">13</span></span><span title="326 badges"><span class="silver">●</span><span class="badgecount">326</span></span><span title="701 badges"><span class="bronze">●</span><span class="badgecount">701</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="SimonPoole has 209 accepted answers">18%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/57276/">
                edited
                <strong>25 Jul '17, 23:20</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-57276">
<a name="57281"></a>
<div class="comment" id="comment-57281">
<div class="comment-score" id="post-57281-score">1</div>
<div class="comment-text"><p>Thank you for your answer, I have stumbled upon that website in my journey to the boundaries :) , I'm willing to considered your solution as a fallback in case I'll be not able to "manually" filter data by myself.</p></div>
<div class="comment-info" id="comment-57281-info">
<span class="comment-age">(26 Jul '17, 09:31)</span>
<a class="comment-user userinfo" href="/users/13966/nicolape">nicolape</a>
</div>
</div>
<a name="57283"></a>
<div class="comment" id="comment-57283">
<div class="comment-score" id="post-57283-score">1</div>
<div class="comment-text"><p>In any case I can see just a bit too much that could go wrong in your processing workflow, why not simply change the "default.style" so that you only import boundaries and avoid the osmfilter step?</p></div>
<div class="comment-info" id="comment-57283-info">
<span class="comment-age">(26 Jul '17, 10:13)</span>
<a class="comment-user userinfo" href="/users/2053/simonpoole">SimonPoole ♦</a>
</div>
</div>
<a name="57306"></a>
<div class="comment" id="comment-57306">
<div class="comment-score" id="post-57306-score"></div>
<div class="comment-text"><p>Thank you again, I have changed the pipeline, now I use osm2pgsql on the country pbf file from geofabrik, I use a style file with:
node,way   admin_level  text         linear
node,way   boundary     text         linear
node,way   name         text         linear</p>
<p>Unfortunately I'm still getting partial/incomplete boundaries, for example Mexico at level 2 is missing completely the land border, it has only islands, in level 4 is missing Sonora (1673426) in land, still getting his islands.
I was thinking it could be related to the US border, since in the extract is supposed to be only Mexico, but unfortunately others mexican states next to US border as Cihuahua (1673425) are correctly displayed.</p></div>
<div class="comment-info" id="comment-57306-info">
<span class="comment-age">(27 Jul '17, 11:27)</span>
<a class="comment-user userinfo" href="/users/13966/nicolape">nicolape</a>
</div>
</div>
<a name="57310"></a>
<div class="comment not_top_scorer" id="comment-57310">
<div class="comment-score" id="post-57310-score"></div>
<div class="comment-text"><p>You are not by any chance importing the extracts one by one? If yes I'm surprised that it works at all. You should be pre-merging the extracts before import.</p></div>
<div class="comment-info" id="comment-57310-info">
<span class="comment-age">(27 Jul '17, 13:36)</span>
<a class="comment-user userinfo" href="/users/2053/simonpoole">SimonPoole ♦</a>
</div>
</div>
<a name="57365"></a>
<div class="comment" id="comment-57365">
<div class="comment-score" id="post-57365-score">1</div>
<div class="comment-text"><p>Since you showed me the flaws in my process I moved to wambacher as you suggested in the first place, thanks to the help of Walter, he's very kind and patient, I was able to generate the boundaries for my countries.</p></div>
<div class="comment-info" id="comment-57365-info">
<span class="comment-age">(31 Jul '17, 10:52)</span>
<a class="comment-user userinfo" href="/users/13966/nicolape">nicolape</a>
</div>
</div>
<a name="57370"></a>
<div class="comment" id="comment-57370">
<div class="comment-score" id="post-57370-score">1</div>
<div class="comment-text"><p>Do you mind explaining the problems you ran into? Ideally right here in a separate answer so that other people can profit from your experience.</p></div>
<div class="comment-info" id="comment-57370-info">
<span class="comment-age">(31 Jul '17, 12:10)</span>
<a class="comment-user userinfo" href="/users/158/scai">scai ♦</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-57276">
<span class="comments-showing">
            showing 5 of 6
        </span>
<a class="show-all-comments-link" href="#">show 1 more comments</a>
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-57276-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/57275/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="mKVGHtypXbmzYnugtvvp2UqMgTLd5MdV"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>