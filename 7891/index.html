<meta charset="UTF-8"><link rel="stylesheet" type="text/css" href="../style.css"><div id="CALeft">
<div class="headNormal">
<h1><a href="/questions/7891/country-code-nl-stepped-search-algorithm">Country code NL + stepped search algorithm</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/7891/up/" id="post-7891-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-7891-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/7891/down/" id="post-7891-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/7891/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>Hi, I'm new here so I hope this question is to the right audience.</p>
<p>I'm developing software that wants to use the nominatim API for geocoding. We have all the technicalities solved, and get satisfactory results as long as the entered address data is correct. But of course there are situations where the address data we send to nominatim is incorrect. We now have an algorithm as follows:
1) try to get the geocode for street + house number, city, (state,) country code (we add state only for US addresses)
2) if 1 fails, try to get the geocode for city, (state,) country code
3) if 2 fails, try to get the geocode for (state,) country code</p>
<p>Unfortunately I can only use country codes, no country names.</p>
<p>Now I have two questions:</p>
<ul>
<li>When we get to step 3 for The Netherlands (code NL), (<a href="http://nominatim.openstreetmap.org/search?q=,,,NL&amp;format=xml)">http://nominatim.openstreetmap.org/search?q=,,,NL&amp;format=xml)</a> we get this geocode (lat="49.4026367037741" lon="-0.234108765413479") which is in the Atlantic next to France. This looks like an OpenStreetMap data problem. Can this be resolved somehow?</li>
<li>The 1-2-3 logic above perhaps is way to simple. On the other hand, trying to find a geocode on increasing less-precise level until you succeed sounds like a generic solution. Isn't such a feature available standard in nominatim?</li>
</ul>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-openstreetmap" href="/tags/openstreetmap/" rel="tag" title="see questions tagged 'openstreetmap'">openstreetmap</a>
<a class="post-tag tag-link-country" href="/tags/country/" rel="tag" title="see questions tagged 'country'">country</a>
<a class="post-tag tag-link-nominatim" href="/tags/nominatim/" rel="tag" title="see questions tagged 'nominatim'">nominatim</a>
<a class="post-tag tag-link-geocoding" href="/tags/geocoding/" rel="tag" title="see questions tagged 'geocoding'">geocoding</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>15 Sep '11, 10:23</strong>
</p>
<img alt="msol's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/b98e1f9c0bc31e2a0059d90912e27154?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/2081/msol">msol</a><br/>
<span class="score" title="1 reputation points">1</span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="3 badges"><span class="silver">●</span><span class="badgecount">3</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="msol has no accepted answers">0%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-7891">
</div>
<div class="comment-tools" id="comment-tools-7891">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-7891-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    2 Answers:
                    </div>
<div class="tabsA"><a href="/questions/7891/country-code-nl-stepped-search-algorithm?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/7891/country-code-nl-stepped-search-algorithm?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/7891/country-code-nl-stepped-search-algorithm?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/7891/country-code-nl-stepped-search-algorithm?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="7897"></a>
<div class="answer" id="answer-container-7897">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/7897/up/" id="post-7897-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-7897-score" title="current number of votes">
    4
</div>
<a class="ajax-command post-vote down" href="/vote/7897/down/" id="post-7897-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>Regarding the Netherlands: Nominatim is giving the location based on <a href="http://www.openstreetmap.org/browse/relation/47796">relation 47796</a>. This includes the 'mainland' part (in Europe), as well as several islands in the Caribbean. These are all part of the country of the Netherlands, so it appears the OSM data is actually correct. But it seems Nominatim is calculating the centre point of all of this, which is somewhere in the Atlantic.</p>
<p>I don't know whether this should be mapped or tagged differently. Maybe Nominatim could somehow calculate the centre of just the mainland part. Or use the location of the node with role admin_centre. This should probably be discussed on the appropriate mailing lists.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/7897/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>15 Sep '11, 13:47</strong>
</p>
<img alt="Vclaw's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/aa505c046b1c010e997a7849c6f3dbbe?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/62/vclaw">Vclaw</a><br/>
<span class="score" title="9217 reputation points"><span class="">9.2k</span></span><span title="8 badges"><span class="badge1">●</span><span class="badgecount">8</span></span><span title="95 badges"><span class="silver">●</span><span class="badgecount">95</span></span><span title="141 badges"><span class="bronze">●</span><span class="badgecount">141</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Vclaw has 41 accepted answers">22%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-7897">
<a name="7921"></a>
<div class="comment" id="comment-7921">
<div class="comment-score" id="post-7921-score"></div>
<div class="comment-text"><p>Thanks. Funny to be punished for colonialism even today :-)
So, what are the "appropriate mailing lists" to address this issue? (Sorry, I'm a newbee here.)</p></div>
<div class="comment-info" id="comment-7921-info">
<span class="comment-age">(16 Sep '11, 09:19)</span>
<a class="comment-user userinfo" href="/users/2081/msol">msol</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-7897">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-7897-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<a name="7901"></a>
<div class="answer" id="answer-container-7901">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/7901/up/" id="post-7901-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-7901-score" title="current number of votes">
    1
</div>
<a class="ajax-command post-vote down" href="/vote/7901/down/" id="post-7901-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>If you can accept solutions next to Nominatim's geocoding, have a look at <strong>Navit</strong> or <strong>OsmAnd</strong> (both opensourced) how they can find their addresses and how they output if some locations fail.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/7901/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>15 Sep '11, 18:17</strong>
</p>
<img alt="stephan75's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/245b73d4390c3408fe3c6da759b9897f?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/99/stephan75">stephan75</a><br/>
<span class="score" title="12642 reputation points"><span class="">12.6k</span></span><span title="5 badges"><span class="badge1">●</span><span class="badgecount">5</span></span><span title="56 badges"><span class="silver">●</span><span class="badgecount">56</span></span><span title="210 badges"><span class="bronze">●</span><span class="badgecount">210</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="stephan75 has 37 accepted answers">6%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-7901">
</div>
<div class="comment-tools" id="comment-tools-7901">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-7901-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/7891/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="D6LvuiOBzpsKZNExNwpdUEQ7dXSEo240"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>