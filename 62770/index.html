<meta charset="UTF-8"><link rel="stylesheet" type="text/css" href="../style.css"><div id="CALeft">
<div class="headNormal">
<h1><a href="/questions/62770/help-aide-osm-postgis-query-layers-line-point">Help / Aide :OSM postgis query Layers line Point</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/62770/up/" id="post-62770-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-62770-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/62770/down/" id="post-62770-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/62770/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>Bonsoir</p>
<p>Je suis nouveau ( moins d’un mois ) , pour faire la version courte .
-   J’ai installé Qgis (pas encore réellement utilisé)
-   Installé Postgresql  (connaissance limite  )
-   Téléchargé  depuis <a href="https://download.geofabrik.de/">https://download.geofabrik.de/</a> et intégré avec  deux méthodes ogr2ogr et osm2pgsql (bien sur 2 bases ) (recherche sur le net) .
L’idée est de pouvoir extraire une base de donnée  (voie/Rue/….)  cad planet_osm_line et les associés avec (Localité,Ville,village…) planet_osm_point   et de les comparer avec un référentiel pour avoir les candidats (voie/Rue/….) qui ne figurent pas sur OSM
C’est ici que j’ai besoin de votre aide.
Voici la query simplifié :</p>
<pre><code>SELECT 
    public.planet_osm_line.name,public.planet_osm_line.highway,public.planet_osm_line.boundary,
    public.planet_osm_line.route,public.planet_osm_line.barrier,public.planet_osm_line.osm_id,
    public.planet_osm_point.name, public.planet_osm_point.place,public.planet_osm_point.amenity,
    public.planet_osm_point.osm_id
FROM
  public.planet_osm_line,
   public.planet_osm_point
  where
  ST_Contains(public.planet_osm_line.way,  public.planet_osm_point.way)
  And 
  (public.planet_osm_point.place = 'city' OR
   public.planet_osm_point.place = 'town' OR
   public.planet_osm_point.place = 'village' OR
   public.planet_osm_point.place = 'hamlet' OR
   public.planet_osm_point.place = 'dwelling')
</code></pre>
<p>Résultat : rien  .</p>
<p>Merci d’avance.</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-postgresql" href="/tags/postgresql/" rel="tag" title="see questions tagged 'postgresql'">postgresql</a>
<a class="post-tag tag-link-points" href="/tags/points/" rel="tag" title="see questions tagged 'points'">points</a>
<a class="post-tag tag-link-osm" href="/tags/osm/" rel="tag" title="see questions tagged 'osm'">osm</a>
<a class="post-tag tag-link-lines" href="/tags/lines/" rel="tag" title="see questions tagged 'lines'">lines</a>
<a class="post-tag tag-link-query" href="/tags/query/" rel="tag" title="see questions tagged 'query'">query</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>21 Mar '18, 21:16</strong>
</p>
<img alt="Fox2000's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/ad98d8b056eb0ac971523411f851db1a?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/14888/fox2000">Fox2000</a><br/>
<span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">●</span><span class="badgecount">3</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Fox2000 has no accepted answers">0%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/62770/">
                edited
                <strong>21 Mar '18, 21:26</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-62770">
</div>
<div class="comment-tools" id="comment-tools-62770">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-62770-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    One Answer:
                    </div>
<div class="tabsA"><a href="/questions/62770/help-aide-osm-postgis-query-layers-line-point?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/62770/help-aide-osm-postgis-query-layers-line-point?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/62770/help-aide-osm-postgis-query-layers-line-point?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/62770/help-aide-osm-postgis-query-layers-line-point?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="62775"></a>
<div class="answer" id="answer-container-62775">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/62775/up/" id="post-62775-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-62775-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/62775/down/" id="post-62775-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>Hello,</p>
<p>Est-ce que <a href="https://cadastre.openstreetmap.fr/fantoir/">https://cadastre.openstreetmap.fr/fantoir/</a> fait déjà ce que tu veux faire?</p>
<p>Sinon, <code>st_contains</code> n'est pas la fonction que tu recherches; tu n'aurais des résultats que si le chemin est accidentellement à cheval sur la frontière d'une commune. Je crois que tu veux quelque chose <code>st_within</code> ou <code>st_intersects</code>, genre:</p>
<p><code>select distinct l.name from planet_osm_line l, planet_osm_polygon g where l.highway is not null and l.name is not null AND ST_Intersects(l.way,g.way) AND g.name LIKE 'Commune';</code></p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/62775/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>22 Mar '18, 08:17</strong>
</p>
<img alt="Stereo's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/aace33beb0d1a608b0763ac8a2404049?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/9786/stereo">Stereo</a><br/>
<span class="score" title="356 reputation points">356</span><span title="2 badges"><span class="badge1">●</span><span class="badgecount">2</span></span><span title="5 badges"><span class="silver">●</span><span class="badgecount">5</span></span><span title="13 badges"><span class="bronze">●</span><span class="badgecount">13</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Stereo has one accepted answer">11%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-62775">
<a name="62811"></a>
<div class="comment" id="comment-62811">
<div class="comment-score" id="post-62811-score"></div>
<div class="comment-text"><p>Merci beaucoup tu m'aides beaucoup.</p></div>
<div class="comment-info" id="comment-62811-info">
<span class="comment-age">(24 Mar '18, 20:12)</span>
<a class="comment-user userinfo" href="/users/14888/fox2000">Fox2000</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-62775">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-62775-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/62770/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="9hdX7GiAdhng2iafSgbeyYsklmpkrQ7X"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>