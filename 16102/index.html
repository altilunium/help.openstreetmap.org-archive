<meta charset="utf-8"/><link href="../style.css" rel="stylesheet" type="text/css"/><div id="CALeft"><center><a href="../"><img id="ll" src="https://help.openstreetmap.org/upfiles/osm_help_logo_6.png"/></a></center>
<div class="headNormal">
<h1><a href="/questions/16102/using-osmconvert-to-csv-file-only-returns-id-lat-and-lon">Using osmconvert to .csv file only returns id, lat, and lon.</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/16102/up/" id="post-16102-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-16102-score" title="current number of votes">
    1
</div>
<a class="ajax-command post-vote down" href="/vote/16102/down/" id="post-16102-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/16102/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>I want to use osmconvert to .csv to put certain fields into a csv file and I want to keep the relations. </p>
<p>First, I want to run osmfilter to filter data to just street, city, state, lat, long where street, city, and state are all populated for each record. In other words, I don't want a bunch of records with the state populated but not the city and street.</p>
<p>I created a parameters file with the following
-v</p>
<p>-keep=
-keep-relations
all
addr:street!=
addr:city!=
addr:state!=</p>
<p>Then I run osmconvert like below, but I am getting records where the state is just populated. Also, I see records where the just street and city are populated.
./osmconvert planetfile.osm --csv"addr:street addr:city addr:state" --csv-headline -o=filteredfile.csv.</p>
<p>I also tried @lat and <a href="/users/1350/longestaugust">@long</a> in the above statement to filter lat and long for the street as well, but then it didn't report any streets, cities or states, just lat and long.</p>
<p>So, I guess there is two questions? How do I filter the data such that all the fields I need are populated? And how do I tack on lat and long in the convert statement to get it to appear with the addresses in the csv?</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-osmconvert" href="/tags/osmconvert/" rel="tag" title="see questions tagged 'osmconvert'">osmconvert</a>
<a class="post-tag tag-link-csv" href="/tags/csv/" rel="tag" title="see questions tagged 'csv'">csv</a>
<a class="post-tag tag-link-osmfilter" href="/tags/osmfilter/" rel="tag" title="see questions tagged 'osmfilter'">osmfilter</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>14 Sep '12, 17:06</strong>
</p>
<img alt="JMB5's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/a45de846d76d68849c0e70b6fd21f256?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/4510/jmb5">JMB5</a><br/>
<span class="score" title="16 reputation points">16</span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="3 badges"><span class="silver">●</span><span class="badgecount">3</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="JMB5 has no accepted answers">0%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-16102">
<a name="33387"></a>
<div class="comment" id="comment-33387">
<div class="comment-score" id="post-33387-score"></div>
<div class="comment-text"><p>many many thanxk you helped me alot</p></div>
<div class="comment-info" id="comment-33387-info">
<span class="comment-age">(22 May '14, 21:53)</span>
<a class="comment-user userinfo" href="/users/8644/say_hello_to_the_world">say_hello_to...</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-16102">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-16102-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    2 Answers:
                    </div>
<div class="tabsA"><a href="/questions/16102/using-osmconvert-to-csv-file-only-returns-id-lat-and-lon?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/16102/using-osmconvert-to-csv-file-only-returns-id-lat-and-lon?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/16102/using-osmconvert-to-csv-file-only-returns-id-lat-and-lon?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/16102/using-osmconvert-to-csv-file-only-returns-id-lat-and-lon?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="16246"></a>
<div class="answer" id="answer-container-16246">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/16246/up/" id="post-16246-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-16246-score" title="current number of votes">
    1
</div>
<a class="ajax-command post-vote down" href="/vote/16246/down/" id="post-16246-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>Jochen is right, Osmium is much more fexible if you want to do special data processing. However, what you want to accomplish can be done with <a href="http://wiki.openstreetmap.org/wiki/Osmfilter">osmfilter</a>/<a href="http://wiki.openstreetmap.org/wiki/Osmconvert">osmconvert</a> too. For example:
<br/>
<br/></p>
<p>$ ./osmfilter bremen.o5m --keep="addr:country= and addr:city= and addr:street=" --ignore-dependencies | ./osmconvert - --csv="@oname <a href="/users/260/idoneus">@id</a> <a href="/users/1350/longestaugust">@lon</a> @lat addr:country addr:city addr:street"<br/>
<br/>
node    103065646   8.7174590   53.1528516  DE  Bremen  Alwin-Lonke-Straße<br/>
node    103075917   8.7113611   53.1501230  DE  Bremen  Grambker Heerstraße<br/>
node    169500351   8.8907070   53.0349470  DE  Bremen  Europaallee<br/>
node    171358853   8.8809487   53.0704234  DE  Bremen  Hützelstrasse<br/>
node    172133861   8.8860047   53.0607349  DE  Bremen  Hemelinger Bahnhofstraße<br/>
node    175673452   8.9541837   53.0338771  DE  Achim   Uphuser Heerstraße<br/>
node    175675316   8.9675299   53.0574772  DE  Oyten   Oyterdamm<br/>
...
<br/>
<br/></p>
<p>I am just not sure what you mean with "keeping the relations". If you really want only relations but nothing else, you might want to filter this way:</p>
<p>$ ./osmfilter bremen.o5m --keep="" --keep-relations="addr:country= and ...</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/16246/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>18 Sep '12, 23:52</strong>
</p>
<img alt="Marqqs's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/3b5b4abfedd46928c7cd0d5cbf907ed3?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/4540/marqqs">Marqqs</a><br/>
<span class="score" title="448 reputation points">448</span><span title="5 badges"><span class="silver">●</span><span class="badgecount">5</span></span><span title="10 badges"><span class="bronze">●</span><span class="badgecount">10</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Marqqs has 2 accepted answers">22%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-16246">
<a name="33384"></a>
<div class="comment" id="comment-33384">
<div class="comment-score" id="post-33384-score"></div>
<div class="comment-text"><p>overwhelming - you saved my day: many many thanks for sharing your insights - great!</p></div>
<div class="comment-info" id="comment-33384-info">
<span class="comment-age">(22 May '14, 20:26)</span>
<a class="comment-user userinfo" href="/users/8644/say_hello_to_the_world">say_hello_to...</a>
</div>
</div>
<a name="33880"></a>
<div class="comment" id="comment-33880">
<div class="comment-score" id="post-33880-score"></div>
<div class="comment-text"><p>hi there! could you help out? I am using your osmfilter nodes_hiAgra.osm --keep="addr:street=" --ignore-depemdencies --drop-relations --drop-ways |osmconvert - --csv="<a href="/users/260/idoneus">@id</a> <a href="/users/1350/longestaugust">@lon</a> <a href="/users/5110/latroc">@lat</a> addr:street "
and only got 1 line .... But streets are more in that area What to do?
I need only id,lon,lat, street_name</p></div>
<div class="comment-info" id="comment-33880-info">
<span class="comment-age">(11 Jun '14, 12:44)</span>
<a class="comment-user userinfo" href="/users/2089/gevork">Gevork</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-16246">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-16246-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<a name="16137"></a>
<div class="answer" id="answer-container-16137">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/16137/up/" id="post-16137-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-16137-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/16137/down/" id="post-16137-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>I am not sure I understand exactly what you want, but if you find that osmconvert doesn't do what you need, you might want to try <a href="http://wiki.openstreetmap.org/wiki/Osmium">Osmium</a>, specifically the "osmjs" utility that comes with it. Osmjs can also create CSV files and you can write small Javascript snippets to define exactly what you need, so it is rather flexible. There are examples in the "osmjs" directory in the distribution.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/16137/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>16 Sep '12, 07:56</strong>
</p>
<img alt="Jochen%20Topf's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/2d4dfcdcde73aa5e2ffa4a9b3a7cb51d?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/112/jochen-topf">Jochen Topf</a><br/>
<span class="score" title="5244 reputation points"><span class="">5.2k</span></span><span title="5 badges"><span class="badge1">●</span><span class="badgecount">5</span></span><span title="50 badges"><span class="silver">●</span><span class="badgecount">50</span></span><span title="74 badges"><span class="bronze">●</span><span class="badgecount">74</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Jochen Topf has 32 accepted answers">31%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-16137">
<a name="33383"></a>
<div class="comment" id="comment-33383">
<div class="comment-score" id="post-33383-score"></div>
<div class="comment-text"><p>hello dear jochen many many thanks for sharing your insights - great! you helped me alot</p></div>
<div class="comment-info" id="comment-33383-info">
<span class="comment-age">(22 May '14, 20:25)</span>
<a class="comment-user userinfo" href="/users/8644/say_hello_to_the_world">say_hello_to...</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-16137">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-16137-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/16102/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="H5liqdYlhjpBUp9KnH98rCJbSQeJ6MFI"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>