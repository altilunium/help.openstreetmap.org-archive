<meta charset="utf-8"/><link href="../style.css" rel="stylesheet" type="text/css"/><div id="CALeft"><center><a href="../"><img id="ll" src="https://help.openstreetmap.org/upfiles/osm_help_logo_6.png"/></a></center>
<div class="headNormal">
<h1><a href="/questions/83121/extract-certain-geodata-from-osm-file">Extract certain geodata from OSM File</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/83121/up/" id="post-83121-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-83121-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/83121/down/" id="post-83121-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/83121/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>Hi, is there a way to extract just certain data from a specific country from that massive OSM file?</p>
<p>I would like to retrieve the German zip codes, the city names including the parts of town and LAT and LON. Export format maybe something like csv or xml. Is that possible in some sort of automatic way? There are free databases that provide nearly everything of my desired data but the parts of town and their specific LAT and LON are always missing.</p>
<p>Thank you guys for your ideas.</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-geodata" href="/tags/geodata/" rel="tag" title="see questions tagged 'geodata'">geodata</a>
<a class="post-tag tag-link-latitude" href="/tags/latitude/" rel="tag" title="see questions tagged 'latitude'">latitude</a>
<a class="post-tag tag-link-extract" href="/tags/extract/" rel="tag" title="see questions tagged 'extract'">extract</a>
<a class="post-tag tag-link-longitude" href="/tags/longitude/" rel="tag" title="see questions tagged 'longitude'">longitude</a>
<a class="post-tag tag-link-zip-code" href="/tags/zip-code/" rel="tag" title="see questions tagged 'zip-code'">zip-code</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>19 Jan '22, 13:51</strong>
</p>
<img alt="Bingoboy1234's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/613f5a8365ac1b645e5d742c87756857?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/21305/bingoboy1234">Bingoboy1234</a><br/>
<span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">●</span><span class="badgecount">2</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Bingoboy1234 has no accepted answers">0%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-83121">
</div>
<div class="comment-tools" id="comment-tools-83121">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-83121-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    2 Answers:
                    </div>
<div class="tabsA"><a href="/questions/83121/extract-certain-geodata-from-osm-file?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/83121/extract-certain-geodata-from-osm-file?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/83121/extract-certain-geodata-from-osm-file?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/83121/extract-certain-geodata-from-osm-file?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="83122"></a>
<div class="answer" id="answer-container-83122">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/83122/up/" id="post-83122-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-83122-score" title="current number of votes">
    1
</div>
<a class="ajax-command post-vote down" href="/vote/83122/down/" id="post-83122-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>You can do it but it is not trivial. The easiest way is probably importing the data into a PostGIS database with <code>osm2pgsql</code> (you can make it import only the features you are interested in) and then work with SQL. Thing is that the "parts of town" you're after may be mapped as a single node (<code>place=suburb</code> or <code>place=neighbourhood</code>) in which case they have a straigforward lat/lon, or they might be a polygon in which case you need to compute the centroid (which is easy to do in PostGIS).</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/83122/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>19 Jan '22, 13:58</strong>
</p>
<img alt="Frederik%20Ramm's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/a2b38d937e70ab39d895d17da0dd1ba4?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/104/frederik-ramm">Frederik Ramm ♦</a><br/>
<span class="score" title="82494 reputation points"><span class="">82.5k</span></span><span title="92 badges"><span class="badge1">●</span><span class="badgecount">92</span></span><span title="720 badges"><span class="silver">●</span><span class="badgecount">720</span></span><span title="1273 badges"><span class="bronze">●</span><span class="badgecount">1273</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Frederik Ramm has 417 accepted answers">23%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-83122">
<a name="83274"></a>
<div class="comment" id="comment-83274">
<div class="comment-score" id="post-83274-score"></div>
<div class="comment-text"><p>Thank you, Frederik. That sounds complicated. I need to train myself with PostGIS. By now I am unfortunately only used to MySQL. Can I compute the polygon centroid automatically for the whole of all German parts of towns in one go or do I need to do that by hand for each city? Latter could become a job without an end.</p></div>
<div class="comment-info" id="comment-83274-info">
<span class="comment-age">(31 Jan '22, 10:22)</span>
<a class="comment-user userinfo" href="/users/21305/bingoboy1234">Bingoboy1234</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-83122">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-83122-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<a name="83275"></a>
<div class="answer" id="answer-container-83275">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/83275/up/" id="post-83275-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-83275-score" title="current number of votes">
    1
</div>
<a class="ajax-command post-vote down" href="/vote/83275/down/" id="post-83275-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>I am not sure what the status of osm-to-mysql importers is. I suspect it will be easier for you to get to grips with PostgreSQL than to try and import to mysql - the difference in terms of SQL should be minuscle. Of course you can compute the centroid for all parts of towns in PostGIS, something like</p>
<pre><code>SELECT 
  st_centroid(way) AS geom,
  name,
  place
INTO
  ortsteile
FROM 
  planet_osm_polygon
WHERE
  place in ('neighbourhood','suburb');
</code></pre>
<p>After that, add those that were already present as points</p>
<pre><code>INSERT INTO 
  ortsteile
(SELECT way as geom, name, place FROM 
planet_osm_point WHERE place in ('neighbourhood','suburb');
</code></pre>
<p>You might also want to add the admin boundaries on levels above 8 to the mix. And later to find out which city something is in,</p>
<pre><code>ALTER TABLE ortsteile ADD COLUMN ort VARCHAR(64);
UPDATE ortsteile
SET ort = (SELECT name FROM planet_osm_polygon
  WHERE boundary='administrative' AND admin_level='8' AND
  st_contains(way, geom));
</code></pre>
<p>Because in Germany some cities ("kreisfreie Städte") have an admin_level of 6 you will want to re-run the last query for those points that didn't have an admin_level 8 parent:</p>
<pre><code>UPDATE ortsteile
SET ort = (SELECT name FROM planet_osm_polygon
  WHERE boundary='administrative' AND admin_level='6' AND
  st_contains(way, geom)
WHERE ort IS NULL;
</code></pre>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/83275/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>31 Jan '22, 10:37</strong>
</p>
<img alt="Frederik%20Ramm's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/a2b38d937e70ab39d895d17da0dd1ba4?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/104/frederik-ramm">Frederik Ramm ♦</a><br/>
<span class="score" title="82494 reputation points"><span class="">82.5k</span></span><span title="92 badges"><span class="badge1">●</span><span class="badgecount">92</span></span><span title="720 badges"><span class="silver">●</span><span class="badgecount">720</span></span><span title="1273 badges"><span class="bronze">●</span><span class="badgecount">1273</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Frederik Ramm has 417 accepted answers">23%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/83275/">
                edited
                <strong>31 Jan '22, 10:38</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-83275">
</div>
<div class="comment-tools" id="comment-tools-83275">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-83275-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/83121/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="QZ6jaHV0dWA2r0b28YuPyHCImJrQ7uTP"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>