<meta charset="utf-8"/><link href="../style.css" rel="stylesheet" type="text/css"/><div id="CALeft"><center><a href="../"><img id="ll" src="https://help.openstreetmap.org/upfiles/osm_help_logo_6.png"/></a></center>
<div class="headNormal">
<h1><a href="/questions/46414/multipolygon-not-working-as-expected-solved">multipolygon not working as expected [solved]</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/46414/up/" id="post-46414-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-46414-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/46414/down/" id="post-46414-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/46414/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>Hi there, I have added some water elements in an area of meadows (grass-type vegetation).</p>
<p>The larger area is marked with way <a href="http://www.openstreetmap.org/way/346287712">346287712</a>. This way has a relation: multipolygon <a href="http://www.openstreetmap.org/relation/5640835">5640835</a>. The selected role is 'outer'. The relation has the following two keys/values: landuse/meadow and type/multipolygon. This part seems to work, as can be seen here:</p>
<p><a href="http://www.openstreetmap.org/#map=16/52.2843/5.5249">link to the map</a></p>
<p>Inside of the multipolygon I created a number of lakes. The lake that is most south ('Zuiderzee') has an island in it, so I had to create <a href="http://www.openstreetmap.org/relation/5640834">another relation</a> (multopolygon) for the lake. The island is rendered correctly. The water is also rendered, but it has the small tree icons through it, just like the surrounding land.</p>
<p>So my question is: how do I make the water completely blue, without the small tree icons in it?</p>
<p>I have already tried making the water without any relations, this can be seen in the third lake from the south called 't Aelmare. This brings up the same problem.</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-water" href="/tags/water/" rel="tag" title="see questions tagged 'water'">water</a>
<a class="post-tag tag-link-multipolygon" href="/tags/multipolygon/" rel="tag" title="see questions tagged 'multipolygon'">multipolygon</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>05 Nov '15, 16:19</strong>
</p>
<img alt="_Ari's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/f02efb083fed246097e8c87f5b92be99?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/11658/_ari">_Ari</a><br/>
<span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">●</span><span class="badgecount">3</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="_Ari has no accepted answers">0%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/46414/">
                edited
                <strong>10 Oct '16, 17:11</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-46414">
<a name="46416"></a>
<div class="comment" id="comment-46416">
<div class="comment-score" id="post-46416-score"></div>
<div class="comment-text"><p>Your edit is recent, it will take time for it to render, if time does not fix it maybe this is the answer---
 <a href="http://wiki.openstreetmap.org/wiki/Multipolygon_Examples#Forest_with_two_lakes_and_an_island_.28Nested_multipolygons.29">http://wiki.openstreetmap.org/wiki/Multipolygon_Examples#Forest_with_two_lakes_and_an_island_.28Nested_multipolygons.29</a></p></div>
<div class="comment-info" id="comment-46416-info">
<span class="comment-age">(05 Nov '15, 19:58)</span>
<a class="comment-user userinfo" href="/users/644/andy-mackey">andy mackey</a>
</div>
</div>
<a name="46435"></a>
<div class="comment" id="comment-46435">
<div class="comment-score" id="post-46435-score"></div>
<div class="comment-text"><p>Relation 5640835 has no landuse value, I only see its type. That said, there are lots of trees everywhere, and I don't quite get where they're coming from. Probably, as andy said, time will fix it.</p></div>
<div class="comment-info" id="comment-46435-info">
<span class="comment-age">(06 Nov '15, 12:56)</span>
<a class="comment-user userinfo" href="/users/10142/joost-schouppe">joost schouppe</a>
</div>
</div>
<a name="46450"></a>
<div class="comment" id="comment-46450">
<div class="comment-score" id="post-46450-score"></div>
<div class="comment-text"><p>Time didn't fix it, there must still be something wrong with the multipolygon relations. The lakes still contain trees.</p></div>
<div class="comment-info" id="comment-46450-info">
<span class="comment-age">(07 Nov '15, 19:14)</span>
<a class="comment-user userinfo" href="/users/158/scai">scai ♦</a>
</div>
</div>
<a name="52423"></a>
<div class="comment" id="comment-52423">
<div class="comment-score" id="post-52423-score"></div>
<div class="comment-text"><p>This place is a mystery.
Something is seriously wrong there with the mapnik-carto tiles, almost as if they were write-protected!? Since about a YEAR, despite changes in the meantime. Anyone can figure this out?  </p>
<p><a href="http://mc.bbbike.org/mc/?lat=52.2871906&amp;lon=5.52683644&amp;zoom=15&amp;num=3&amp;mt0=mapnik&amp;mt1=osmfr&amp;mt2=osm-no-labels">http://mc.bbbike.org/mc/?lat=52.2871906&amp;lon=5.52683644&amp;zoom=15&amp;num=3&amp;mt0=mapnik&amp;mt1=osmfr&amp;mt2=osm-no-labels</a></p>
<p>About a year ago the old forest area was completely restructured to install a new campsite, Scoutinglandgoed Zeewolde. Big parts of the forest cut down, new lakes created, tracks and paths are partly different, and OSM was updated accordingly. But mapnik won't show any of it, no matter what. </p>
<p>Cannot find anything wrong with the areas there, and doubt there is. It's not only the areas, but even the tracks and paths are still cached old, for example a way going through the middle of a new lake. And other renderers do show the updates correctly, no prob.</p></div>
<div class="comment-info" id="comment-52423-info">
<span class="comment-age">(09 Oct '16, 15:18)</span>
<a class="comment-user userinfo" href="/users/12848/wycbtma">wycbtma</a>
</div>
</div>
<a name="52424"></a>
<div class="comment not_top_scorer" id="comment-52424">
<div class="comment-score" id="post-52424-score"></div>
<div class="comment-text"><p>The weirdest thing is: I did already get mapnik to update the tiles correctly, some weeks ago. After a major struggle, and when nothing helped ending up trying brute force (new fake stream all over the area, updated tiles, some minutes later deleted the fake stream again, updated tiles - all looked fine then). But today came across the area again and was shocked: it had actually RESTORED the OLD tiles again! Just for testing tried the fake-stream method again, but this time didn't help a thing anymore. The stream was shown, but the area behind it NOT updated any more. Have deleted all traces of my fixing attemps again. </p>
<p>No idea if it would help to delete and then rebuild the new AREAs there again. But do not want to get involved any deeper there myself, having no local knowledge. Especially not as long as Bing still shows the old forest too.<br/>
But cannot imagine it has anything to do with the data anyway, must be some server prob.</p></div>
<div class="comment-info" id="comment-52424-info">
<span class="comment-age">(09 Oct '16, 15:18)</span>
<a class="comment-user userinfo" href="/users/12848/wycbtma">wycbtma</a>
</div>
</div>
<a name="52425"></a>
<div class="comment not_top_scorer" id="comment-52425">
<div class="comment-score" id="post-52425-score"></div>
<div class="comment-text"><p>Is this the "way going through the middle of a new lake"? <a href="http://www.openstreetmap.org/?mlat=52.28860&amp;mlon=5.52322#map=17/52.28860/5.52322">http://www.openstreetmap.org/?mlat=52.28860&amp;mlon=5.52322#map=17/52.28860/5.52322</a></p>
<p>I think that's a typical database bug. Something went wrong during the update or the diffs were broken. Now the way remains in the database until someone touches it again or until a complete re-import occurs. Here, touching the way means doing an undelete and then deleting it again. A re-import probably won't happen any time soon since it is very ressource-intensive.</p></div>
<div class="comment-info" id="comment-52425-info">
<span class="comment-age">(09 Oct '16, 15:34)</span>
<a class="comment-user userinfo" href="/users/158/scai">scai ♦</a>
</div>
</div>
<a name="52427"></a>
<div class="comment not_top_scorer" id="comment-52427">
<div class="comment-score" id="post-52427-score"></div>
<div class="comment-text"><p>So... How long will it probably take for the bug to crawl out of the database if things keep going as usual?</p>
<p>Or what options do we have to chase the bug ourselves? I don't mind doing something to get this sorted, if I need what to do.</p></div>
<div class="comment-info" id="comment-52427-info">
<span class="comment-age">(09 Oct '16, 20:29)</span>
<a class="comment-user userinfo" href="/users/11658/_ari">_Ari</a>
</div>
</div>
<a name="52429"></a>
<div class="comment not_top_scorer" id="comment-52429">
<div class="comment-score" id="post-52429-score"></div>
<div class="comment-text"><p>As explained in my previous comment it will stay in the database until the way gets modified again or a re-import occurs.</p>
<p>The way in question seems to be this one: <a href="https://www.openstreetmap.org/way/314866940">https://www.openstreetmap.org/way/314866940</a> Maybe someone can revert and delete it again. I tried to do it a few times but I'm always getting timeouts.</p></div>
<div class="comment-info" id="comment-52429-info">
<span class="comment-age">(09 Oct '16, 21:33)</span>
<a class="comment-user userinfo" href="/users/158/scai">scai ♦</a>
</div>
</div>
<a name="52444"></a>
<div class="comment" id="comment-52444">
<div class="comment-score" id="post-52444-score">1</div>
<div class="comment-text"><p>I've undeleted and re-deleted way 314866940. Rendering seems to be fine now for this way, i.e. it disappeared. You may have to clear your browser cache first. Afterwards I did the same for the forest (way 188676289). Let's see if this is enough.</p></div>
<div class="comment-info" id="comment-52444-info">
<span class="comment-age">(10 Oct '16, 16:20)</span>
<a class="comment-user userinfo" href="/users/158/scai">scai ♦</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-46414">
<span class="comments-showing">
            showing 5 of 9
        </span>
<a class="show-all-comments-link" href="#">show 4 more comments</a>
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-46414-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    One Answer:
                    </div>
<div class="tabsA"><a href="/questions/46414/multipolygon-not-working-as-expected-solved?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/46414/multipolygon-not-working-as-expected-solved?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/46414/multipolygon-not-working-as-expected-solved?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/46414/multipolygon-not-working-as-expected-solved?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="52446"></a>
<div class="answer answered-by-owner" id="answer-container-52446">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/52446/up/" id="post-52446-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-52446-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/52446/down/" id="post-52446-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>The trees are gone, thank you scai! Nice to see that this problem is resolved.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/52446/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>10 Oct '16, 17:10</strong>
</p>
<img alt="_Ari's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/f02efb083fed246097e8c87f5b92be99?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/11658/_ari">_Ari</a><br/>
<span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">●</span><span class="badgecount">3</span></span><br>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="_Ari has no accepted answers">0%</span>
</br></p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/52446/">
                edited
                <strong>10 Oct '16, 17:10</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-52446">
<a name="52448"></a>
<div class="comment" id="comment-52448">
<div class="comment-score" id="post-52448-score"></div>
<div class="comment-text"><p>Yes, but the new forest still doesn't get rendered compared to the other layers. Seems like the whole changeset needs to be reverted and re-applied.</p>
<p>By the way, please use the "add new comment" button if you just want to add a comment instead of an answer (= a solution) to your question.</p></div>
<div class="comment-info" id="comment-52448-info">
<span class="comment-age">(10 Oct '16, 17:18)</span>
<a class="comment-user userinfo" href="/users/158/scai">scai ♦</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-52446">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-52446-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/46414/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="KRGLehCa4euOto1oc2futrcPKAOhzMal"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>