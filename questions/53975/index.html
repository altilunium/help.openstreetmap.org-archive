<meta charset="utf-8"/><link href="../style.css" rel="stylesheet" type="text/css"/><div id="CALeft"><center><a href="../"><img id="ll" src="https://help.openstreetmap.org/upfiles/osm_help_logo_6.png"/></a></center>
<div class="headNormal">
<h1><a href="/questions/53975/get-osm-map-in-r">Get OSM map in R</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/53975/up/" id="post-53975-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-53975-score" title="current number of votes">
    1
</div>
<a class="ajax-command post-vote down" href="/vote/53975/down/" id="post-53975-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/53975/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>Hi, </p>
<p>I am trying to get a map using R and the get_map function.</p>
<p>Location.S &lt;- c(3.5, 57.7, 11, 66)<br/>
Map.South &lt;- get_map(location=Location.S, source="osm", color="bw", crop=TRUE, language="en-EN")<br/>
ggmap(Map.South)</p>
<p>This code worked fine three weeks ago but I now get the following error message:</p>
<p>Error: map grabbing failed - see details in ?get_openstreetmap.
In addition: Warning message:
In download.file(url, destfile = destfile, quiet = !messaging, mode = "wb") :
  cannot open URL 'http://tile.openstreetmap.org/cgi-bin/export?bbox=3.5,57.7,11,66&amp;scale=5000000&amp;format=png': HTTP status was '400 Bad Request'</p>
<p>Any help will be greatly appreciated.</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-get_map" href="/tags/get_map/" rel="tag" title="see questions tagged 'get_map'">get_map</a>
<a class="post-tag tag-link-r" href="/tags/r/" rel="tag" title="see questions tagged 'r'">r</a>
<a class="post-tag tag-link-error" href="/tags/error/" rel="tag" title="see questions tagged 'error'">error</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>11 Jan '17, 11:57</strong>
</p>
<img alt="Pierrick0204's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/684275f0f485a4a473092b1b3de1840f?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/13180/pierrick0204">Pierrick0204</a><br/>
<span class="score" title="26 reputation points">26</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">●</span><span class="badgecount">3</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Pierrick0204 has no accepted answers">0%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-53975">
</div>
<div class="comment-tools" id="comment-tools-53975">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-53975-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    2 Answers:
                    </div>
<div class="tabsA"><a href="/questions/53975/get-osm-map-in-r?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/53975/get-osm-map-in-r?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/53975/get-osm-map-in-r?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/53975/get-osm-map-in-r?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="53979"></a>
<div class="answer" id="answer-container-53979">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/53979/up/" id="post-53979-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-53979-score" title="current number of votes">
    3
</div>
<a class="ajax-command post-vote down" href="/vote/53979/down/" id="post-53979-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>This R function seems to run an CGI export call. I'm surprised that it worked at all. An issue has been filed against the github repo requesting that this call not be used: <a href="https://github.com/dkahle/ggmap/issues/117">https://github.com/dkahle/ggmap/issues/117</a>.</p>
<p>The website export call is heavily rate limited. There are numerous examples of queries on this site relating to this issue. </p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/53979/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>11 Jan '17, 13:38</strong>
</p>
<img alt="SK53's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/06cd84075f1adc2870ad102c7233e661?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/647/sk53">SK53 ♦</a><br/>
<span class="score" title="28084 reputation points"><span class="">28.1k</span></span><span title="48 badges"><span class="badge1">●</span><span class="badgecount">48</span></span><span title="268 badges"><span class="silver">●</span><span class="badgecount">268</span></span><span title="433 badges"><span class="bronze">●</span><span class="badgecount">433</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="SK53 has 121 accepted answers">22%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-53979">
</div>
<div class="comment-tools" id="comment-tools-53979">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-53979-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<a name="53980"></a>
<div class="answer" id="answer-container-53980">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/53980/up/" id="post-53980-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-53980-score" title="current number of votes">
    2
</div>
<a class="ajax-command post-vote down" href="/vote/53980/down/" id="post-53980-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p><code>/cgi-bin/export</code> at openstreetmap.org is not designed for automated requests from scripts! See <a href="https://operations.osmfoundation.org/policies/tiles/">https://operations.osmfoundation.org/policies/tiles/</a> for more details. Quoting this page:</p>
<blockquote>
<p>Calls to /cgi-bin/export may only be
triggered by direct end-user action.
(For example: “click here to export”.)
The export call is an expensive
(CPU+RAM) function to run and will
frequently reject when server is under
high load.</p>
</blockquote>
<p>This means that the <code>get_map()</code> call implementation in R for OSM is broken.</p>
<p>IMHO R should access individual tiles for the specified zoom level instead (without violating the tile usage policy, of course). Afterwards it just has to concatenate these tiles locally. This should be roughly equivalent to a call to <code>/cgi-bin/export</code>.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/53980/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>11 Jan '17, 13:38</strong>
</p>
<img alt="scai's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/52d3234f3be58156770e8a91d575bfbd?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/158/scai">scai ♦</a><br/>
<span class="score" title="33317 reputation points"><span class="">33.3k</span></span><span title="21 badges"><span class="badge1">●</span><span class="badgecount">21</span></span><span title="309 badges"><span class="silver">●</span><span class="badgecount">309</span></span><span title="459 badges"><span class="bronze">●</span><span class="badgecount">459</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="scai has 168 accepted answers">23%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-53980">
<a name="53982"></a>
<div class="comment not_top_scorer" id="comment-53982">
<div class="comment-score" id="post-53982-score"></div>
<div class="comment-text"><p>The call get_openstreetmap() does not semm to work as well. 
Is there any way I can import the OSM from R since I am plotting data linked to geo coordinates?</p></div>
<div class="comment-info" id="comment-53982-info">
<span class="comment-age">(11 Jan '17, 14:00)</span>
<a class="comment-user userinfo" href="/users/13180/pierrick0204">Pierrick0204</a>
</div>
</div>
<a name="53983"></a>
<div class="comment not_top_scorer" id="comment-53983">
<div class="comment-score" id="post-53983-score"></div>
<div class="comment-text"><p>I can't answer this question since I've never worked with OSM in R.</p></div>
<div class="comment-info" id="comment-53983-info">
<span class="comment-age">(11 Jan '17, 14:43)</span>
<a class="comment-user userinfo" href="/users/158/scai">scai ♦</a>
</div>
</div>
<a name="53985"></a>
<div class="comment" id="comment-53985">
<div class="comment-score" id="post-53985-score">1</div>
<div class="comment-text"><p>See the github issue for more on this.</p></div>
<div class="comment-info" id="comment-53985-info">
<span class="comment-age">(11 Jan '17, 17:53)</span>
<a class="comment-user userinfo" href="/users/647/sk53">SK53 ♦</a>
</div>
</div>
<a name="53992"></a>
<div class="comment not_top_scorer" id="comment-53992">
<div class="comment-score" id="post-53992-score"></div>
<div class="comment-text"><p>Hi again. If I understand the recent conversation from this post on Github, there is no way I can plot the same OSM map from R? That's really a pity since I used I for a scientific paper from which I have to update the map figure using the same map background as I previously did. Is there any alternative to get through this?</p></div>
<div class="comment-info" id="comment-53992-info">
<span class="comment-age">(12 Jan '17, 01:33)</span>
<a class="comment-user userinfo" href="/users/13180/pierrick0204">Pierrick0204</a>
</div>
</div>
<a name="53997"></a>
<div class="comment" id="comment-53997">
<div class="comment-score" id="post-53997-score">1</div>
<div class="comment-text"><p>You can try <a href="http://bigmap.osmz.ru/">BigMap 2</a> to generate an image which you can then embed yourself. Keep in mind that this program will also violate the tile usage policy if used excessively. But for your paper it is probably okay.</p></div>
<div class="comment-info" id="comment-53997-info">
<span class="comment-age">(12 Jan '17, 08:19)</span>
<a class="comment-user userinfo" href="/users/158/scai">scai ♦</a>
</div>
</div>
<a name="53998"></a>
<div class="comment not_top_scorer" id="comment-53998">
<div class="comment-score" id="post-53998-score"></div>
<div class="comment-text"><p>Thanks. Will the generated image contain the geographic coordinates? I need this information to plot my data (aquaculture sites) along the Norwegian coast, based on coordinates.</p></div>
<div class="comment-info" id="comment-53998-info">
<span class="comment-age">(12 Jan '17, 08:55)</span>
<a class="comment-user userinfo" href="/users/13180/pierrick0204">Pierrick0204</a>
</div>
</div>
<a name="54000"></a>
<div class="comment" id="comment-54000">
<div class="comment-score" id="post-54000-score">1</div>
<div class="comment-text"><p>No, the image will just be a regular image. The image generated by <code>/cgi-bin/export</code> also doesn't "contain" coordinates. Instead R knows the bounds of the image and can calculate the coordinates.</p></div>
<div class="comment-info" id="comment-54000-info">
<span class="comment-age">(12 Jan '17, 09:58)</span>
<a class="comment-user userinfo" href="/users/158/scai">scai ♦</a>
</div>
</div>
<a name="54002"></a>
<div class="comment" id="comment-54002">
<div class="comment-score" id="post-54002-score">1</div>
<div class="comment-text"><p>An alternative would be to use QGIS, the Composer option &amp; Quick Map Services Plugin to create a map from OSM tiles covering the same area. This gives good control over scale and boundaries. I'm not sure exactly how pulling a map into ggplot works though.</p></div>
<div class="comment-info" id="comment-54002-info">
<span class="comment-age">(12 Jan '17, 13:26)</span>
<a class="comment-user userinfo" href="/users/647/sk53">SK53 ♦</a>
</div>
</div>
<a name="54003"></a>
<div class="comment" id="comment-54003">
<div class="comment-score" id="post-54003-score">1</div>
<div class="comment-text"><p>In the meantime, I just figured out the openstreetmap package on R which seem to do more or less the same.</p></div>
<div class="comment-info" id="comment-54003-info">
<span class="comment-age">(12 Jan '17, 14:42)</span>
<a class="comment-user userinfo" href="/users/13180/pierrick0204">Pierrick0204</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-53980">
<span class="comments-showing">
            showing 5 of 9
        </span>
<a class="show-all-comments-link" href="#">show 4 more comments</a>
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-53980-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/53975/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="cGmNHOe8KOOZ8wapfDOD8Oyzu2gM711R"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>