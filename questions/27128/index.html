<meta charset="utf-8"/><link href="../style.css" rel="stylesheet" type="text/css"/><div id="CALeft"><center><a href="../"><img id="ll" src="https://help.openstreetmap.org/upfiles/osm_help_logo_6.png"/></a></center>
<div class="headNormal">
<h1><a href="/questions/27128/error-precondition-failed-cannot-create-way-data-is-invalid-when-saving-changes-in-potlatch">Error ("Precondition failed: Cannot create way: data is invalid") when saving changes in Potlatch</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/27128/up/" id="post-27128-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-27128-score" title="current number of votes">
    1
</div>
<a class="ajax-command post-vote down" href="/vote/27128/down/" id="post-27128-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/27128/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>I have done some edits in OSM via Potlatch and I've been saving them as usual, but I have found an error when saving the last changeset.</p>
<p>After saving, Potlatch warns: "A server error occurred. Do you want to retry? (The server said: Precondition failed: Cannot create way: data is invalid.)".How can I validate data so I can save it?</p>
<p>I haven't been able to copy the code here, but I've saved the output data in <a href="https://www.dropbox.com/s/4wrpjgoufw26nju/potlacht_error.txt">https://www.dropbox.com/s/4wrpjgoufw26nju/potlacht_error.txt</a></p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-potlatch" href="/tags/potlatch/" rel="tag" title="see questions tagged 'potlatch'">potlatch</a>
<a class="post-tag tag-link-validate" href="/tags/validate/" rel="tag" title="see questions tagged 'validate'">validate</a>
<a class="post-tag tag-link-server" href="/tags/server/" rel="tag" title="see questions tagged 'server'">server</a>
<a class="post-tag tag-link-data" href="/tags/data/" rel="tag" title="see questions tagged 'data'">data</a>
<a class="post-tag tag-link-error" href="/tags/error/" rel="tag" title="see questions tagged 'error'">error</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>13 Oct '13, 18:28</strong>
</p>
<img alt="polkillas's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/bbc25f26d2a78aa7384b13dcd7932854?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/7588/polkillas">polkillas</a><br/>
<span class="score" title="16 reputation points">16</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="bronze">●</span><span class="badgecount">1</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="polkillas has no accepted answers">0%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/27128/">
                edited
                <strong>14 Oct '13, 14:21</strong>
</a>
</p>
<img alt="aseerel4c26's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/66f0dc05b44574e3894be07b0b37cf37?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/5179/aseerel4c26">aseerel4c26 ♦</a><br/>
<span class="score" title="32615 reputation points"><span class="">32.6k</span></span><span title="18 badges"><span class="badge1">●</span><span class="badgecount">18</span></span><span title="248 badges"><span class="silver">●</span><span class="badgecount">248</span></span><span title="554 badges"><span class="bronze">●</span><span class="badgecount">554</span></span></p>
</div>
</div>
<div class="comments-container" id="comments-container-27128">
<a name="27153"></a>
<div class="comment" id="comment-27153">
<div class="comment-score" id="post-27153-score"></div>
<div class="comment-text"><p>Did you use Potlatch version 2 or 1?</p></div>
<div class="comment-info" id="comment-27153-info">
<span class="comment-age">(14 Oct '13, 14:22)</span>
<a class="comment-user userinfo" href="/users/5179/aseerel4c26">aseerel4c26 ♦</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-27128">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-27128-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    One Answer:
                    </div>
<div class="tabsA"><a href="/questions/27128/error-precondition-failed-cannot-create-way-data-is-invalid-when-saving-changes-in-potlatch?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/27128/error-precondition-failed-cannot-create-way-data-is-invalid-when-saving-changes-in-potlatch?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/27128/error-precondition-failed-cannot-create-way-data-is-invalid-when-saving-changes-in-potlatch?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/27128/error-precondition-failed-cannot-create-way-data-is-invalid-when-saving-changes-in-potlatch?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="27131"></a>
<div class="answer" id="answer-container-27131">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/27131/up/" id="post-27131-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-27131-score" title="current number of votes">
    6
</div>
<a class="ajax-command post-vote down" href="/vote/27131/down/" id="post-27131-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>This is a pretty unusual error, although it can occur when your network is not very reliable or at times when the API server is stressed. It is possible to recover your work from the saved file, but it requires a fair bit of technical knowledge. I have done this once, so I'm a bit sketchy on the precise details for achieving a successful upload, so I have worked through your data because I think it is worth knowing how to do this.</p>
<p>Your file is in OSM Change Format (OSC) and can be saved as a valid XML document with a name like XXX.osc or XXX.osc.xml. This format is readable by the offline editor JOSM, although you may need to hand-edit bits of the file to be acceptable for JOSM (for instance by removing the changeset number to a placeholder value. (Search and replace changeset="999" with empty space.</p>
<p>One way is to remove various parts of the file (conflicts and invalid preconditions can only occur on pre-existing objects, so removing delete and modify statements may help). Basically using a divide and conquer strategy means that one can recover parts of your changes separately: even if you cannot recover them all you may get the bulk of them.</p>
<p>Once loaded into JOSM select File|Update Data. JOSM will update all objects in your file from the API database: it will probably report conflicts (in your case 25). Use the JOSM Conflict editor to resolve these conflicts &amp; then upload your data. </p>
<p>Select each item shown in the conflict pane. Click "Resolve Conflict", each part of the object with a conflict is shown in a tab with a red button. On each (tags, nodes, members, etc.) click the button on the left which selects your version (not the server version) and then the "Apply Resolution" button. Do this until all conflicts are resolved.</p>
<p>I have done this with your file (I needed to step through to see what needed to be done), and I have made minor corrections to your Olive Trees (natural=tree and species=Olea europea).</p>
<p>Potlatch seems to have created an empty way (a way with 0 nodes) which was causing the problem.</p>
<pre><code>&lt;way id="-41" version="0" changeset="18336367"&gt;
  &lt;tag k="species" v="olea europaea"/&gt;
  &lt;tag k="nature" v="tree"/&gt;
&lt;/way&gt;
</code></pre>
<p>I have uploaded your data (changeset <a href="http://www.openstreetmap.org/browse/changeset/18340844">http://www.openstreetmap.org/browse/changeset/18340844</a>), please check that it as you expect.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/27131/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>13 Oct '13, 22:24</strong>
</p>
<img alt="SK53's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/06cd84075f1adc2870ad102c7233e661?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/647/sk53">SK53 ♦</a><br/>
<span class="score" title="28084 reputation points"><span class="">28.1k</span></span><span title="48 badges"><span class="badge1">●</span><span class="badgecount">48</span></span><span title="268 badges"><span class="silver">●</span><span class="badgecount">268</span></span><span title="433 badges"><span class="bronze">●</span><span class="badgecount">433</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="SK53 has 121 accepted answers">22%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/27131/">
                edited
                <strong>13 Oct '13, 22:25</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-27131">
</div>
<div class="comment-tools" id="comment-tools-27131">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-27131-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/27128/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="DHP7SSADI4HPQVNk8wsFETWI4Srs5heO"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>