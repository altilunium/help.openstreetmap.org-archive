<meta charset="utf-8"/><link href="../style.css" rel="stylesheet" type="text/css"/><div id="CALeft"><center><a href="../"><img id="ll" src="https://help.openstreetmap.org/upfiles/osm_help_logo_6.png"/></a></center>
<div class="headNormal">
<h1><a href="/questions/4234/mapnik-with-british-coordinates">Mapnik with British Coordinates</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/4234/up/" id="post-4234-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-4234-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/4234/down/" id="post-4234-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/4234/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>I am trying to create a slippy map of the area of Wrexham, but using the British Coordinate System (by following <a href="http://wiki.openstreetmap.org/wiki/Mapnik_GB_Projection">http://wiki.openstreetmap.org/wiki/Mapnik_GB_Projection</a>)</p>
<p>I can produce the maps in the standard spherical projection, using osm2psql to upload the vectors in a box (-b -3.4,52.85,-2.7,53.15) to PostgreSQL, and create the tiles defining the same box in generate_tiles.py.</p>
<p>I then change the coordinate system in PostgreSQL with PostGIS extension using the command <code>sudo osm2pgsql -v -H localhost -P 5433 -U gisuser -W -C 4096 -b -3.4,52.85,-2.7,53.15 -S /home/m/bin/welsh.style united_kingdom.osm.bz2</code></p>
<p>Checking the data in Qgis shows everything looks fine and the coordinates are what would be expected.
For mapnik, I have changed the srs attribute in osm.xml to <code>+proj=tmerc +lat_0=49 +lon_0=-2 +k=0.999601 +x_0=400000 +y_0=-100000 +ellps=airy  +units=m +towgs84=446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894 +units=m +nodefs</code></p>
<p>In generate_tiles.py what coordinate system should bbox be in? Both bbox = (300000,300000,335449,351718) and bbox = (-2.0,52.043,-0.896,54.047) just give me blank tiles.</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-coordinate" href="/tags/coordinate/" rel="tag" title="see questions tagged 'coordinate'">coordinate</a>
<a class="post-tag tag-link-mapnik" href="/tags/mapnik/" rel="tag" title="see questions tagged 'mapnik'">mapnik</a>
<a class="post-tag tag-link-british" href="/tags/british/" rel="tag" title="see questions tagged 'british'">british</a>
<a class="post-tag tag-link-system" href="/tags/system/" rel="tag" title="see questions tagged 'system'">system</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>31 Mar '11, 20:27</strong>
</p>
<img alt="pingu512's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/a13d9b2e07a0c07e8c32aed60f4e5886?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/1115/pingu512">pingu512</a><br/>
<span class="score" title="1 reputation points">1</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="bronze">●</span><span class="badgecount">1</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="pingu512 has no accepted answers">0%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/4234/">
                edited
                <strong>31 Mar '11, 23:56</strong>
</a>
</p>
<img alt="Harry%20Wood's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/9e04333be840d50c6aa66fb112aad77c?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/107/harry-wood">Harry Wood</a><br/>
<span class="score" title="9489 reputation points"><span class="">9.5k</span></span><span title="25 badges"><span class="badge1">●</span><span class="badgecount">25</span></span><span title="88 badges"><span class="silver">●</span><span class="badgecount">88</span></span><span title="128 badges"><span class="bronze">●</span><span class="badgecount">128</span></span></p>
</div>
</div>
<div class="comments-container" id="comments-container-4234">
</div>
<div class="comment-tools" id="comment-tools-4234">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-4234-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    One Answer:
                    </div>
<div class="tabsA"><a href="/questions/4234/mapnik-with-british-coordinates?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/4234/mapnik-with-british-coordinates?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/4234/mapnik-with-british-coordinates?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/4234/mapnik-with-british-coordinates?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="53883"></a>
<div class="answer" id="answer-container-53883">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/53883/up/" id="post-53883-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-53883-score" title="current number of votes">
    1
</div>
<a class="ajax-command post-vote down" href="/vote/53883/down/" id="post-53883-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>This question is pretty ancient, but I'm hoping the answer might be useful to someone!</p>
<p>You might want to try using my Python script <a href="https://github.com/gregrs-uk/gb-leisure-carto/blob/master/print-osgb.py">print-osgb.py</a>, which I wrote for this purpose. You set various options at the top of the Python file rather than providing arguments when running the script.</p>
<p>IIRC, the data in PostGIS can be in whatever projection you like as long as this is reflected in the section of the Mapnik XML file that defines the data source. However, the srs at the top of the XML file should reflect the OSGB projection. I normally just use <code>srs="+init=epsg:27700"</code> for this.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/53883/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>05 Jan '17, 20:17</strong>
</p>
<img alt="Greg's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/96c2522da1dee70df309c3bf9d279ef0?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/2955/greg">Greg</a><br/>
<span class="score" title="141 reputation points">141</span><span title="2 badges"><span class="badge1">●</span><span class="badgecount">2</span></span><span title="3 badges"><span class="silver">●</span><span class="badgecount">3</span></span><span title="8 badges"><span class="bronze">●</span><span class="badgecount">8</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Greg has one accepted answer">50%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-53883">
</div>
<div class="comment-tools" id="comment-tools-53883">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-53883-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/4234/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="DSHGi0LKHpUSes1naGfYKQ3a441F4kI5"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>