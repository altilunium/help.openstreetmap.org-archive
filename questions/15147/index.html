<meta charset="utf-8"/><link href="../style.css" rel="stylesheet" type="text/css"/><div id="CALeft"><center><a href="../"><img id="ll" src="https://help.openstreetmap.org/upfiles/osm_help_logo_6.png"/></a></center>
<div class="headNormal">
<h1><a href="/questions/15147/osm-api-06-upload-gpx-track">osm api 0.6 upload GPX track</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/15147/up/" id="post-15147-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-15147-score" title="current number of votes">
    1
</div>
<a class="ajax-command post-vote down" href="/vote/15147/down/" id="post-15147-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/15147/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>Hello guys,</p>
<p>I quite fighting with OSM API v0.6 and upload GPX track task. I'm developing application for Android and trying to use <a href="http://wiki.openstreetmap.org/wiki/Api06#Uploading_Traces">this</a> method. Firstly I though it should be a problem of login, so I changed login mechanism to OAuth. Anyway same result now.</p>
<p>After selecting track and settings all parameters (description ('test'), tags ('test'), visibility ('public')), uploading always return <strong>400 Bad Request</strong>, no content, no error message</p>
<pre><code>---------- REQUEST -----------
org.apache.http.client.methods.HttpPost@427e06f8, url: <a href="http://api.openstreetmap.org/api/0.6/gpx/create">http://api.openstreetmap.org/api/0.6/gpx/create</a>
headers: Content-Type: multipart/form-data
headers: Accept-Charset: ISO-8859-2, utf-8
headers: Accept-Encoding: gzip,deflate
headers: User-Agent: Locus/2.5.6 (Linux; U; Android; en-us)
HttpPost entity:com.google.android.common.http.MultipartEntity@427e0d98

---------- RESPONSE -----------
statusLine:HTTP/1.1 400 Bad Request
headers:Date, Thu, 16 Aug 2012 13:34:33 GMT
headers:Server, Apache/2.2.22 (Ubuntu)
headers:X-Powered-By, Phusion Passenger (mod_rails/mod_rack) 3.0.14
headers:Vary, Accept-Language,Accept-Encoding
headers:Content-Language, en
headers:Cache-Control, no-cache
headers:X-Request-Id, 0bbf0e2fd3e78e4f855718f7e53dbef5
headers:X-Runtime, 0.366059
headers:X-UA-Compatible, IE=Edge,chrome=1
headers:Status, 400
headers:Content-Encoding, gzip
headers:Content-Length, 21
headers:Connection, close
headers:Content-Type, text/html; charset=utf-8
</code></pre>
<p>exactly same track uploaded by web site works. Have someone any idea or any method how to test what is problem on OSM server? Thank you!</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-api" href="/tags/api/" rel="tag" title="see questions tagged 'api'">api</a>
<a class="post-tag tag-link-gpx" href="/tags/gpx/" rel="tag" title="see questions tagged 'gpx'">gpx</a>
<a class="post-tag tag-link-upload" href="/tags/upload/" rel="tag" title="see questions tagged 'upload'">upload</a>
<a class="post-tag tag-link-locus" href="/tags/locus/" rel="tag" title="see questions tagged 'locus'">locus</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>16 Aug '12, 14:57</strong>
</p>
<img alt="menion's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/d2aebf074a0667a95d09bf5c48baa12e?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/2306/menion">menion</a><br/>
<span class="score" title="88 reputation points">88</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="menion has no accepted answers">0%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-15147">
<a name="15148"></a>
<div class="comment" id="comment-15148">
<div class="comment-score" id="post-15148-score">1</div>
<div class="comment-text"><p>You should not use api.osm.org for testing and development. There is an instance of the api on a different database for that at api06.dev.openstreetmap.org</p></div>
<div class="comment-info" id="comment-15148-info">
<span class="comment-age">(16 Aug '12, 15:12)</span>
<a class="comment-user userinfo" href="/users/131/gnonthgol">Gnonthgol ♦</a>
</div>
</div>
<a name="15151"></a>
<div class="comment" id="comment-15151">
<div class="comment-score" id="post-15151-score"></div>
<div class="comment-text"><p>I know. I was testing upload on api06.dev ... but it also not worked. So I tried direct upload by web site also on this api06.dev... where it also not work!! compare to normal api.open ... where upload of same file works without problem (upload deleted, don't worry)</p>
<p>anyway same result on both sites</p></div>
<div class="comment-info" id="comment-15151-info">
<span class="comment-age">(16 Aug '12, 15:29)</span>
<a class="comment-user userinfo" href="/users/2306/menion">menion</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-15147">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-15147-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    2 Answers:
                    </div>
<div class="tabsA"><a href="/questions/15147/osm-api-06-upload-gpx-track?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/15147/osm-api-06-upload-gpx-track?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/15147/osm-api-06-upload-gpx-track?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/15147/osm-api-06-upload-gpx-track?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="15171"></a>
<div class="answer answered-by-owner" id="answer-container-15171">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/15171/up/" id="post-15171-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-15171-score" title="current number of votes">
    2
</div>
<a class="ajax-command post-vote down" href="/vote/15171/down/" id="post-15171-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>after another fight-time, problem fixed - so just if anyone have same problem:</p>
<p>seems like OSM server cannot correctly handle <strong>com.google.android.common.http.MultipartEntity</strong> object. Solution is to use Apache <a href="http://hc.apache.org/downloads.cgi">HttpComponents</a> library and it's own implementation of <strong>MultipartEntity</strong> object. With this is no problem with posting GPX tracks</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/15171/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>16 Aug '12, 20:41</strong>
</p>
<img alt="menion's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/d2aebf074a0667a95d09bf5c48baa12e?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/2306/menion">menion</a><br/>
<span class="score" title="88 reputation points">88</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="menion has no accepted answers">0%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-15171">
<a name="37924"></a>
<div class="comment" id="comment-37924">
<div class="comment-score" id="post-37924-score"></div>
<div class="comment-text"><p>Hey, i am facing a similar problem with C# could you please explain your solution in detail.</p>
<p>Regards</p></div>
<div class="comment-info" id="comment-37924-info">
<span class="comment-age">(24 Oct '14, 14:03)</span>
<a class="comment-user userinfo" href="/users/9036/osm_enthu">Osm_Enthu</a>
</div>
</div>
<a name="37925"></a>
<div class="comment" id="comment-37925">
<div class="comment-score" id="post-37925-score">1</div>
<div class="comment-text"><p>Hello Enthu,</p>
<p>I'm worried, I can't help here more. Exact reason, why one solution work and second don't is not known to me. My solution was simply - I've changed library I used for different kind. So I can only suggest this to you. If you use any library for sending MutliPart objects over HTTP, then try different library.</p></div>
<div class="comment-info" id="comment-37925-info">
<span class="comment-age">(24 Oct '14, 14:25)</span>
<a class="comment-user userinfo" href="/users/2306/menion">menion</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-15171">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-15171-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<a name="38002"></a>
<div class="answer" id="answer-container-38002">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/38002/up/" id="post-38002-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-38002-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/38002/down/" id="post-38002-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>Thats for all of those who came stumbling here</p>
<p><a href="http://www.briangrinstead.com/blog/multipart-form-post-in-c">http://www.briangrinstead.com/blog/multipart-form-post-in-c</a></p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/38002/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>27 Oct '14, 13:56</strong>
</p>
<img alt="Osm_Enthu's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/0be8b0bc55610645ad634cb9f680c48f?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/9036/osm_enthu">Osm_Enthu</a><br/>
<span class="score" title="56 reputation points">56</span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="3 badges"><span class="silver">●</span><span class="badgecount">3</span></span><span title="7 badges"><span class="bronze">●</span><span class="badgecount">7</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Osm_Enthu has no accepted answers">0%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-38002">
</div>
<div class="comment-tools" id="comment-tools-38002">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-38002-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/15147/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="jfAVo9xsbkaXfcCOzz8RpgMXNVD5i9ko"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>