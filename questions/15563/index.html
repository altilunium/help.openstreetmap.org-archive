<meta charset="utf-8"/><link href="../style.css" rel="stylesheet" type="text/css"/><div id="CALeft"><center><a href="../"><img id="ll" src="https://help.openstreetmap.org/upfiles/osm_help_logo_6.png"/></a></center>
<div class="headNormal">
<h1><a href="/questions/15563/nominatim-install-problem-final-step-php">Nominatim Install Problem, Final Step. PHP?</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/15563/up/" id="post-15563-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-15563-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/15563/down/" id="post-15563-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/15563/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>After completing the nominatim install, and map importing. we try to connect to the php site and recieve this error. the apache user has rwx on the nominatim folder, etc. cannot figure this out. even renamed postgres user www-data to apache. any thoughts? i can try to go into more detail if necessary.</p>
<pre><code>string(19) "pgsql://@/nominatim" object(DB_Error)#2 (8) { ["error_message_prefix"]=&gt; string(0) "" ["mode"]=&gt; int(1) ["level"]=&gt; int(1024) ["code"]=&gt; int(-24) ["message"]=&gt; string(24) "DB Error: connect failed" ["userinfo"]=&gt; string(239) " [nativecode=pg_connect(): Unable to connect to PostgreSQL server: could not connect to server: Permission denied Is the server running locally and accepting connections on Unix domain socket "/tmp/.s.PGSQL.5432"?] ** pgsql://@/nominatim" ["backtrace"]=&gt; array(7) { [0]=&gt; array(6) { ["file"]=&gt; string(22) "/usr/share/pear/DB.php" ["line"]=&gt; int(966) ["function"]=&gt; string(10) "PEAR_Error" ["class"]=&gt; string(10) "PEAR_Error" ["type"]=&gt; string(2) "-&gt;" ["args"]=&gt; array(5) { [0]=&gt; string(24) "DB Error: connect failed" [1]=&gt; int(-24) [2]=&gt; int(1) [3]=&gt; int(1024) [4]=&gt; string(216) " [nativecode=pg_connect(): Unable to connect to PostgreSQL server: could not connect to server: Permission denied Is the server running locally and accepting connections on Unix domain socket "/tmp/.s.PGSQL.5432"?]" } } [1]=&gt; array(7) { ["file"]=&gt; string(24) "/usr/share/pear/PEAR.php" ["line"]=&gt; int(531) ["function"]=&gt; string(8) "DB_Error" ["class"]=&gt; string(8) "DB_Error" ["object"]=&gt; *RECURSION* ["type"]=&gt; string(2) "-&gt;" ["args"]=&gt; array(4) { [0]=&gt; int(-24) [1]=&gt; int(1) [2]=&gt; int(1024) [3]=&gt; string(216) " [nativecode=pg_connect(): Unable to connect to PostgreSQL server: could not connect to server: Permission denied Is the server running locally and accepting connections on Unix domain socket "/tmp/.s.PGSQL.5432"?]" } } [2]=&gt; array(7) { ["file"]=&gt; string(29) "/usr/share/pear/DB/common.php" ["line"]=&gt; int(1903) ["function"]=&gt; string(10) "raiseError" ["class"]=&gt; string(4) "PEAR" ["object"]=&gt; object(DB_pgsql)#1 (28) { ["phptype"]=&gt; string(5) "pgsql" ["dbsyntax"]=&gt; string(5) "pgsql" ["features"]=&gt; array(7) { ["limit"]=&gt; string(5) "alter" ["new_link"]=&gt; string(5) "4.3.0" ["numrows"]=&gt; bool(true) ["pconnect"]=&gt; bool(true) ["prepare"]=&gt; bool(false) ["ssl"]=&gt; bool(true) ["transactions"]=&gt; bool(true) } ["errorcode_map"]=&gt; array(0) { } ["connection"]=&gt; bool(false) ["dsn"]=&gt; array(9) { ["phptype"]=&gt; string(5) "pgsql" ["dbsyntax"]=&gt; string(5) "pgsql" ["username"]=&gt; string(0) "" ["password"]=&gt; bool(false) ["protocol"]=&gt; string(3) "tcp" ["hostspec"]=&gt; string(0) "" ["port"]=&gt; bool(false) ["socket"]=&gt; bool(false) ["database"]=&gt; string(9) "nominatim" } ["autocommit"]=&gt; bool(true) ["transaction_opcount"]=&gt; int(0) ["affected"]=&gt; int(0) ["row"]=&gt; array(0) { } ["_num_rows"]=&gt; array(0) { } ["fetchmode"]=&gt; int(1) ["fetchmode_object_class"]=&gt; string(8) "stdClass" ["was_connected"]=&gt; NULL ["last_query"]=&gt; string(0) "" ["options"]=&gt; array(8) { ["result_buffering"]=&gt; int(500) ["persistent"]=&gt; bool(false) ["ssl"]=&gt; bool(false) ["debug"]=&gt; int(0) ["seqname_format"]=&gt; string(6) "%s_seq" ["autofree"]=&gt; bool(false) ["portability"]=&gt; int(0) ["optimize"]=&gt; string(11) "performance" } ["last_parameters"]=&gt; array(0) { } ["prepare_tokens"]=&gt; array(0) { } ["prepare_types"]=&gt; array(0) { } ["prepared_queries"]=&gt; array(0) { } ["_last_query_manip"]=&gt; bool(false) ["_next_query_manip"]=&gt; bool(false) ["_debug"]=&gt; bool(false) ["_default_error_mode"]=&gt; NULL ["_default_error_options"]=&gt; NULL ["_default_error_handler"]=&gt; string(0) "" ["_error_class"]=&gt; string(8) "DB_Error" ["_expected_errors"]=&gt; array(0) { } } ["type"]=&gt; string(2) "-&gt;" ["args"]=&gt; array(7) { [0]=&gt; NULL [1]=&gt; int(-24) [2]=&gt; NULL [3]=&gt; NULL [4]=&gt; string(216) " [nativecode=pg_connect(): Unable to connect to PostgreSQL server: could not connect to server: Permission denied Is the server running locally and accepting connections on Unix domain socket "/tmp/.s.PGSQL.5432"?]" [5]=&gt; string(8) "DB_Error" [6]=&gt; bool(true) } } [3]=&gt; array(7) { ["file"]=&gt; string(28) "/usr/share/pear/DB/pgsql.php" ["line"]=&gt; int(289) ["function"]=&gt; string(10) "raiseError" ["class"]=&gt; string(9) "DB_common" ["object"]=&gt; object(DB_pgsql)#1 (28) { ["phptype"]=&gt; string(5) "pgsql" ["dbsyntax"]=&gt; string(5) "pgsql" ["features"]=&gt; array(7) { ["limit"]=&gt; string(5) "alter" ["new_link"]=&gt; string(5) "4.3.0" ["numrows"]=&gt; bool(true) ["pconnect"]=&gt; bool(true) ["prepare"]=&gt; bool(false) ["ssl"]=&gt; bool(true) ["transactions"]=&gt; bool(true) } ["errorcode_map"]=&gt; array(0) { } ["connection"]=&gt; bool(false) ["dsn"]=&gt; array(9) { ["phptype"]=&gt; string(5) "pgsql" ["dbsyntax"]=&gt; string(5) "pgsql" ["username"]=&gt; string(0) "" ["password"]=&gt; bool(false) ["protocol"]=&gt; string(3) "tcp" ["hostspec"]=&gt; string(0) "" ["port"]=&gt; bool(false) ["socket"]=&gt; bool(false) ["database"]=&gt; string(9) "nominatim" } ["autocommit"]=&gt; bool(true) ["transaction_opcount"]=&gt; int(0) ["affected"]=&gt; int(0) ["row"]=&gt; array(0) { } ["_num_rows"]=&gt; array(0) { } ["fetchmode"]=&gt; int(1) ["fetchmode_object_class"]=&gt; string(8) "stdClass" ["was_connected"]=&gt; NULL ["last_query"]=&gt; string(0) "" ["options"]=&gt; array(8) { ["result_buffering"]=&gt; int(500) ["persistent"]=&gt; bool(false) ["ssl"]=&gt; bool(false) ["debug"]=&gt; int(0) ["seqname_format"]=&gt; string(6) "%s_seq" ["autofree"]=&gt; bool(false) ["portability"]=&gt; int(0) ["optimize"]=&gt; string(11) "performance" } ["last_parameters"]=&gt; array(0) { } ["prepare_tokens"]=&gt; array(0) { } ["prepare_types"]=&gt; array(0) { } ["prepared_queries"]=&gt; array(0) { } ["_last_query_manip"]=&gt; bool(false) ["_next_query_manip"]=&gt; bool(false) ["_debug"]=&gt; bool(false) ["_default_error_mode"]=&gt; NULL ["_default_error_options"]=&gt; NULL ["_default_error_handler"]=&gt; string(0) "" ["_error_class"]=&gt; string(8) "DB_Error" ["_expected_errors"]=&gt; array(0) { } } ["type"]=&gt; string(2) "-&gt;" ["args"]=&gt; array(5) { [0]=&gt; int(-24) [1]=&gt; NULL [2]=&gt; NULL [3]=&gt; NULL [4]=&gt; string(202) "pg_connect(): Unable to connect to PostgreSQL server: could not connect to server: Permission denied Is the server running locally and accepting connections on Unix domain socket "/tmp/.s.PGSQL.5432"?" } } [4]=&gt; array(7) { ["file"]=&gt; string(22) "/usr/share/pear/DB.php" ["line"]=&gt; int(556) ["function"]=&gt; string(7) "connect" ["class"]=&gt; string(8) "DB_pgsql" ["object"]=&gt; object(DB_pgsql)#1 (28) { ["phptype"]=&gt; string(5) "pgsql" ["dbsyntax"]=&gt; string(5) "pgsql" ["features"]=&gt; array(7) { ["limit"]=&gt; string(5) "alter" ["new_link"]=&gt; string(5) "4.3.0" ["numrows"]=&gt; bool(true) ["pconnect"]=&gt; bool(true) ["prepare"]=&gt; bool(false) ["ssl"]=&gt; bool(true) ["transactions"]=&gt; bool(true) } ["errorcode_map"]=&gt; array(0) { } ["connection"]=&gt; bool(false) ["dsn"]=&gt; array(9) { ["phptype"]=&gt; string(5) "pgsql" ["dbsyntax"]=&gt; string(5) "pgsql" ["username"]=&gt; string(0) "" ["password"]=&gt; bool(false) ["protocol"]=&gt; string(3) "tcp" ["hostspec"]=&gt; string(0) "" ["port"]=&gt; bool(false) ["socket"]=&gt; bool(false) ["database"]=&gt; string(9) "nominatim" } ["autocommit"]=&gt; bool(true) ["transaction_opcount"]=&gt; int(0) ["affected"]=&gt; int(0) ["row"]=&gt; array(0) { } ["_num_rows"]=&gt; array(0) { } ["fetchmode"]=&gt; int(1) ["fetchmode_object_class"]=&gt; string(8) "stdClass" ["was_connected"]=&gt; NULL ["last_query"]=&gt; string(0) "" ["options"]=&gt; array(8) { ["result_buffering"]=&gt; int(500) ["persistent"]=&gt; bool(false) ["ssl"]=&gt; bool(false) ["debug"]=&gt; int(0) ["seqname_format"]=&gt; string(6) "%s_seq" ["autofree"]=&gt; bool(false) ["portability"]=&gt; int(0) ["optimize"]=&gt; string(11) "performance" } ["last_parameters"]=&gt; array(0) { } ["prepare_tokens"]=&gt; array(0) { } ["prepare_types"]=&gt; array(0) { } ["prepared_queries"]=&gt; array(0) { } ["_last_query_manip"]=&gt; bool(false) ["_next_query_manip"]=&gt; bool(false) ["_debug"]=&gt; bool(false) ["_default_error_mode"]=&gt; NULL ["_default_error_options"]=&gt; NULL ["_default_error_handler"]=&gt; string(0) "" ["_error_class"]=&gt; string(8) "DB_Error" ["_expected_errors"]=&gt; array(0) { } } ["type"]=&gt; string(2) "-&gt;" ["args"]=&gt; array(2) { [0]=&gt; array(9) { ["phptype"]=&gt; string(5) "pgsql" ["dbsyntax"]=&gt; string(5) "pgsql" ["username"]=&gt; string(0) "" ["password"]=&gt; bool(false) ["protocol"]=&gt; string(3) "tcp" ["hostspec"]=&gt; string(0) "" ["port"]=&gt; bool(false) ["socket"]=&gt; bool(false) ["database"]=&gt; string(9) "nominatim" } [1]=&gt; bool(false) } } [5]=&gt; array(6) { ["file"]=&gt; string(29) "/website/Nominatim/lib/db.php" ["line"]=&gt; int(7) ["function"]=&gt; string(7) "connect" ["class"]=&gt; string(2) "DB" ["type"]=&gt; string(2) "::" ["args"]=&gt; array(2) { [0]=&gt; string(19) "pgsql://@/nominatim" [1]=&gt; bool(false) } } [6]=&gt; array(4) { ["file"]=&gt; string(37) "/website/Nominatim/website/search.php" ["line"]=&gt; int(6) ["function"]=&gt; string(5) "getDB" ["args"]=&gt; array(0) { } } } ["callback"]=&gt; NULL } DB Error: connect failed
</code></pre>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-postgresql" href="/tags/postgresql/" rel="tag" title="see questions tagged 'postgresql'">postgresql</a>
<a class="post-tag tag-link-nominatim" href="/tags/nominatim/" rel="tag" title="see questions tagged 'nominatim'">nominatim</a>
<a class="post-tag tag-link-installation" href="/tags/installation/" rel="tag" title="see questions tagged 'installation'">installation</a>
<a class="post-tag tag-link-install" href="/tags/install/" rel="tag" title="see questions tagged 'install'">install</a>
<a class="post-tag tag-link-php" href="/tags/php/" rel="tag" title="see questions tagged 'php'">php</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>27 Aug '12, 18:32</strong>
</p>
<img alt="mmelo's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/f606a0be81931b140017947c63373bba?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/4381/mmelo">mmelo</a><br/>
<span class="score" title="31 reputation points">31</span><span title="2 badges"><span class="badge1">●</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">●</span><span class="badgecount">2</span></span><span title="3 badges"><span class="bronze">●</span><span class="badgecount">3</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="mmelo has no accepted answers">0%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/15563/">
                edited
                <strong>28 Aug '12, 06:13</strong>
</a>
</p>
<img alt="scai's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/52d3234f3be58156770e8a91d575bfbd?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/158/scai">scai ♦</a><br/>
<span class="score" title="33317 reputation points"><span class="">33.3k</span></span><span title="21 badges"><span class="badge1">●</span><span class="badgecount">21</span></span><span title="309 badges"><span class="silver">●</span><span class="badgecount">309</span></span><span title="459 badges"><span class="bronze">●</span><span class="badgecount">459</span></span></p>
</div>
</div>
<div class="comments-container" id="comments-container-15563">
</div>
<div class="comment-tools" id="comment-tools-15563">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-15563-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    One Answer:
                    </div>
<div class="tabsA"><a href="/questions/15563/nominatim-install-problem-final-step-php?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/15563/nominatim-install-problem-final-step-php?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/15563/nominatim-install-problem-final-step-php?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/15563/nominatim-install-problem-final-step-php?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="15593"></a>
<div class="answer" id="answer-container-15593">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/15593/up/" id="post-15593-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-15593-score" title="current number of votes">
    2
</div>
<a class="ajax-command post-vote down" href="/vote/15593/down/" id="post-15593-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>As the error message states, your apache does not have permission to access the socket file <code>/tmp/.s.PGSQL.5432</code> of your postgres server. Check that everybody has permission to read and write to this file. If not, change the settings for <code>unix_socket_permissions</code> in your psql config. Don't forget to check permissions for the directory as well.</p>
<p>Also check that your postgres is indeed using this socket (look for <code>unix_socket_directory</code> in your psql config) and running on port 5432 (see <code>port</code> in config). If it doesn't match something is wrong with your psql or php installation.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/15593/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>28 Aug '12, 20:07</strong>
</p>
<img alt="lonvia's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/d888b712d85dee0aa304297f2dc697c7?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/2921/lonvia">lonvia</a><br/>
<span class="score" title="6213 reputation points"><span class="">6.2k</span></span><span title="2 badges"><span class="badge1">●</span><span class="badgecount">2</span></span><span title="57 badges"><span class="silver">●</span><span class="badgecount">57</span></span><span title="89 badges"><span class="bronze">●</span><span class="badgecount">89</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="lonvia has 43 accepted answers">40%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-15593">
<a name="15982"></a>
<div class="comment" id="comment-15982">
<div class="comment-score" id="post-15982-score">1</div>
<div class="comment-text"><p>i figured it out, needed to disable selinux or open the 5432 port with semanage. thanks for pointing me in the right direction</p></div>
<div class="comment-info" id="comment-15982-info">
<span class="comment-age">(11 Sep '12, 21:44)</span>
<a class="comment-user userinfo" href="/users/4381/mmelo">mmelo</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-15593">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-15593-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/15563/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="VKsab3AwMFI3We11bE6UOYHAOFRpiT4D"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>