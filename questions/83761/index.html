<meta charset="utf-8"/><link href="../style.css" rel="stylesheet" type="text/css"/><div id="CALeft"><center><a href="../"><img id="ll" src="https://help.openstreetmap.org/upfiles/osm_help_logo_6.png"/></a></center>
<div class="headNormal">
<h1><a href="/questions/83761/add-a-custom-place-to-nominatim-database">Add a custom place to Nominatim database</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/83761/up/" id="post-83761-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-83761-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/83761/down/" id="post-83761-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/83761/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>I have set up my local Nominatim instance using the mediagis/nominatim:4.0 Docker image and so far so good, it works like a charm.
Now, I would like to know if it is possible to add some custom place to the Nominatim database and have them considered in search, lookup, etc.
By digging a bit into the Nominatim documentation and source code, it seems to me that it should be possible by adding a custom row to the placex table with indexed_status != 0.
It looks like there is also the possibility of using "osm_type = X" for e"X"ternal sources.
So I ask: will just adding a row to the placex table trigger everything is needed to have that custom place considered in the various Nominatim functionalities? And, in case, what are the columns to be filled for that to work?
Thanks</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-nominatim" href="/tags/nominatim/" rel="tag" title="see questions tagged 'nominatim'">nominatim</a>
<a class="post-tag tag-link-custom" href="/tags/custom/" rel="tag" title="see questions tagged 'custom'">custom</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>09 Mar '22, 10:36</strong>
</p>
<img alt="todelo's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/7f376eb35f20c1f021067ede20bd4e6b?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/21498/todelo">todelo</a><br/>
<span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">●</span><span class="badgecount">3</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="todelo has no accepted answers">0%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-83761">
</div>
<div class="comment-tools" id="comment-tools-83761">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-83761-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    6 Answers:
                    </div>
<div class="tabsA"><a href="/questions/83761/add-a-custom-place-to-nominatim-database?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/83761/add-a-custom-place-to-nominatim-database?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/83761/add-a-custom-place-to-nominatim-database?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/83761/add-a-custom-place-to-nominatim-database?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="83778"></a>
<div class="answer" id="answer-container-83778">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/83778/up/" id="post-83778-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-83778-score" title="current number of votes">
    3
</div>
<a class="ajax-command post-vote down" href="/vote/83778/down/" id="post-83778-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>The e"X"ternal data feature is a piece of very old unmaintained code that likely won't really do what you want. Most importantly, it won't add your data to the search tables, so you can't really find it.</p>
<p>The easiest way to add custom data to Nominatim is to convert your data into OSM format and then add it with <code>nominatim add-data --file &lt;custom.xml&gt;</code> followed by an indexing <code>nominatim index</code>. Make sure to use OSM IDs that are not yet in the database. This way you can be sure that address computation and building of the search index are handled just as for any other data.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/83778/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>10 Mar '22, 07:51</strong>
</p>
<img alt="lonvia's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/d888b712d85dee0aa304297f2dc697c7?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/2921/lonvia">lonvia</a><br/>
<span class="score" title="6213 reputation points"><span class="">6.2k</span></span><span title="2 badges"><span class="badge1">●</span><span class="badgecount">2</span></span><span title="57 badges"><span class="silver">●</span><span class="badgecount">57</span></span><span title="89 badges"><span class="bronze">●</span><span class="badgecount">89</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="lonvia has 43 accepted answers">40%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-83778">
<a name="83781"></a>
<div class="comment" id="comment-83781">
<div class="comment-score" id="post-83781-score"></div>
<div class="comment-text"><p>Then Nominatim interprets it as an update and replaces your data.</p></div>
<div class="comment-info" id="comment-83781-info">
<span class="comment-age">(10 Mar '22, 09:08)</span>
<a class="comment-user userinfo" href="/users/2921/lonvia">lonvia</a>
</div>
</div>
<a name="83782"></a>
<div class="comment" id="comment-83782">
<div class="comment-score" id="post-83782-score"></div>
<div class="comment-text"><p>Indeed. Is there a way to prevent this? Is a meaningful OSM_ID really needed for search and lookup?</p></div>
<div class="comment-info" id="comment-83782-info">
<span class="comment-age">(10 Mar '22, 09:18)</span>
<a class="comment-user userinfo" href="/users/21498/todelo">todelo</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-83778">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-83778-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<a name="83780"></a>
<div class="answer answered-by-owner" id="answer-container-83780">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/83780/up/" id="post-83780-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-83780-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/83780/down/" id="post-83780-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>I see. But what happens if I update my database with an extract of the updated OSM data and the OSM_IDs I've chosen get duplicated?</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/83780/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>10 Mar '22, 09:00</strong>
</p>
<img alt="todelo's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/7f376eb35f20c1f021067ede20bd4e6b?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/21498/todelo">todelo</a><br/>
<span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">●</span><span class="badgecount">3</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="todelo has no accepted answers">0%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/83780/">
                edited
                <strong>10 Mar '22, 09:01</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-83780">
</div>
<div class="comment-tools" id="comment-tools-83780">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-83780-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<a name="84430"></a>
<div class="answer answered-by-owner" id="answer-container-84430">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/84430/up/" id="post-84430-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-84430-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/84430/down/" id="post-84430-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>After a few months not working on the problem I tried Ionvia's solution, but something did not work.
I created an xml file from a DataFrame with pyosmium.
The file looks like this:</p>
<p><img alt="alt text" src="https://help.openstreetmap.org/upfiles/Screenshot_from_2022-05-10_17-37-12.png"/></p>
<p>I run <code>nominatim add-data --file &lt;myfile.xml&gt;</code> and the nodes indeed appear in the <code>planet_osm_nodes</code> table. However, the command <code>nominatim index</code> runs with no errors but indexes <code>0/0</code> new objects at every rank level. And indeed the new nodes do not eventually appear in the <code>placex</code> table and therefore do not show up in the <code>search</code>.</p>
<p>What am I missing?</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/84430/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>10 May '22, 16:35</strong>
</p>
<img alt="todelo's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/7f376eb35f20c1f021067ede20bd4e6b?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/21498/todelo">todelo</a><br/>
<span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">●</span><span class="badgecount">3</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="todelo has no accepted answers">0%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/84430/">
                edited
                <strong>10 May '22, 16:37</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-84430">
<a name="84431"></a>
<div class="comment" id="comment-84431">
<div class="comment-score" id="post-84431-score">1</div>
<div class="comment-text"><p>It's <code>addr:housenumber</code> not <code>addr:house_number</code>.</p></div>
<div class="comment-info" id="comment-84431-info">
<span class="comment-age">(10 May '22, 16:55)</span>
<a class="comment-user userinfo" href="/users/2921/lonvia">lonvia</a>
</div>
</div>
<a name="84433"></a>
<div class="comment" id="comment-84433">
<div class="comment-score" id="post-84433-score"></div>
<div class="comment-text"><p>Oh dear! Thank you so much!</p></div>
<div class="comment-info" id="comment-84433-info">
<span class="comment-age">(10 May '22, 21:37)</span>
<a class="comment-user userinfo" href="/users/21498/todelo">todelo</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-84430">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-84430-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<a name="86831"></a>
<div class="answer" id="answer-container-86831">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/86831/up/" id="post-86831-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-86831-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/86831/down/" id="post-86831-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>Hi <a href="https://help.openstreetmap.org/users/21498/todelo">@todelo</a>
I need to edit the column 'extratags' in the table 'placex'.
I have installed Nominatim in my local machine.
Its possible to make this changes in the database?</p>
<p>Could you help me with this?</p>
<p>Thank you. </p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/86831/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>01 Mar '23, 15:32</strong>
</p>
<img alt="Martim's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/88d43a2ecb5b0fc62a4db7f97a166682?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/22775/martim">Martim</a><br/>
<span class="score" title="1 reputation points">1</span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Martim has no accepted answers">0%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-86831">
</div>
<div class="comment-tools" id="comment-tools-86831">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-86831-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<a name="86832"></a>
<div class="answer" id="answer-container-86832">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/86832/up/" id="post-86832-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-86832-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/86832/down/" id="post-86832-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>Hi <a href="https://help.openstreetmap.org/users/21498/todelo">@todelo</a>
I need to edit the column 'extratags' in the table 'placex'.
I have installed Nominatim in my local machine.
Its possible to make this changes in the database?</p>
<p>Could you help me with this?</p>
<p>Thank you. </p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/86832/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>01 Mar '23, 15:32</strong>
</p>
<img alt="Martim's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/88d43a2ecb5b0fc62a4db7f97a166682?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/22775/martim">Martim</a><br/>
<span class="score" title="1 reputation points">1</span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Martim has no accepted answers">0%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-86832">
</div>
<div class="comment-tools" id="comment-tools-86832">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-86832-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<a name="86837"></a>
<div class="answer answered-by-owner" id="answer-container-86837">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/86837/up/" id="post-86837-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-86837-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/86837/down/" id="post-86837-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>What do you mean exactly? If you have your local installation, that means you have a local postgreSQL database, so you can modify the extratags column with standard SQL commands. I am not sure what happens to your changes if you update your data though</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/86837/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>02 Mar '23, 09:18</strong>
</p>
<img alt="todelo's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/7f376eb35f20c1f021067ede20bd4e6b?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/21498/todelo">todelo</a><br/>
<span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">●</span><span class="badgecount">3</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="todelo has no accepted answers">0%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-86837">
</div>
<div class="comment-tools" id="comment-tools-86837">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-86837-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/83761/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="CNWQLSVCQIkTykQjacuAaIXQek0xRQfY"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>