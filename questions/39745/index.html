<meta charset="utf-8"/><link href="../style.css" rel="stylesheet" type="text/css"/><div id="CALeft"><center><a href="../"><img id="ll" src="https://help.openstreetmap.org/upfiles/osm_help_logo_6.png"/></a></center>
<div class="headNormal">
<h1><a href="/questions/39745/show-duplicated-nodes-via-overpass">Show duplicated nodes via Overpass</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/39745/up/" id="post-39745-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-39745-score" title="current number of votes">
    2
</div>
<a class="ajax-command post-vote down" href="/vote/39745/down/" id="post-39745-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/39745/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
   1
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>How to show the duplicated nodes, such as <a href="http://www.openstreetmap.org/edit?editor=potlatch2#map=23/45.01972/39.02164" title="Don't fix this, please :)">this</a>, via the Overpass (API, Turbo)?</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-overpass" href="/tags/overpass/" rel="tag" title="see questions tagged 'overpass'">overpass</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>20 Dec '14, 20:34</strong>
</p>
<img alt="chilin's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/e7ab0e74a89c411904b7077d5b1ddcff?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/10207/chilin">chilin</a><br/>
<span class="score" title="61 reputation points">61</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="chilin has no accepted answers">0%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/39745/">
                edited
                <strong>20 Dec '14, 20:37</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-39745">
<a name="39756"></a>
<div class="comment" id="comment-39756">
<div class="comment-score" id="post-39756-score"></div>
<div class="comment-text"><p>As an aside, if you want to link to problem data that won't get accidentally fixed, you could use a link to a location via <a href="http://api06.dev.openstreetmap.org">http://api06.dev.openstreetmap.org</a> .  That has a separate set of test data, and no one will fix your example problem by accident.</p></div>
<div class="comment-info" id="comment-39756-info">
<span class="comment-age">(21 Dec '14, 11:38)</span>
<a class="comment-user userinfo" href="/users/387/someoneelse">SomeoneElse ♦</a>
</div>
</div>
<a name="39757"></a>
<div class="comment" id="comment-39757">
<div class="comment-score" id="post-39757-score">1</div>
<div class="comment-text"><p><a href="http://help.openstreetmap.org/users/387/someoneelse">@SomeoneElse</a>: that probably won't work with overpass, as there's no instance pointing to the dev server I'm aware of. However, that's not a big issue. Just add [date:"2014-12-21T00:00:00Z"] to the top of the query to always reference that point in time.</p></div>
<div class="comment-info" id="comment-39757-info">
<span class="comment-age">(21 Dec '14, 12:02)</span>
<a class="comment-user userinfo" href="/users/8708/mmd">mmd</a>
</div>
</div>
<a name="39762"></a>
<div class="comment" id="comment-39762">
<div class="comment-score" id="post-39762-score"></div>
<div class="comment-text"><p>Ok. <a href="http://level0.osmz.ru/?url=%2F%2Foverpass-api.de%2Fapi%2Finterpreter%3Fdata%3D%255Bdate%253A%25222014-12-21T00%253A00%253A00Z%2522%255D%250A%255Bbbox%253A45.01922299382942%252C39.02108520269394%252C45.02009039433733%252C39.02220368385315%255D%253B%250Anode%253B%250Aforeach-%253E.a%28%250A%2520%2520%2520%2520node%28around.a%253A0%29-%253E.b%253B%250A%2520%2520%2520%2520%28.b%253B%2520-%2520.a%29%253B%250A%2520%2520%2520%2520out%2520meta%253B%250A%29%253B">Here's a permanent link</a> to this place based on the due date.</p></div>
<div class="comment-info" id="comment-39762-info">
<span class="comment-age">(21 Dec '14, 20:06)</span>
<a class="comment-user userinfo" href="/users/10207/chilin">chilin</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-39745">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-39745-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    One Answer:
                    </div>
<div class="tabsA"><a href="/questions/39745/show-duplicated-nodes-via-overpass?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/39745/show-duplicated-nodes-via-overpass?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/39745/show-duplicated-nodes-via-overpass?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/39745/show-duplicated-nodes-via-overpass?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="39746"></a>
<div class="answer accepted-answer" id="answer-container-39746">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/39746/up/" id="post-39746-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-39746-score" title="current number of votes">
    6
</div>
<a class="ajax-command post-vote down" href="/vote/39746/down/" id="post-39746-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="accept-answer on" href="/accept_answer/39746/" rel="nofollow" title="chilin has selected this answer as the correct answer">
</a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>As Overpass API is not the most common tool for this task, I will also mention a few more mainstream alternatives.</p>
<p><strong>Option 1:</strong> Overpass API</p>
<p>This query will first determine all nodes in the current bounding box. For each node found, we will then start looking for some nodes at exactly the same location. The result will return all pairs of duplicate nodes found in the current bbox.</p>
<pre><code>[bbox:{{bbox}}];
node;
foreach-&gt;.a(
    node(around.a:0)-&gt;.b;
    (.b; - .a);
    out meta;
);
</code></pre>
<p>Unfortunately, this approach is extremely slow with <code>out meta;</code> (NB: this seems to be a bug, I've created a <a href="https://github.com/drolbr/Overpass-API/issues/165">Github issue for this</a>). If you don't need metadata information, just replace <code>out meta;</code> by <code>out;</code> and you will get the response almost instantly.</p>
<p>Try it on overpass turbo: <a href="http://overpass-turbo.eu/s/6C7">very slow (with metadata</a>) and <a href="http://overpass-turbo.eu/s/6Cy">fast (without metadata)</a></p>
<p><img alt="alt text" src="http://help.openstreetmap.org/upfiles/duplicates.png"/></p>
<p><strong>Option 2:</strong></p>
<p>I'd really recommend to also look at <strong>keep right!</strong> (analysis data is a few weeks old): 
see <a href="http://keepright.at/report_map.php?lang=en&amp;ch30=1&amp;ch40=1&amp;ch50=1&amp;ch70=1&amp;ch90=1&amp;ch100=1&amp;ch110=1&amp;ch120=1&amp;ch130=1&amp;ch150=1&amp;ch160=1&amp;ch170=1&amp;ch180=1&amp;ch191=1&amp;ch192=1&amp;ch193=1&amp;ch194=1&amp;ch195=1&amp;ch196=1&amp;ch197=1&amp;ch198=1&amp;ch201=1&amp;ch202=1&amp;ch203=1&amp;ch204=1&amp;ch205=1&amp;ch206=1&amp;ch207=1&amp;ch208=1&amp;ch210=1&amp;ch220=1&amp;ch231=1&amp;ch232=1&amp;ch270=1&amp;ch281=1&amp;ch282=1&amp;ch283=1&amp;ch284=1&amp;ch285=1&amp;ch291=1&amp;ch292=1&amp;ch293=1&amp;ch294=1&amp;ch295=1&amp;ch296=1&amp;ch297=1&amp;ch298=1&amp;ch311=1&amp;ch312=1&amp;ch313=1&amp;ch320=1&amp;ch350=1&amp;ch370=1&amp;ch380=1&amp;ch401=1&amp;ch402=1&amp;ch411=1&amp;ch412=1&amp;ch413=1&amp;number_of_tristate_checkboxes=8&amp;highlight_error_id=0&amp;highlight_schema=0&amp;lat=45.01903&amp;lon=39.02266&amp;zoom=17&amp;show_ign=1&amp;show_tmpign=1&amp;layers=B0T&amp;ch=0%2C20">this example for a layer with multiple nodes on the same spot</a></p>
<p><strong>Option 3:</strong></p>
<p>In addition to that, <strong>JOSM validator</strong> will warn you regarding many unconnected nodes without physical characteristics in that area - and even fix them! That's probably the best way to go.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/39746/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>20 Dec '14, 21:19</strong>
</p>
<img alt="mmd's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/264d84ab05b942224b05960903eba7a7?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/8708/mmd">mmd</a><br/>
<span class="score" title="5682 reputation points"><span class="">5.7k</span></span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="53 badges"><span class="silver">●</span><span class="badgecount">53</span></span><span title="88 badges"><span class="bronze">●</span><span class="badgecount">88</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="mmd has 44 accepted answers">37%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/39746/">
                edited
                <strong>21 Dec '14, 11:11</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-39746">
<a name="39747"></a>
<div class="comment" id="comment-39747">
<div class="comment-score" id="post-39747-score">1</div>
<div class="comment-text"><p>Thank you for such a detailed answer.</p></div>
<div class="comment-info" id="comment-39747-info">
<span class="comment-age">(20 Dec '14, 22:54)</span>
<a class="comment-user userinfo" href="/users/10207/chilin">chilin</a>
</div>
</div>
<a name="39755"></a>
<div class="comment" id="comment-39755">
<div class="comment-score" id="post-39755-score"></div>
<div class="comment-text"><p>It should also be noted that multiple nodes on the same spot are not necessarily an error, and sometimes even required (e.g. in multi-level buildings).</p></div>
<div class="comment-info" id="comment-39755-info">
<span class="comment-age">(21 Dec '14, 11:37)</span>
<a class="comment-user userinfo" href="/users/14/tordanik">Tordanik</a>
</div>
</div>
<a name="64077"></a>
<div class="comment" id="comment-64077">
<div class="comment-score" id="post-64077-score"></div>
<div class="comment-text"><p>For those coming here via a search, the above Overpass query requires an extra ';' after the '.a' variable:</p>
<p>(.b; - .a;);</p></div>
<div class="comment-info" id="comment-64077-info">
<span class="comment-age">(07 Jun '18, 12:47)</span>
<a class="comment-user userinfo" href="/users/1532/davef">DaveF</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-39746">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-39746-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/39745/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="TjQ3VKnZSu4zz3XcpTf8ldizq2i0m89U"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>