<meta charset="utf-8"/><link href="../style.css" rel="stylesheet" type="text/css"/><div id="CALeft"><center><a href="../"><img id="ll" src="https://help.openstreetmap.org/upfiles/osm_help_logo_6.png"/></a></center>
<div class="headNormal">
<h1><a href="/questions/34274/bad-rendering-performance-tirex">Bad Rendering Performance (Tirex)</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/34274/up/" id="post-34274-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-34274-score" title="current number of votes">
    1
</div>
<a class="ajax-command post-vote down" href="/vote/34274/down/" id="post-34274-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/34274/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>We have set up a rendering server with a Intel(R) Xeon(R) CPU E5-1620 v2 @ 3.70GHz, 32 GB RAM and SSD discs for the database storage.</p>
<p>Import was done using <code>osm2pgsql -C14G --number-processes 8 -v --slim planet-latest.osm.pbf</code>
and postgresql 9.3 and the settings as <a href="http://www.geofabrik.de/media/2012-09-08-osm2pgsql-performance.pdf">suggested by Frederik Ramm</a>.</p>
<p>But the performance on low zoom levels is worse than what Frederik gets in his talk.  Maybe because of additional map data in the past 2 years?</p>
<p>Some extreme examples:</p>
<pre><code>Map                           X          Y   Z Prio   Age
example                      32         16   6    1   486

Currently rendering: (num=4)
Map                           X          Y   Z Prio   Age
example                     136         80   8    1   295
example                     128         80   8    1   295
example                     264        168   9    1   285
example                     528        352  10    1   260
</code></pre>
<p>I am using the standard osm.xml (mapnik-osm-carto).</p>
<p><code>generate_image.py</code> with the standard bounding box (GB) takes 6m10.450s.</p>
<p>Is this normal?</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-performance" href="/tags/performance/" rel="tag" title="see questions tagged 'performance'">performance</a>
<a class="post-tag tag-link-tirex" href="/tags/tirex/" rel="tag" title="see questions tagged 'tirex'">tirex</a>
<a class="post-tag tag-link-mapnik" href="/tags/mapnik/" rel="tag" title="see questions tagged 'mapnik'">mapnik</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>24 Jun '14, 13:22</strong>
</p>
<img alt="Alex_AddisMap's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/7651f7a3094f0a39b51630214fe9c94d?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/164/alex_addismap">Alex_AddisMap</a><br/>
<span class="score" title="189 reputation points">189</span><span title="7 badges"><span class="badge1">●</span><span class="badgecount">7</span></span><span title="8 badges"><span class="silver">●</span><span class="badgecount">8</span></span><span title="15 badges"><span class="bronze">●</span><span class="badgecount">15</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Alex_AddisMap has no accepted answers">0%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/34274/">
                edited
                <strong>24 Jun '14, 13:31</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-34274">
</div>
<div class="comment-tools" id="comment-tools-34274">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-34274-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    One Answer:
                    </div>
<div class="tabsA"><a href="/questions/34274/bad-rendering-performance-tirex?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/34274/bad-rendering-performance-tirex?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/34274/bad-rendering-performance-tirex?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/34274/bad-rendering-performance-tirex?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="34307"></a>
<div class="answer accepted-answer" id="answer-container-34307">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/34307/up/" id="post-34307-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-34307-score" title="current number of votes">
    2
</div>
<a class="ajax-command post-vote down" href="/vote/34307/down/" id="post-34307-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="accept-answer on" href="/accept_answer/34307/" rel="nofollow" title="Alex_AddisMap has selected this answer as the correct answer">
</a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>You've already partially answered your own question: two years ago we had roughly half the data we currently have in the database see for example <a href="http://osmstats.altogetherlost.com/index.php?item=nodes">http://osmstats.altogetherlost.com/index.php?item=nodes</a> (I'm actually surprised that you are not still importing given that the cache value you used is far too small for a current planet).</p>
<p>However the queries for low zoom tile data tend to already substantially reduce the ammout of data, so that is likely not to be a major factor. Frederiks numbers seem to be very good, I've not actually ever seen low zoom tiles render as fast as his numbers show. IIRC for the standard style we pre-render down to zoom level 14 to work around that.<br/>
</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/34307/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>25 Jun '14, 09:24</strong>
</p>
<img alt="SimonPoole's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/ad2513d6f8e3d709d576ace900c12fa5?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/2053/simonpoole">SimonPoole ♦</a><br/>
<span class="score" title="44667 reputation points"><span class="">44.7k</span></span><span title="13 badges"><span class="badge1">●</span><span class="badgecount">13</span></span><span title="326 badges"><span class="silver">●</span><span class="badgecount">326</span></span><span title="701 badges"><span class="bronze">●</span><span class="badgecount">701</span></span><br>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="SimonPoole has 209 accepted answers">18%</span>
</br></p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/34307/">
                edited
                <strong>25 Jun '14, 09:35</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-34307">
<a name="34652"></a>
<div class="comment" id="comment-34652">
<div class="comment-score" id="post-34652-score"></div>
<div class="comment-text"><p>Even on zoom level 15 I have the problem that tiles take too long.</p></div>
<div class="comment-info" id="comment-34652-info">
<span class="comment-age">(05 Jul '14, 13:14)</span>
<a class="comment-user userinfo" href="/users/164/alex_addismap">Alex_AddisMap</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-34307">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-34307-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/34274/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="hJQIPecRfY4iOYqNWNC2vV1qhiBExEWs"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>