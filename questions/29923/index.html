<meta charset="utf-8"/><link href="../style.css" rel="stylesheet" type="text/css"/><div id="CALeft"><center><a href="../"><img id="ll" src="https://help.openstreetmap.org/upfiles/osm_help_logo_6.png"/></a></center>
<div class="headNormal">
<h1><a href="/questions/29923/open-street-map-use-in-aspnet-c-web-application">Open street map use in asp.net c# web application</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/29923/up/" id="post-29923-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-29923-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/29923/down/" id="post-29923-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/29923/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>Please let me know how can i use open street map in my asp.net c# web application .. can any sample demo available or not .. </p>
<p>i don't use open street map so i don't have any idea about how can i use .. </p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-c#" href="/tags/c%2523/" rel="tag" title="see questions tagged 'c#'">c#</a>
<a class="post-tag tag-link-asp.net" href="/tags/asp.net/" rel="tag" title="see questions tagged 'asp.net'">asp.net</a>
<a class="post-tag tag-link-c#.net" href="/tags/c%2523.net/" rel="tag" title="see questions tagged 'c#.net'">c#.net</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>18 Jan '14, 07:20</strong>
</p>
<img alt="shivanic77's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/a9c6c9f30638359b7c481959f088d8f3?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/8171/shivanic77">shivanic77</a><br/>
<span class="score" title="15 reputation points">15</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="bronze">●</span><span class="badgecount">1</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="shivanic77 has no accepted answers">0%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-29923">
<a name="29927"></a>
<div class="comment" id="comment-29927">
<div class="comment-score" id="post-29927-score">1</div>
<div class="comment-text"><p>So what do you want to realise? Just displaying a map (online or offline)? Or also POI search, routing, ...?
A first starting point is <a href="http://wiki.openstreetmap.org/wiki/Frameworks">http://wiki.openstreetmap.org/wiki/Frameworks</a></p></div>
<div class="comment-info" id="comment-29927-info">
<span class="comment-age">(18 Jan '14, 09:14)</span>
<a class="comment-user userinfo" href="/users/4984/iii">iii</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-29923">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-29923-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    2 Answers:
                    </div>
<div class="tabsA"><a href="/questions/29923/open-street-map-use-in-aspnet-c-web-application?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/29923/open-street-map-use-in-aspnet-c-web-application?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/29923/open-street-map-use-in-aspnet-c-web-application?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/29923/open-street-map-use-in-aspnet-c-web-application?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="31067"></a>
<div class="answer" id="answer-container-31067">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/31067/up/" id="post-31067-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-31067-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/31067/down/" id="post-31067-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>I think your best bet is the "BruTile" library - check out <a href="http://brutile.codeplex.com/.">http://brutile.codeplex.com/.</a> There's a couple of projects linked from there that use the library so you could use them as your example code.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/31067/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>26 Feb '14, 22:37</strong>
</p>
<img alt="Frederik%20Ramm's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/a2b38d937e70ab39d895d17da0dd1ba4?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/104/frederik-ramm">Frederik Ramm ♦</a><br/>
<span class="score" title="82494 reputation points"><span class="">82.5k</span></span><span title="92 badges"><span class="badge1">●</span><span class="badgecount">92</span></span><span title="720 badges"><span class="silver">●</span><span class="badgecount">720</span></span><span title="1273 badges"><span class="bronze">●</span><span class="badgecount">1273</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Frederik Ramm has 417 accepted answers">23%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-31067">
</div>
<div class="comment-tools" id="comment-tools-31067">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-31067-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<a name="66870"></a>
<div class="answer" id="answer-container-66870">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/66870/up/" id="post-66870-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-66870-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/66870/down/" id="post-66870-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>Hi, I made it and it works.</p>
<p>link to download File01 and File 02: <a href="http://listefacil.com.br/busca_resultados.rar">http://listefacil.com.br/busca_resultados.rar</a></p>
<p>File 01 (Busca_resultados.aspx)</p>
<pre><code>&lt;%@ Page Title="" Language="C#" MasterPageFile="~/ListeMasterPage.master" AutoEventWireup="true" CodeFile="Busca_resultados.aspx.cs" Inherits="Busca_resultados" %&gt;

&lt;asp:Content ID="Content1" ContentPlaceHolderID="head" runat="Server"&gt;
    &lt;meta charset="utf-8" /&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;link rel="shortcut icon" type="image/x-icon" href="docs/images/favicon.ico" /&gt;
    &lt;link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css" integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA==" crossorigin=""/&gt;
    &lt;script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js" integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA==" crossorigin=""&gt;&lt;/script&gt;

    &lt;style&gt;
        html, body {
            height: 100%;
            margin: 0;
        }
        #map {
            width: 600px;
            height: 400px;
        }
    &lt;/style&gt;
&lt;/asp:Content&gt;
&lt;asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder1" runat="Server"&gt;
    &lt;br /&gt;
    &lt;br /&gt;
    &lt;br /&gt;
    &lt;br /&gt;
    &lt;div id="map" style="width: 100%; height: 350px;"&gt;&lt;/div&gt;
                        &lt;script&gt;

                            var markers = L.layerGroup();
                            &lt;asp:Repeater ID="rptMarkers" runat="server"&gt;
                                &lt;ItemTemplate&gt;
                                        L.marker([&lt;%# Eval("emp_lat") %&gt;, &lt;%# Eval("emp_lng") %&gt;]).bindPopup('&lt;h6&gt;&lt;b&gt;&lt;%# Eval("emp_nome") %&gt;&lt;/b&gt;&lt;/h6&gt;Fone:&lt;%# Eval("emp_fone") %&gt;&lt;br&gt;&lt;br&gt;&lt;a href=empresa.aspx?emp_id=&lt;%# Eval("emp_id") %&gt;&amp;p=&lt;%# Eval("emp_plano") %&gt;&gt;VEJA MAIS DETALHES...&lt;/a&gt;').addTo(markers);
                                &lt;/ItemTemplate&gt;
                            &lt;/asp:Repeater&gt;


                            var mbAttr = 'Map data &amp;copy; &lt;a href="https://www.openstreetmap.org/"&gt;OpenStreetMap&lt;/a&gt; contributors, ' +
                                    '&lt;a href="https://creativecommons.org/licenses/by-sa/2.0/"&gt;CC-BY-SA&lt;/a&gt;, ' +
                                    'Imagery © &lt;a href="https://www.mapbox.com/"&gt;Mapbox&lt;/a&gt;',
                                mbUrl = 'https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw';

                            var grayscale   = L.tileLayer(mbUrl, {id: 'mapbox.light', attribution: mbAttr}),
                                streets  = L.tileLayer(mbUrl, {id: 'mapbox.streets',   attribution: mbAttr});

                            var map = L.map('map', {
                                center: [&lt;%=var_lat_ini%&gt;, &lt;%=var_lng_ini%&gt;],
                                zoom: 10,
                                layers: [grayscale, markers]
                            });

                            var baseLayers = {
                                "Grayscale": grayscale,
                                "Streets": streets
                            };

                            var overlays = {
                                "Markers": markers
                            };

                            L.control.layers(baseLayers, overlays).addTo(map);


                        &lt;/script&gt;
&lt;/asp:Content&gt;
</code></pre>
<hr/>
<p>Code Behind (Busca_resultados.aspx.cs) File 02</p>
<pre><code>using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using Npgsql;
using System.Data;
using System.Configuration;

public partial class Busca_resultados : System.Web.UI.Page
{


    public string getConstr()
    {
        string conStr = ConfigurationManager.ConnectionStrings["conPostCons"].ConnectionString;
        return conStr;
    }


    public string var_lat_ini;
    public string var_lng_ini;

    protected void Page_Load(object sender, EventArgs e)
    {

        string var_txt = Request.QueryString["txt"];

        if (var_txt == "")
        {


            NpgsqlConnection con = new NpgsqlConnection(getConstr());
            NpgsqlCommand cmd = new NpgsqlCommand("select tb_empresas.emp_id, tb_empresas.emp_nome, " +
                "tb_empresas.emp_plano, tb_empresas.emp_lat, tb_empresas.emp_lng, " +
                "tb_empresas.emp_logo, tb_empresas.emp_fone " +
                "from tb_empresas " +
                "where tb_empresas.uf_id=@uf_id and " +
                "tb_empresas.cid_id=@cid_id and " +
                "tb_empresas.sub_cat_id=@sub_cat_id and " +
                "tb_empresas.emp_plano &lt;&gt; 'g' and " +
                "tb_empresas.emp_data_fim &gt;= @data_fim", con);

            try
            {
                cmd.Parameters.AddWithValue("@uf_id", Request.QueryString["uf_id"]);
                cmd.Parameters.AddWithValue("@cid_id", Request.QueryString["cid_id"]);
                cmd.Parameters.AddWithValue("@sub_cat_id", Request.QueryString["sub_cat_id"]);
                DateTime data_fim = DateTime.Now;
                cmd.Parameters.AddWithValue("@data_fim", data_fim);

                con.Open();
                NpgsqlDataReader dr;
                dr = cmd.ExecuteReader();


                if (dr.HasRows)
                {
                    DataTable dt = new DataTable("Tabela");

                    dt.Columns.Add("emp_id", typeof(string));
                    dt.Columns.Add("emp_nome", typeof(string));
                    dt.Columns.Add("emp_plano", typeof(string));
                    dt.Columns.Add("emp_lat", typeof(string));
                    dt.Columns.Add("emp_lng", typeof(string));
                    dt.Columns.Add("emp_fone", typeof(string));
                    dt.Columns.Add("emp_logo", typeof(string));

                    while (dr.Read())
                    {
                        dt.Rows.Add(dr["emp_id"].ToString(), dr["emp_nome"].ToString(), dr["emp_plano"].ToString(), dr["emp_lat"].ToString(), dr["emp_lng"].ToString(), dr["emp_fone"].ToString(), dr["emp_logo"].ToString());

                        // INICIO USADO EM O OPENSTREETMAP
                        var_lat_ini = dt.Rows[0]["emp_lat"].ToString();
                        var_lng_ini = dt.Rows[0]["emp_lng"].ToString();
                        // FIM USADO COM O OPENSTREETMAP
                    }

                    rptMarkers.DataSource = dt;
                    rptMarkers.DataBind();
                }


            }
            finally
            {
                con.Close();
            }
        }
        else
        {
            // O métdo Trim retira todos os espaços em branco a esquerda e a direita de nossa busca
            string var_busca_txt = Request.QueryString["txt"].Trim();
            string uf_id = Request.QueryString["uf_id"];
            string cid_id = Request.QueryString["cid_id"];

            string[] separar = var_busca_txt.Split(new Char[] { ' ' });

            //organiza a busca no campo emp_info da tb_empresas
            string palavra_info = "";
            foreach (string p in separar)
            {
                if (p.Trim() != "")
                {
                    palavra_info = palavra_info + "'%" + p + "%' or upper(emp_info) like ";
                }

            }
            //tratamento da string
            int tamanho_string_info = palavra_info.Length - 25;
            palavra_info = palavra_info.Substring(0, tamanho_string_info);



            //organiza a busca no campo emp_nome da tb_empresas
            string palavra_empresa = "";
            foreach (string p in separar)
            {
                if (p.Trim() != "")
                {
                    palavra_empresa = palavra_empresa + "'%" + p + "%' or upper(emp_nome) like ";
                }

            }
            //tratamento da string
            int tamanho_string_emp_nome = palavra_empresa.Length - 25;
            palavra_empresa = palavra_empresa.Substring(0, tamanho_string_emp_nome);

            NpgsqlConnection con = new NpgsqlConnection(getConstr());
            NpgsqlCommand cmd = new NpgsqlCommand("select tb_empresas.emp_id, tb_empresas.emp_nome, " +
                "tb_empresas.emp_plano, tb_empresas.emp_lat, tb_empresas.emp_lng, " +
                "tb_empresas.emp_logo, tb_empresas.emp_fone " +
                "from tb_empresas " +
                "where (upper(emp_info) like " + palavra_info.ToUpper() +
                " or (upper(emp_nome) like " + palavra_empresa.ToUpper() +
                ")) and tb_empresas.uf_id=@uf_id and " +
                "tb_empresas.cid_id=@cid_id and " +
                "tb_empresas.emp_plano &lt;&gt; 'g' and " +
                "tb_empresas.emp_data_fim &gt;= @data_fim", con);

            try
            {
                cmd.Parameters.AddWithValue("@uf_id", uf_id);
                cmd.Parameters.AddWithValue("@cid_id", cid_id);
                DateTime data_fim = DateTime.Now;
                cmd.Parameters.AddWithValue("@data_fim", data_fim);
                con.Open();
                NpgsqlDataReader dr;
                dr = cmd.ExecuteReader();

                if (dr.HasRows)
                {
                    DataTable dt = new DataTable("Tabela");

                    dt.Columns.Add("emp_id", typeof(string));
                    dt.Columns.Add("emp_nome", typeof(string));
                    dt.Columns.Add("emp_plano", typeof(string));
                    dt.Columns.Add("emp_lat", typeof(string));
                    dt.Columns.Add("emp_lng", typeof(string));
                    dt.Columns.Add("emp_fone", typeof(string));
                    dt.Columns.Add("emp_logo", typeof(string));

                    while (dr.Read())
                    {
                        dt.Rows.Add(dr["emp_id"].ToString(), dr["emp_nome"].ToString(), dr["emp_plano"].ToString(), dr["emp_lat"].ToString(), dr["emp_lng"].ToString(), dr["emp_fone"].ToString(), dr["emp_logo"].ToString());

                        // INICIO USADO EM O OPENSTREETMAP
                        var_lat_ini = dt.Rows[0]["emp_lat"].ToString();
                        var_lng_ini = dt.Rows[0]["emp_lng"].ToString();
                        // FIM USADO COM O OPENSTREETMAP
                    }

                    rptMarkers.DataSource = dt;
                    rptMarkers.DataBind();
                }
            }
            finally
            {
                con.Close();
            }
        }

    }
}
</code></pre>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/66870/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>21 Nov '18, 01:25</strong>
</p>
<img alt="fbianof's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/7c9aa2d7e45a31b36f0841a37e071f81?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/15937/fbianof">fbianof</a><br/>
<span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="bronze">●</span><span class="badgecount">1</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="fbianof has no accepted answers">0%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/66870/">
                edited
                <strong>21 Nov '18, 07:46</strong>
</a>
</p>
<img alt="aseerel4c26's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/66f0dc05b44574e3894be07b0b37cf37?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/5179/aseerel4c26">aseerel4c26 ♦</a><br/>
<span class="score" title="32615 reputation points"><span class="">32.6k</span></span><span title="18 badges"><span class="badge1">●</span><span class="badgecount">18</span></span><span title="248 badges"><span class="silver">●</span><span class="badgecount">248</span></span><span title="554 badges"><span class="bronze">●</span><span class="badgecount">554</span></span></p>
</div>
</div>
<div class="comments-container" id="comments-container-66870">
<a name="71258"></a>
<div class="comment" id="comment-71258">
<div class="comment-score" id="post-71258-score"></div>
<div class="comment-text"><p>Hi aseerel4c26</p>
<p>Do you have the full code?</p></div>
<div class="comment-info" id="comment-71258-info">
<span class="comment-age">(21 Oct '19, 23:25)</span>
<a class="comment-user userinfo" href="/users/17352/vicula">vicula</a>
</div>
</div>
<a name="71260"></a>
<div class="comment" id="comment-71260">
<div class="comment-score" id="post-71260-score"></div>
<div class="comment-text"><p><a href="https://help.openstreetmap.org/users/17352/vicula">@vicula</a>: You probably meant to ask <a href="https://help.openstreetmap.org/users/15937/fbianof">@fbianof</a>.</p></div>
<div class="comment-info" id="comment-71260-info">
<span class="comment-age">(22 Oct '19, 09:14)</span>
<a class="comment-user userinfo" href="/users/10133/tzorn">TZorn</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-66870">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-66870-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/29923/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="9EQdLZdheHMPBVrvc75GEo5wG2tL9yEr"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>