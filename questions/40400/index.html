<meta charset="utf-8"/><link href="../style.css" rel="stylesheet" type="text/css"/><div id="CALeft"><center><a href="../"><img id="ll" src="https://help.openstreetmap.org/upfiles/osm_help_logo_6.png"/></a></center>
<div class="headNormal">
<h1><a href="/questions/40400/overpass-api-query-problem">Overpass API query problem</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/40400/up/" id="post-40400-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-40400-score" title="current number of votes">
    1
</div>
<a class="ajax-command post-vote down" href="/vote/40400/down/" id="post-40400-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/40400/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>I have a following query build almost same as the example at  :
 <a href="http://wiki.openstreetmap.org/wiki/Overpass_API">http://wiki.openstreetmap.org/wiki/Overpass_API</a>
It should return all town areas in the given box (second query) that are close to way from a first query, however it return a huuuge list of (?) random (?) towns and I don't know what's wrong</p>
<blockquote>

    &lt;query type="way"&gt; 
        &lt;bbox-query n="50.3651" s="50.3498" w="20.013" e="20.0468"/&gt;
        &lt;has-kv k="highway" v="primary"/&gt; 
    &lt;/query&gt;
    &lt;bbox-query n="50.3651" s="50.3498" w="20.013" e="20.0468"/&gt;
    &lt;query type="area"&gt;  
        &lt;has-kv k="place" v="town"/&gt;
    &lt;/query&gt;
    &lt;print/&gt;

</blockquote>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-overpassapi" href="/tags/overpassapi/" rel="tag" title="see questions tagged 'overpassapi'">overpassapi</a>
<a class="post-tag tag-link-query" href="/tags/query/" rel="tag" title="see questions tagged 'query'">query</a>
<a class="post-tag tag-link-area" href="/tags/area/" rel="tag" title="see questions tagged 'area'">area</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>15 Jan '15, 17:37</strong>
</p>
<img alt="huberttt's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/c94180557aecf86091ae161baf7ac008?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/10335/huberttt">huberttt</a><br/>
<span class="score" title="31 reputation points">31</span><span title="2 badges"><span class="badge1">●</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">●</span><span class="badgecount">2</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="huberttt has no accepted answers">0%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/40400/">
                edited
                <strong>15 Jan '15, 20:23</strong>
</a>
</p>
<img alt="Roland%20Olbricht's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/fcfdb0825826fd13d2ff0d83d58819c6?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/3480/roland-olbricht">Roland Olbricht</a><br/>
<span class="score" title="6666 reputation points"><span class="">6.7k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="64 badges"><span class="silver">●</span><span class="badgecount">64</span></span><span title="89 badges"><span class="bronze">●</span><span class="badgecount">89</span></span></p>
</div>
</div>
<div class="comments-container" id="comments-container-40400">
<a name="40404"></a>
<div class="comment" id="comment-40404">
<div class="comment-score" id="post-40404-score">1</div>
<div class="comment-text"><p>areas are only created for ways and relations, if they have a name (very broadly speaking). However, in your bbox, there's neither a way with place=town nor a relation with the same tagging. Only a single node, but for that one, there's no area as I mentioned.</p>
<p>Can you rephrase a bit what you're trying to do? I didn't quite get it from your question.</p>
<p>The following query would find all nodes with place=town up to 3km distance to your way. That's about the only information you would get in your bbox: <a href="http://overpass-turbo.eu/s/733">http://overpass-turbo.eu/s/733</a></p></div>
<div class="comment-info" id="comment-40404-info">
<span class="comment-age">(15 Jan '15, 17:54)</span>
<a class="comment-user userinfo" href="/users/8708/mmd">mmd</a>
</div>
</div>
<a name="40405"></a>
<div class="comment" id="comment-40405">
<div class="comment-score" id="post-40405-score">1</div>
<div class="comment-text"><p>Ok, maybe my goal was a bit messy. What my point is: Supposed we have a road ( highway=primary) , I want to find all the towns near that road (within some radius maybe 100-400m)</p></div>
<div class="comment-info" id="comment-40405-info">
<span class="comment-age">(15 Jan '15, 17:57)</span>
<a class="comment-user userinfo" href="/users/10335/huberttt">huberttt</a>
</div>
</div>
<a name="40409"></a>
<div class="comment" id="comment-40409">
<div class="comment-score" id="post-40409-score"></div>
<div class="comment-text"><p>Thank you, seems to work pretty nice, suffices. 
Regards</p></div>
<div class="comment-info" id="comment-40409-info">
<span class="comment-age">(15 Jan '15, 18:09)</span>
<a class="comment-user userinfo" href="/users/10335/huberttt">huberttt</a>
</div>
</div>
<a name="40410"></a>
<div class="comment" id="comment-40410">
<div class="comment-score" id="post-40410-score"></div>
<div class="comment-text"><p>And just one more question, what if I would like to list all the cities like before but not in a box ? I'mean for all length of road?</p></div>
<div class="comment-info" id="comment-40410-info">
<span class="comment-age">(15 Jan '15, 18:12)</span>
<a class="comment-user userinfo" href="/users/10335/huberttt">huberttt</a>
</div>
</div>
<a name="40416"></a>
<div class="comment" id="comment-40416">
<div class="comment-score" id="post-40416-score">1</div>
<div class="comment-text"><p>The following query will check along ref=7 in Poland (according to the existing relation) - <a href="http://overpass-turbo.eu/s/739">http://overpass-turbo.eu/s/739</a> ... Note that it takes several minutes to run this query.</p></div>
<div class="comment-info" id="comment-40416-info">
<span class="comment-age">(15 Jan '15, 18:35)</span>
<a class="comment-user userinfo" href="/users/8708/mmd">mmd</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-40400">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-40400-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    One Answer:
                    </div>
<div class="tabsA"><a href="/questions/40400/overpass-api-query-problem?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/40400/overpass-api-query-problem?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/40400/overpass-api-query-problem?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/40400/overpass-api-query-problem?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="40412"></a>
<div class="answer" id="answer-container-40412">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/40412/up/" id="post-40412-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-40412-score" title="current number of votes">
    3
</div>
<a class="ajax-command post-vote down" href="/vote/40412/down/" id="post-40412-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>Well, you can try and play around a bit with the following query: <a href="http://overpass-turbo.eu/s/734">http://overpass-turbo.eu/s/734</a> - or - <a href="http://overpass-turbo.eu/s/735">http://overpass-turbo.eu/s/735</a> (which includes highways on the map)</p>
<p>It will return all town nodes up to 5000m distance to a highway=primary in your current bbox.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/40412/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>15 Jan '15, 18:28</strong>
</p>
<img alt="mmd's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/264d84ab05b942224b05960903eba7a7?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/8708/mmd">mmd</a><br/>
<span class="score" title="5682 reputation points"><span class="">5.7k</span></span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="53 badges"><span class="silver">●</span><span class="badgecount">53</span></span><span title="88 badges"><span class="bronze">●</span><span class="badgecount">88</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="mmd has 44 accepted answers">37%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-40412">
</div>
<div class="comment-tools" id="comment-tools-40412">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-40412-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/40400/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="6LYs9nsklwxKyFLGLQQhZ5ZPcDEcA7tN"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>