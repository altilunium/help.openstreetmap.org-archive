<meta charset="UTF-8"><link rel="stylesheet" type="text/css" href="../style.css"><div id="CALeft">
<div class="headNormal">
<h1><a href="/questions/24864/how-does-nominatim-determine-importance-of-places">How does Nominatim determine importance of places?</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/24864/up/" id="post-24864-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-24864-score" title="current number of votes">
    2
</div>
<a class="ajax-command post-vote down" href="/vote/24864/down/" id="post-24864-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/24864/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>I'm using Nominatim to reverse-geocode natural language location descriptions for a research project.  I spent some time looking through the source code (in particular, website/search.php), but I can't seem to make heads or tails of how the "importance" score is calculated.<br/>
</p>
<p>From what I can tell, there is some baseline calculation and then numerous tweaks - one line, for example, says </p>
<p><code>$aResult['importance'] = $aResult['importance'] + ($iCountWords*0.1); // 0.1 is a completely arbitrary number but something in the range 0.1 to 0.5 would seem right</code></p>
<p>I also noticed in the documentation that Nominatim will use Wikipedia to improve the ranking of results, but once again nothing specific beyond "the importance value is calculated as log(totalcount)/log(max totalcount)."  I assume that "totalcount" is the number of internal links to an article about a specific location in the result set, and "max totalcount" is the maximum of that value across the entire result set.  But this only tells me the scoring contribution from Wikipedia, and not how the baseline score is calculated.</p>
<p>My question is, what properties of the OSM data go into the calculation, and then how is the importance score actually calculated?  What special tweaks and thresholds should I be aware of? </p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-importance" href="/tags/importance/" rel="tag" title="see questions tagged 'importance'">importance</a>
<a class="post-tag tag-link-ranking" href="/tags/ranking/" rel="tag" title="see questions tagged 'ranking'">ranking</a>
<a class="post-tag tag-link-nominatim" href="/tags/nominatim/" rel="tag" title="see questions tagged 'nominatim'">nominatim</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>03 Aug '13, 16:36</strong>
</p>
<img alt="aweissman's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/557eff6ea360379b6cf0daac3ea3e2e7?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/7019/aweissman">aweissman</a><br>
<span class="score" title="41 reputation points">41</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">●</span><span class="badgecount">3</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="aweissman has no accepted answers">0%</span>
</br></p>
</div>
</div>
<div class="comments-container" id="comments-container-24864">
</div>
<div class="comment-tools" id="comment-tools-24864">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-24864-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    2 Answers:
                    </div>
<div class="tabsA"><a href="/questions/24864/how-does-nominatim-determine-importance-of-places?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/24864/how-does-nominatim-determine-importance-of-places?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/24864/how-does-nominatim-determine-importance-of-places?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/24864/how-does-nominatim-determine-importance-of-places?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="24867"></a>
<div class="answer" id="answer-container-24867">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/24867/up/" id="post-24867-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-24867-score" title="current number of votes">
    2
</div>
<a class="ajax-command post-vote down" href="/vote/24867/down/" id="post-24867-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>For in-depth technical discussion of nominatim, you'd be better off asking on the geocoding mailing list.</p>
<p><a href="http://lists.openstreetmap.org/listinfo/geocoding">http://lists.openstreetmap.org/listinfo/geocoding</a></p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/24867/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>03 Aug '13, 18:01</strong>
</p>
<img alt="Andy%20Allan's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/c3743b1b368f5e209eb8aad30164acc4?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/3/andy-allan">Andy Allan</a><br/>
<span class="score" title="12456 reputation points"><span class="">12.5k</span></span><span title="23 badges"><span class="badge1">●</span><span class="badgecount">23</span></span><span title="128 badges"><span class="silver">●</span><span class="badgecount">128</span></span><span title="153 badges"><span class="bronze">●</span><span class="badgecount">153</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Andy Allan has 46 accepted answers">28%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-24867">
</div>
<div class="comment-tools" id="comment-tools-24867">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-24867-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<a name="67059"></a>
<div class="answer" id="answer-container-67059">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/67059/up/" id="post-67059-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-67059-score" title="current number of votes">
    2
</div>
<a class="ajax-command post-vote down" href="/vote/67059/down/" id="post-67059-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>From the mailing list: <a href="https://lists.openstreetmap.org/pipermail/geocoding/2013-August/000916.html">https://lists.openstreetmap.org/pipermail/geocoding/2013-August/000916.html</a></p>
<blockquote>
<p>The major weight of importance comes
indeed from the Wikipedia link count.
If no article can be found for an
object, the base score is based on the
object rank (country, county, city,
etc.)</p>
<p>There are a few minor tweaks to this
wikipedia importance. The one you have
found is the reranking by exactness of
match with the query (the one you
cited above). The more words from the
query appear verbatim in the display
name (that's the one including the
address) of the result, the higher it
gets ranked.</p>
<p>The second reranking is related to the
viewbox. If you supply a viewbox
parameter, then anything within or
close to the viewbox is ranked higher.
(e.g.
<a href="https://github.com/twain47/Nominatim/blob/master/website/search.php#L976)">https://github.com/twain47/Nominatim/blob/master/website/search.php#L976)</a></p>
<p>There is also a small tweak to take
the importance of the address members
into account but that only has an
effect if objects have an equal
importance. (e.g.
<a href="https://github.com/twain47/Nominatim/blob/master/website/search.php#L1241)">https://github.com/twain47/Nominatim/blob/master/website/search.php#L1241)</a></p>
</blockquote>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/67059/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>04 Dec '18, 14:10</strong>
</p>
<img alt="Potdeyaourt's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/6863bef08c5e0bc17bee1e10c2b56b83?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/13021/potdeyaourt">Potdeyaourt</a><br/>
<span class="score" title="61 reputation points">61</span><span title="2 badges"><span class="silver">●</span><span class="badgecount">2</span></span><span title="3 badges"><span class="bronze">●</span><span class="badgecount">3</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Potdeyaourt has no accepted answers">0%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/67059/">
                edited
                <strong>04 Dec '18, 14:10</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-67059">
</div>
<div class="comment-tools" id="comment-tools-67059">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-67059-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/24864/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="BQUbfSMqOIqEP4u4BmJHDmPKWtUA6uB1"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>