<meta charset="UTF-8"><link rel="stylesheet" type="text/css" href="../style.css"><div id="CALeft">
<div class="headNormal">
<h1><a href="/questions/49238/overpass-debugging-intermittant-500-error-messages">Overpass - debugging intermittant 500 error messages</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/49238/up/" id="post-49238-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-49238-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/49238/down/" id="post-49238-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/49238/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>I have an overpass api server that I set up, which is under reasonably heavy usage, although the machine is beefy (16 CPUS, 48G RAM, SSDs). 99.9% of the time it handles things fine. However every so often I get a HTTP 500 error from apache, and all I get in the apache error logs is this:</p>
<pre><code>[Thu Apr 07 10:07:38.737961 2016] [cgid:error] [pid 8783:tid 140682425480960] [client 1.2.3.4:61698] End of script output before headers: interpreter
</code></pre>
<p>I can't find anything in the overpass <code>transactions.log</code> file for that timestamp, nor nothing in syslog.</p>
<p>When the same query is sent at a later time, it works and returns results quickly.</p>
<p>Is there anything I can do to debug this problem more, or to find out what's going on? Or should I just resubmit the query when there is a 500 error until I get a 200 result?</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-overpass" href="/tags/overpass/" rel="tag" title="see questions tagged 'overpass'">overpass</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>15 Apr '16, 11:05</strong>
</p>
<img alt="rorym's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/16e12e337f6edc3750681492656097ed?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/30/rorym">rorym</a><br/>
<span class="score" title="5358 reputation points"><span class="">5.4k</span></span><span title="14 badges"><span class="badge1">●</span><span class="badgecount">14</span></span><span title="49 badges"><span class="silver">●</span><span class="badgecount">49</span></span><span title="100 badges"><span class="bronze">●</span><span class="badgecount">100</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="rorym has 18 accepted answers">11%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-49238">
<a name="49249"></a>
<div class="comment" id="comment-49249">
<div class="comment-score" id="post-49249-score">1</div>
<div class="comment-text"><p>Better ask this question on the overpass dev list: <a href="http://listes.openstreetmap.fr/wws/info/overpass">http://listes.openstreetmap.fr/wws/info/overpass</a> and don't forget to add much more details: (a) which Overpass / apache version do you run (b) which queries do you run (c) do you run them in parallel, if so, how many parallel threads, (d) what kind of client do you use, (e) how did you set up your db, does it include attic data?... etc... basically, what is needed to reproduce this?</p></div>
<div class="comment-info" id="comment-49249-info">
<span class="comment-age">(15 Apr '16, 17:49)</span>
<a class="comment-user userinfo" href="/users/8708/mmd">mmd</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-49238">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-49238-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    One Answer:
                    </div>
<div class="tabsA"><a href="/questions/49238/overpass-debugging-intermittant-500-error-messages?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/49238/overpass-debugging-intermittant-500-error-messages?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/49238/overpass-debugging-intermittant-500-error-messages?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/49238/overpass-debugging-intermittant-500-error-messages?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="49266"></a>
<div class="answer accepted-answer" id="answer-container-49266">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/49266/up/" id="post-49266-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-49266-score" title="current number of votes">
    2
</div>
<a class="ajax-command post-vote down" href="/vote/49266/down/" id="post-49266-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="accept-answer on" href="/accept_answer/49266/" rel="nofollow" title="rorym has selected this answer as the correct answer">
</a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>First of all, it is for sure a bug in the software. HTTP 500 means most often that the process has crashed.</p>
<p>There are HTTP 500 errors on the main instance, too. It happens about once per 100'000 requests, and the errors aren't reproducible. The Apache error log often, but not always tells "End of script output before headers".</p>
<p>After all, I have no idea what is happening there. The first log message to $DB_DIR/transactions.log is written quite early (once the process knows where the log directory is), hence I have no idea yet how to catch the error condition.</p>
<p>A general advice I can give is to run the latest version from the minor_issues branch. This branch is always intended to get patches, and some bugs that may or may not cause crashed have been fixed there.</p>
<p>The second advice is, like mmd has said, to subscribe to the Overpass list. It is probably a better place to discuss all the deeper technical details once there is more information.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/49266/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>16 Apr '16, 09:05</strong>
</p>
<img alt="Roland%20Olbricht's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/fcfdb0825826fd13d2ff0d83d58819c6?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/3480/roland-olbricht">Roland Olbricht</a><br/>
<span class="score" title="6666 reputation points"><span class="">6.7k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="64 badges"><span class="silver">●</span><span class="badgecount">64</span></span><span title="89 badges"><span class="bronze">●</span><span class="badgecount">89</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Roland Olbricht has 40 accepted answers">36%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-49266">
</div>
<div class="comment-tools" id="comment-tools-49266">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-49266-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/49238/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="h6Jk4bnyQ85my1EW35CFndHPHGlmxCcI"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>