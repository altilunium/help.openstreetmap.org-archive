<meta charset="UTF-8"><link rel="stylesheet" type="text/css" href="../style.css"><div id="CALeft">
<div class="headNormal">
<h1><a href="/questions/26860/how-to-generate-tiles-in-nad83-projection">[closed] How to generate tiles in NAD83 projection?</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/26860/up/" id="post-26860-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-26860-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/26860/down/" id="post-26860-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/26860/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>Hello, I am trying to use Maperitive to generate tiles, then use those osm tiles as the map background layer in my application. The map features on other layers are created by MapInfo. It looks like the osm tiles and features in other layers don't align in y-coordinates. I figured this is to do with MapInfo is using NAD83 projection, but osm tiles are in Mercator projection. I wonder what is the best way of generating osm tiles in NAD83 projection. Do I have to generate tiles in Mercator using Maperitive, and then re-project tiles to NAD83 projection using MapProxy? Thanks.</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-nad83" href="/tags/nad83/" rel="tag" title="see questions tagged 'nad83'">nad83</a>
<a class="post-tag tag-link-projection" href="/tags/projection/" rel="tag" title="see questions tagged 'projection'">projection</a>
<a class="post-tag tag-link-mercator" href="/tags/mercator/" rel="tag" title="see questions tagged 'mercator'">mercator</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>30 Sep '13, 12:23</strong>
</p>
<img alt="hua%20zhang's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/097099bfea770186a935d80469281663?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/7459/hua-zhang">hua zhang</a><br/>
<span class="score" title="11 reputation points">11</span><span title="2 badges"><span class="badge1">●</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">●</span><span class="badgecount">2</span></span><span title="3 badges"><span class="bronze">●</span><span class="badgecount">3</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="hua zhang has no accepted answers">0%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/26860/">
                closed
                <strong>15 Oct '13, 10:07</strong>
</a>
</p>
<img alt="SomeoneElse's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/0bf1aa22f7f5e045b0eb8beb79fe7907?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/387/someoneelse">SomeoneElse ♦</a><br/>
<span class="score" title="36866 reputation points"><span class="">36.9k</span></span><span title="71 badges"><span class="badge1">●</span><span class="badgecount">71</span></span><span title="370 badges"><span class="silver">●</span><span class="badgecount">370</span></span><span title="866 badges"><span class="bronze">●</span><span class="badgecount">866</span></span></p>
</div>
</div>
<div class="comments-container" id="comments-container-26860">
<a name="26863"></a>
<div class="comment" id="comment-26863">
<div class="comment-score" id="post-26863-score">1</div>
<div class="comment-text"><p>For info, this grew out of a previous discussion <a href="https://help.openstreetmap.org/questions/26756/generate-tiles-in-wgs84-projection">here</a>.</p></div>
<div class="comment-info" id="comment-26863-info">
<span class="comment-age">(30 Sep '13, 12:34)</span>
<a class="comment-user userinfo" href="/users/387/someoneelse">SomeoneElse ♦</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-26860">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-26860-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<div class="question-status" style="margin-bottom:15px">
<h3>
                The question has been closed for the following reason "Questioner requested question closed (see comment below)." by
                <a href="/users/387/someoneelse">SomeoneElse</a>
                 15 Oct '13, 10:07
            </h3>
</div>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    One Answer:
                    </div>
<div class="tabsA"><a href="/questions/26860/how-to-generate-tiles-in-nad83-projection?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/26860/how-to-generate-tiles-in-nad83-projection?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/26860/how-to-generate-tiles-in-nad83-projection?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/26860/how-to-generate-tiles-in-nad83-projection?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="26886"></a>
<div class="answer" id="answer-container-26886">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/26886/up/" id="post-26886-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-26886-score" title="current number of votes">
    0
</div>
<a class="ajax-command post-vote down" href="/vote/26886/down/" id="post-26886-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>The OSM PostGIS 0.6 schema ("pg_snapshot") is built on the WGS-84 projection, as can be seen by one of the (many) lines of its creation script:</p>
<pre><code>-- Add a postgis point column holding the location of the node.
SELECT AddGeometryColumn('nodes', 'geom', 4326, 'POINT', 2);
</code></pre>
<p>To convert them to a new projection (in this case "NAD83", SRID 4269 as listed <a href="http://spatialreference.org/ref/epsg/4269/">here</a>), you <strong>cannot</strong> simply set the SRID of the column:</p>
<pre><code>UPDATE table SET the_column_4326 = ST_SetSRID(the_column_4326, 4326);
</code></pre>
<p>Because the ST_SetSRID() function <em>does not perform a projection transformation</em>, as described <a href="http://postgis.net/docs/ST_SetSRID.html">on the documentation</a>.</p>
<p>Therefore, you have to use the ST_Transform() <a href="http://www.postgis.org/docs/ST_Transform.html">function</a>, saving the result on another column that has the SRID of the NAD-83 projection. For example:</p>
<pre><code>SELECT AddGeometryColumn('nodes','geom_4269', 4269, 'POINT', 2);
UPDATE nodes SET geom_4269 = ST_Transform(geom, 4269);
</code></pre>
<p>And then using the new column as the source of the data, or issuing a few more commands to replace the old column with the new one. Please note that things may get somewhat complicated should the columns be part of indexes, for example.</p>
<p>Make sure that you have the NAD-83 projection installed on your PostGIS <code>spatial_ref_sys</code> table. If not, you can always add it (from the <a href="http://spatialreference.org/ref/epsg/4269/postgis/">spatialreference.org</a> site (careful with the line breaks):</p>
<pre><code>INSERT into spatial_ref_sys (srid, auth_name, auth_srid, proj4text, srtext) values ( 94269, 'epsg', 4269, '+proj=longlat +ellps=GRS80 +datum=NAD83 +no_defs ', 'GEOGCS["NAD83",DATUM["North_American_Datum_1983",SPHEROID["GRS 1980",6378137,298.257222101,AUTHORITY["EPSG","7019"]],AUTHORITY["EPSG","6269"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.01745329251994328,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4269"]]');
</code></pre>
<p>You may also try to perform the transformation "on the fly" changing the source code of your interface, or maybe creating views from the tables, but probably it would be very CPU expensive (and probably very slow as well).</p>
<p>Additional material obtained from this StackOverflow <a href="http://stackoverflow.com/questions/3012723/how-to-change-srid-of-geometry-column">question</a></p>
<p><strong>EDIT</strong>: Fixed some typos, added link to st_transform reference.</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/26886/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>01 Oct '13, 12:00</strong>
</p>
<img alt="MCPicoli's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/94b019f273c04cd88bc1c8dd0a8f2161?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/4231/mcpicoli">MCPicoli</a><br/>
<span class="score" title="2172 reputation points"><span class="">2.2k</span></span><span title="13 badges"><span class="badge1">●</span><span class="badgecount">13</span></span><span title="30 badges"><span class="silver">●</span><span class="badgecount">30</span></span><span title="47 badges"><span class="bronze">●</span><span class="badgecount">47</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="MCPicoli has 10 accepted answers">24%</span>
</p>
</div>
<div class="post-update-info post-update-info-edited">
<p style="line-height:12px;">
<a href="/revisions/26886/">
                edited
                <strong>01 Oct '13, 12:03</strong>
</a>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-26886">
<a name="27008"></a>
<div class="comment" id="comment-27008">
<div class="comment-score" id="post-27008-score"></div>
<div class="comment-text"><p>Thank you very much MCPicoli. Is that possible to modify  Maperitive to generate tiles in NAD83 projection? If yes, could you give me some guideline on how to modify the source code? Thanks.</p></div>
<div class="comment-info" id="comment-27008-info">
<span class="comment-age">(08 Oct '13, 04:29)</span>
<a class="comment-user userinfo" href="/users/7459/hua-zhang">hua zhang</a>
</div>
</div>
<a name="27021"></a>
<div class="comment" id="comment-27021">
<div class="comment-score" id="post-27021-score"></div>
<div class="comment-text"><p>Sorry, very little experience with Maperitive.</p></div>
<div class="comment-info" id="comment-27021-info">
<span class="comment-age">(08 Oct '13, 18:40)</span>
<a class="comment-user userinfo" href="/users/4231/mcpicoli">MCPicoli</a>
</div>
</div>
<a name="27176"></a>
<div class="comment" id="comment-27176">
<div class="comment-score" id="post-27176-score"></div>
<div class="comment-text"><p>Thanks you very much for your help MCPicoli. </p>
<p>It turned out to be a mistake in my end. I am drawing the tiles on the display region using the wrong y-coorinates. There is no need for projection conversion. The map looks beautiful. Thanks.</p></div>
<div class="comment-info" id="comment-27176-info">
<span class="comment-age">(15 Oct '13, 01:25)</span>
<a class="comment-user userinfo" href="/users/7459/hua-zhang">hua zhang</a>
</div>
</div>
<a name="27177"></a>
<div class="comment" id="comment-27177">
<div class="comment-score" id="post-27177-score"></div>
<div class="comment-text"><p>Can anyone help me to close this question please? Thanks.</p></div>
<div class="comment-info" id="comment-27177-info">
<span class="comment-age">(15 Oct '13, 01:26)</span>
<a class="comment-user userinfo" href="/users/7459/hua-zhang">hua zhang</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-26886">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-26886-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/26860/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="weJjcQAZ6bkZNgLHoVVz0A7dEFSmQBYq"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>