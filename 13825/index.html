<meta charset="utf-8"/><link href="../style.css" rel="stylesheet" type="text/css"/><div id="CALeft"><center><a href="../"><img id="ll" src="https://help.openstreetmap.org/upfiles/osm_help_logo_6.png"/></a></center>
<div class="headNormal">
<h1><a href="/questions/13825/permission-issue-of-so-file-in-nominatim-osm-postgres-db">Permission issue of .so file in Nominatim osm postgres DB</a></h1>
</div>
<div class="" id="main-body">
<div id="askform">
<table id="question-table" style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/13825/up/" id="post-13825-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-13825-score" title="current number of votes">
    1
</div>
<a class="ajax-command post-vote down" href="/vote/13825/down/" id="post-13825-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="ajax-command favorite-mark" href="/mark_favorite/13825/" id="favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </a>
<div class="favorite-count" id="favorite-count">
</div>
</div>
</td>
<td>
<div id="item-right">
<div class="question-body">
<p>I am following the steps as described in <a href="http://wiki.openstreetmap.org/wiki/Nominatim/Installation">http://wiki.openstreetmap.org/wiki/Nominatim/Installation</a> to install the nominatim osm db on my own server. I need to create some functions before doing </p>
<p><code>./utils/setup.php &lt;my-planet-file&gt; --load-data</code> </p>
<p>So to create those functions I am running this command:</p>
<pre><code>./utils/setup.php --create-functions
</code></pre>
<p>But, it gives me following error:</p>
<pre><code>Error in query: ERROR: could not access file "/home/nominati/public_html/Nominatim/module/nominatim.so": Permission denied
</code></pre>
<p>As I can see error occurs while running the following query:</p>
<pre><code>CREATE OR REPLACE FUNCTION transliteration(text) RETURNS text  AS '/home/nominati/public_html/Nominatim/module/nominatim.so', 'transliteration' LANGUAGE c IMMUTABLE STRICT;
</code></pre>
<p>I am running the commands with root user and nominatim.so file owner is also root. I already changed the file owner to postgres and tried but the same error is there.
Please guide what to do?</p>
</div>
<div class="tags-container tags" id="question-tags">
<a class="post-tag tag-link-function" href="/tags/function/" rel="tag" title="see questions tagged 'function'">function</a>
<a class="post-tag tag-link-nominatim" href="/tags/nominatim/" rel="tag" title="see questions tagged 'nominatim'">nominatim</a>
<a class="post-tag tag-link-osm" href="/tags/osm/" rel="tag" title="see questions tagged 'osm'">osm</a>
<a class="post-tag tag-link-postgres" href="/tags/postgres/" rel="tag" title="see questions tagged 'postgres'">postgres</a>
</div>
<div class="post-controls" id="question-controls">
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        asked
        <strong>27 Jun '12, 07:24</strong>
</p>
<img alt="Ravi%20Kotwani's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/b3013a84207a32bed7ddfad7004100f7?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/3908/ravi-kotwani">Ravi Kotwani</a><br/>
<span class="score" title="136 reputation points">136</span><span title="6 badges"><span class="badge1">●</span><span class="badgecount">6</span></span><span title="6 badges"><span class="silver">●</span><span class="badgecount">6</span></span><span title="9 badges"><span class="bronze">●</span><span class="badgecount">9</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Ravi Kotwani has no accepted answers">0%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-13825">
</div>
<div class="comment-tools" id="comment-tools-13825">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-13825-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
<hr/>
<div class="tabBar">
<a name="sort-top"></a>
<div class="headQuestions">
                    One Answer:
                    </div>
<div class="tabsA"><a href="/questions/13825/permission-issue-of-so-file-in-nominatim-osm-postgres-db?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/13825/permission-issue-of-so-file-in-nominatim-osm-postgres-db?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/13825/permission-issue-of-so-file-in-nominatim-osm-postgres-db?sort=newest" title="newest answers will be shown first">newest answers</a><a class="on" href="/questions/13825/permission-issue-of-so-file-in-nominatim-osm-postgres-db?sort=votes" title="most voted answers will be shown first">popular answers</a></div>
</div>
<a name="13828"></a>
<div class="answer accepted-answer" id="answer-container-13828">
<table style="width:100%;">
<tr>
<td style="width:30px;vertical-align:top">
<div class="vote-buttons">
<a class="ajax-command post-vote up" href="/vote/13828/up/" id="post-13828-upvote" rel="nofollow" title="I like this post (click again to cancel)"> </a>
<div class="post-score" id="post-13828-score" title="current number of votes">
    3
</div>
<a class="ajax-command post-vote down" href="/vote/13828/down/" id="post-13828-downvote" rel="nofollow" title="I dont like this post (click again to cancel)"> </a>
<a class="accept-answer on" href="/accept_answer/13828/" rel="nofollow" title="Ravi Kotwani has selected this answer as the correct answer">
</a>
</div>
</td>
<td>
<div class="item-right">
<div class="answer-body">
<p>Found on <a href="http://www.postgresql.org/docs/8.3/static/xfunc-c.html">postgreSQL doc</a>:</p>
<p>"The user ID the PostgreSQL server runs as must be able to traverse the path to the file you intend to load. Making the file or a higher-level directory not readable and/or not executable by the postgres user is a common mistake."</p>
<p>If the full path is reachable, perhaps you need the 'executable' flag on the .so file as well (chmod +x)...</p>
</div>
<div class="answer-controls post-controls">
<span class="action-link"><a class="ajax-command withprompt copy" href="/answer_link/13828/" rel="nofollow" title="answer permanent link">permanent link</a></span>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p style="line-height:12px;">
        answered
        <strong>27 Jun '12, 10:09</strong>
</p>
<img alt="Pieren's gravatar image" class="gravatar" height="32" src="https://secure.gravatar.com/avatar/0e92f2d89853fd4e04c4b40a921e519b?s=32&amp;d=identicon&amp;r=g" width="32"/>
<p><a href="/users/87/pieren">Pieren</a><br/>
<span class="score" title="9847 reputation points"><span class="">9.8k</span></span><span title="20 badges"><span class="badge1">●</span><span class="badgecount">20</span></span><span title="83 badges"><span class="silver">●</span><span class="badgecount">83</span></span><span title="157 badges"><span class="bronze">●</span><span class="badgecount">157</span></span><br/>
<span class="accept_rate" title="Rate of the user's accepted answers">accept rate:</span>
<span title="Pieren has 34 accepted answers">15%</span>
</p>
</div>
</div>
<div class="comments-container" id="comments-container-13828">
<a name="13833"></a>
<div class="comment" id="comment-13833">
<div class="comment-score" id="post-13833-score"></div>
<div class="comment-text"><p>I have already applied the 777 permission to module folder (Directory of .so file). And owner of nominatim.so file is root, I have also already tried it by changing the owner (chown) as postgres, nominatim and etc. But still facing the same problem? Is it a way I can delete this nominatim.so file and get new one with some easy steps?</p></div>
<div class="comment-info" id="comment-13833-info">
<span class="comment-age">(27 Jun '12, 10:49)</span>
<a class="comment-user userinfo" href="/users/3908/ravi-kotwani">Ravi Kotwani</a>
</div>
</div>
<a name="13834"></a>
<div class="comment" id="comment-13834">
<div class="comment-score" id="post-13834-score">2</div>
<div class="comment-text"><p>You need to check the permissions not just of the directory, but of the directory's parent, and that directories parent, and... etc.</p>
<p>They all need to be accessible by which ever user you are running postgresql as.</p>
<p>To confirm if this is the case it maybe be helpful to switch to the postgres user and attempt to access the nominatim.so file using the full path. i.e.</p>
<p>su -l postgres
ls -alh /home/user/path/path/nominatim.so</p></div>
<div class="comment-info" id="comment-13834-info">
<span class="comment-age">(27 Jun '12, 10:51)</span>
<a class="comment-user userinfo" href="/users/4/twain">twain</a>
</div>
</div>
<a name="13835"></a>
<div class="comment" id="comment-13835">
<div class="comment-score" id="post-13835-score">2</div>
<div class="comment-text"><p>Yeah, and don't forget the execution permission flag on the .so file itself. Rebuilding the .so file is not your current problem since postgreSQL is even not able to access the file.</p></div>
<div class="comment-info" id="comment-13835-info">
<span class="comment-age">(27 Jun '12, 10:59)</span>
<a class="comment-user userinfo" href="/users/87/pieren">Pieren</a>
</div>
</div>
<a name="13839"></a>
<div class="comment" id="comment-13839">
<div class="comment-score" id="post-13839-score"></div>
<div class="comment-text"><p><a href="/users/4/twain">@Twain</a>: Thanks for guiding, I just checked the owner of parent -&gt; parent -&gt; parent etc. and set the parent directory permission same as you told and its working fine now. Thanks.</p></div>
<div class="comment-info" id="comment-13839-info">
<span class="comment-age">(27 Jun '12, 12:05)</span>
<a class="comment-user userinfo" href="/users/3908/ravi-kotwani">Ravi Kotwani</a>
</div>
</div>
<a name="47391"></a>
<div class="comment" id="comment-47391">
<div class="comment-score" id="post-47391-score"></div>
<div class="comment-text"><p>I had the same problem. I checked all privileges and they were ok. I restarted postgres (/usr/bin/pg_ctl stop|start) and then it worked.</p></div>
<div class="comment-info" id="comment-47391-info">
<span class="comment-age">(06 Jan '16, 12:06)</span>
<a class="comment-user userinfo" href="/users/11835/dusiema">dusiema</a>
</div>
</div>
</div>
<div class="comment-tools" id="comment-tools-13828">
</div>
<div class="clear"></div>
<div class="comment-form-container" id="comment-13828-form-container">
</div>
<div class="clear"></div>
</div>
</td>
</tr>
</table>
</div>
<div class="paginator-container-left">
</div>
<form action="/questions/13825/answer/" id="fmanswer" method="post">
<input name="csrfmiddlewaretoken" type="hidden" value="mvIDCR06eVnlLVU4o2qUQgxy9VCyOKuB"/>
<div style="clear:both">
</div>
</form>
</div>
</div>
</div>